<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CMMC Study">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="description" content="CMMC Level 2 CCA Exam Study Guide - 110 Controls, Ethics, Assessment Scenarios">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>CMMC CCA Study Guide - Complete Exam Prep</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f5f7fa;
            color: #1a1a2e;
        }
        
        .container { display: flex; min-height: 100vh; }
        
        /* Sidebar */
        .sidebar {
            width: 300px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 4px 0 20px rgba(0,0,0,0.1);
            z-index: 100;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar h1 { font-size: 1.4rem; margin-bottom: 5px; color: #4fc3f7; }
        .sidebar .subtitle {
            font-size: 0.85rem; color: #888; margin-bottom: 20px;
            padding-bottom: 15px; border-bottom: 1px solid #333;
        }
        
        .section-title {
            font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px;
            color: #888; margin-bottom: 10px; margin-top: 20px;
        }
        
        /* Mode Navigation */
        .mode-nav {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .mode-btn {
            padding: 10px 6px;
            border: 2px solid #333;
            background: transparent;
            color: #888;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 600;
            transition: all 0.2s;
            text-align: center;
        }
        
        .mode-btn:hover { border-color: #4fc3f7; color: #4fc3f7; }
        .mode-btn.active { background: #4fc3f7; border-color: #4fc3f7; color: #1a1a2e; }
        .mode-btn .icon { display: block; font-size: 1.1rem; margin-bottom: 3px; }
        
        /* Mode-specific colors */
        .mode-btn.ethics { border-color: #8b5cf6; }
        .mode-btn.ethics:hover, .mode-btn.ethics.active { background: #8b5cf6; border-color: #8b5cf6; color: white; }
        .mode-btn.gotcha { border-color: #ef4444; }
        .mode-btn.gotcha:hover, .mode-btn.gotcha.active { background: #ef4444; border-color: #ef4444; color: white; }
        .mode-btn.judgment { border-color: #f59e0b; }
        .mode-btn.judgment:hover, .mode-btn.judgment.active { background: #f59e0b; border-color: #f59e0b; color: #1a1a2e; }
        .mode-btn.cap { border-color: #10b981; }
        .mode-btn.cap:hover, .mode-btn.cap.active { background: #10b981; border-color: #10b981; color: white; }
        .mode-btn.scoping { border-color: #6366f1; }
        .mode-btn.scoping:hover, .mode-btn.scoping.active { background: #6366f1; border-color: #6366f1; color: white; }
        .mode-btn.terminology { border-color: #ec4899; }
        .mode-btn.terminology:hover, .mode-btn.terminology.active { background: #ec4899; border-color: #ec4899; color: white; }
        .mode-btn.bestanswer { border-color: #14b8a6; }
        .mode-btn.bestanswer:hover, .mode-btn.bestanswer.active { background: #14b8a6; border-color: #14b8a6; color: white; }
        .mode-btn.tips { border-color: #f97316; }
        .mode-btn.tips:hover, .mode-btn.tips.active { background: #f97316; border-color: #f97316; color: white; }
        .mode-btn.deepdive { border-color: #06b6d4; }
        .mode-btn.deepdive:hover, .mode-btn.deepdive.active { background: #06b6d4; border-color: #06b6d4; color: #1a1a2e; }
        
        /* Progress Section */
        .progress-section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .progress-title { font-size: 0.85rem; font-weight: 600; }
        .progress-percent { font-size: 1.2rem; font-weight: 700; color: #4fc3f7; }
        
        .progress-bar-container {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            height: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4fc3f7, #29b6f6);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }
        
        .progress-stats { display: flex; justify-content: space-between; margin-top: 10px; font-size: 0.75rem; color: #888; }
        .progress-stats span { color: #4fc3f7; font-weight: 600; }
        
        .reset-progress {
            width: 100%;
            padding: 8px;
            margin-top: 10px;
            background: transparent;
            border: 1px solid #444;
            color: #888;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
        }
        .reset-progress:hover { border-color: #e74c3c; color: #e74c3c; }

        /* Legend */
        .legend-item {
            display: flex; align-items: center;
            padding: 8px 12px; margin-bottom: 6px;
            border-radius: 8px; cursor: pointer;
            transition: all 0.2s; border: 2px solid transparent;
        }
        .legend-item:hover { background: rgba(255,255,255,0.1); }
        .legend-item.active { border-color: currentColor; background: rgba(255,255,255,0.05); }
        
        .legend-color { width: 14px; height: 14px; border-radius: 4px; margin-right: 10px; flex-shrink: 0; }
        .legend-text { font-size: 0.85rem; }
        
        .policy { background: #2E86AB; color: #2E86AB; }
        .config { background: #A23B72; color: #A23B72; }
        .software { background: #F18F01; color: #F18F01; }
        .hardware { background: #C73E1D; color: #C73E1D; }
        .mixed { background: linear-gradient(135deg, #3D5A80, #7B2D8E); color: #7B2D8E; }
        
        /* Search */
        .search-box { margin-bottom: 15px; }
        .search-box input {
            width: 100%; padding: 12px 15px; border: none; border-radius: 8px;
            background: rgba(255,255,255,0.1); color: white; font-size: 0.9rem;
        }
        .search-box input::placeholder { color: #666; }
        .search-box input:focus { outline: 2px solid #4fc3f7; background: rgba(255,255,255,0.15); }
        
        /* Study filter */
        .study-filter { display: flex; gap: 6px; margin-bottom: 15px; }
        .study-filter-btn {
            flex: 1; padding: 8px 6px; border: 1px solid #333;
            background: transparent; color: #888; border-radius: 6px;
            cursor: pointer; font-size: 0.7rem; transition: all 0.2s;
        }
        .study-filter-btn:hover { border-color: #4fc3f7; color: #4fc3f7; }
        .study-filter-btn.active { background: rgba(79, 195, 247, 0.2); border-color: #4fc3f7; color: #4fc3f7; }
        
        /* Stats */
        .stats { margin-top: 15px; padding-top: 15px; border-top: 1px solid #333; }
        .stat-item { display: flex; justify-content: space-between; padding: 6px 0; font-size: 0.8rem; }
        .stat-value { color: #4fc3f7; font-weight: 600; }
        .creator-credit { 
            font-size: 0.8rem; 
            color: #94a3b8; 
            margin-bottom: 15px;
        }
        .creator-credit a { 
            color: #4fc3f7; 
            text-decoration: none; 
            font-weight: 600;
        }
        .creator-credit a:hover { 
            text-decoration: underline; 
            color: #67d4ff;
        }
        
        /* Main Content */
        .main-content { margin-left: 300px; flex: 1; padding: 30px; }
        
        .header { text-align: center; margin-bottom: 30px; }
        .header h2 { font-size: 2rem; color: #1a1a2e; margin-bottom: 10px; }
        .header p { color: #666; }
        
        /* Domain Sections */
        .domain {
            background: white; border-radius: 16px; margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); overflow: hidden;
        }
        
        .domain-header {
            padding: 18px 25px; color: white;
            display: flex; justify-content: space-between; align-items: center;
            cursor: pointer; transition: filter 0.2s;
        }
        .domain-header:hover { filter: brightness(1.1); }
        
        .domain-title { font-size: 1.1rem; font-weight: 600; }
        .domain-meta { display: flex; align-items: center; gap: 12px; }
        .domain-count { background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; }
        .domain-progress { font-size: 0.8rem; opacity: 0.9; }
        .domain-chevron { font-size: 1.2rem; transition: transform 0.3s; }
        .domain.collapsed .domain-chevron { transform: rotate(-90deg); }
        .domain.collapsed .domain-content { display: none; }
        
        /* Controls Table */
        .controls-table { width: 100%; border-collapse: collapse; }
        .controls-table th {
            background: #f8f9fa; padding: 12px 15px; text-align: left;
            font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px;
            color: #666; border-bottom: 2px solid #e9ecef;
        }
        .controls-table td { padding: 15px; border-bottom: 1px solid #f0f0f0; vertical-align: top; }
        .controls-table tr:hover { background: #f8fafc; }
        .controls-table tr.hidden { display: none; }
        .controls-table tr.studied { background: #f0fdf4; }
        .controls-table tr.studied:hover { background: #dcfce7; }
        
        .control-id { font-weight: 700; color: #1a1a2e; font-size: 0.95rem; }
        .control-name { font-size: 0.8rem; color: #666; margin-top: 3px; }
        .control-req { font-size: 0.85rem; color: #444; line-height: 1.5; }
        .control-meaning { font-size: 0.85rem; color: #666; line-height: 1.5; }
        
        .impl-badge {
            display: inline-block; padding: 5px 12px; border-radius: 20px;
            font-size: 0.75rem; font-weight: 600; color: white; white-space: nowrap;
        }
        
        .study-checkbox { width: 22px; height: 22px; cursor: pointer; accent-color: #10b981; }
        
        /* Domain Colors */
        .domain-ac .domain-header { background: linear-gradient(135deg, #2563EB, #1d4ed8); }
        .domain-at .domain-header { background: linear-gradient(135deg, #059669, #047857); }
        .domain-au .domain-header { background: linear-gradient(135deg, #7C3AED, #6d28d9); }
        .domain-cm .domain-header { background: linear-gradient(135deg, #DC2626, #b91c1c); }
        .domain-ia .domain-header { background: linear-gradient(135deg, #0891B2, #0e7490); }
        .domain-ir .domain-header { background: linear-gradient(135deg, #EA580C, #c2410c); }
        .domain-ma .domain-header { background: linear-gradient(135deg, #4F46E5, #4338ca); }
        .domain-mp .domain-header { background: linear-gradient(135deg, #BE185D, #9d174d); }
        .domain-ps .domain-header { background: linear-gradient(135deg, #0D9488, #0f766e); }
        .domain-pe .domain-header { background: linear-gradient(135deg, #9333EA, #7e22ce); }
        .domain-ra .domain-header { background: linear-gradient(135deg, #CA8A04, #a16207); }
        .domain-ca .domain-header { background: linear-gradient(135deg, #2563EB, #1d4ed8); }
        .domain-sc .domain-header { background: linear-gradient(135deg, #DC2626, #b91c1c); }
        .domain-si .domain-header { background: linear-gradient(135deg, #65A30D, #4d7c0f); }
        
        /* Mode Panels */
        .mode-panel { display: none; max-width: 900px; margin: 0 auto; }
        .mode-panel.active { display: block; }
        .study-container.hidden { display: none; }
        
        /* Quiz Mode Styles */
        .quiz-settings {
            background: white; border-radius: 16px; padding: 25px;
            margin-bottom: 25px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        .quiz-settings h3 { margin-bottom: 20px; color: #1a1a2e; }
        
        .quiz-options { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px; }
        .quiz-option {
            padding: 15px; border: 2px solid #e5e7eb; border-radius: 12px;
            cursor: pointer; transition: all 0.2s; text-align: center;
        }
        .quiz-option:hover { border-color: #4fc3f7; background: #f0f9ff; }
        .quiz-option.selected { border-color: #2563EB; background: #eff6ff; }
        .quiz-option .icon { font-size: 2rem; margin-bottom: 8px; }
        .quiz-option .label { font-weight: 600; color: #1a1a2e; margin-bottom: 4px; }
        .quiz-option .desc { font-size: 0.8rem; color: #666; }
        
        .start-quiz-btn {
            width: 100%; padding: 15px;
            background: linear-gradient(135deg, #2563EB, #1d4ed8);
            color: white; border: none; border-radius: 12px;
            font-size: 1.1rem; font-weight: 600; cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .start-quiz-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3); }
        
        /* Quiz Card */
        .quiz-card {
            background: white; border-radius: 20px; padding: 40px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.1); text-align: center; display: none;
        }
        .quiz-card.active { display: block; }
        
        .quiz-progress {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #e5e7eb;
        }
        .quiz-progress-text { font-size: 0.9rem; color: #666; }
        .quiz-score { display: flex; gap: 20px; }
        .quiz-score-item { font-size: 0.9rem; }
        .quiz-score-item.correct { color: #10b981; }
        .quiz-score-item.incorrect { color: #ef4444; }
        
        .quiz-question-label { font-size: 0.9rem; color: #666; margin-bottom: 10px; }
        .quiz-question { font-size: 1.5rem; font-weight: 700; color: #1a1a2e; margin-bottom: 10px; line-height: 1.4; }
        .quiz-question-sub { font-size: 1rem; color: #666; margin-bottom: 30px; line-height: 1.5; }
        
        .quiz-answers { display: grid; gap: 12px; text-align: left; margin-bottom: 20px; }
        .quiz-answer {
            padding: 15px 20px; border: 2px solid #e5e7eb; border-radius: 12px;
            cursor: pointer; transition: all 0.2s; font-size: 0.95rem;
        }
        .quiz-answer:hover:not(.disabled) { border-color: #4fc3f7; background: #f0f9ff; }
        .quiz-answer.correct { border-color: #10b981; background: #ecfdf5; }
        .quiz-answer.incorrect { border-color: #ef4444; background: #fef2f2; }
        .quiz-answer.disabled { cursor: default; opacity: 0.8; }
        
        .quiz-feedback {
            padding: 15px; border-radius: 12px; font-weight: 600;
            display: none; margin-bottom: 20px;
        }
        .quiz-feedback.show { display: block; }
        .quiz-feedback.correct { background: #ecfdf5; color: #10b981; }
        .quiz-feedback.incorrect { background: #fef2f2; color: #ef4444; }
        
        .quiz-btn {
            padding: 12px 30px; border-radius: 10px; font-size: 1rem;
            font-weight: 600; cursor: pointer; transition: all 0.2s; border: none;
        }
        .quiz-btn-primary { background: #2563EB; color: white; }
        .quiz-btn-primary:hover { background: #1d4ed8; }
        .quiz-btn-secondary { background: #e5e7eb; color: #666; }
        .quiz-btn-secondary:hover { background: #d1d5db; }
        
        /* Flashcard */
        .flashcard {
            width: 100%; height: 300px; perspective: 1000px;
            cursor: pointer; margin-bottom: 30px;
        }
        .flashcard-inner {
            width: 100%; height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
        }
        .flashcard.flipped .flashcard-inner { transform: rotateY(180deg); }
        
        .flashcard-front, .flashcard-back {
            position: absolute; width: 100%; height: 100%;
            backface-visibility: hidden; border-radius: 16px;
            display: flex; flex-direction: column; justify-content: center;
            align-items: center; padding: 30px;
        }
        .flashcard-front { background: linear-gradient(135deg, #2563EB, #1d4ed8); color: white; }
        .flashcard-back { background: linear-gradient(135deg, #10b981, #059669); color: white; transform: rotateY(180deg); }
        
        .flashcard-id { font-size: 0.9rem; opacity: 0.8; margin-bottom: 10px; }
        .flashcard-label { font-size: 0.8rem; opacity: 0.7; margin-bottom: 15px; text-transform: uppercase; }
        .flashcard-text { font-size: 1.2rem; text-align: center; line-height: 1.5; }
        
        .flashcard-buttons { display: flex; gap: 15px; justify-content: center; }
        .fc-btn {
            padding: 15px 40px; border-radius: 12px; font-size: 1rem;
            font-weight: 600; cursor: pointer; border: none; transition: all 0.2s;
        }
        .fc-btn-wrong { background: #fef2f2; color: #ef4444; }
        .fc-btn-wrong:hover { background: #fee2e2; }
        .fc-btn-right { background: #ecfdf5; color: #10b981; }
        .fc-btn-right:hover { background: #d1fae5; }
        
        /* Quiz Results */
        .quiz-results {
            background: white; border-radius: 20px; padding: 50px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.1); text-align: center; display: none;
        }
        .quiz-results.active { display: block; }
        
        .results-icon { font-size: 4rem; margin-bottom: 20px; }
        .results-score { font-size: 4rem; font-weight: 800; color: #2563EB; margin-bottom: 10px; }
        .results-message { font-size: 1.2rem; color: #666; margin-bottom: 30px; }
        
        .results-stats { display: flex; justify-content: center; gap: 40px; margin-bottom: 30px; }
        .results-stat { text-align: center; }
        .results-stat-value { font-size: 2rem; font-weight: 700; }
        .results-stat-value.correct { color: #10b981; }
        .results-stat-value.incorrect { color: #ef4444; }
        .results-stat-label { font-size: 0.85rem; color: #888; }
        
        /* CCA Mode Styles */
        .cca-card {
            background: white; border-radius: 16px; padding: 30px;
            margin-bottom: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .cca-category {
            display: inline-block; padding: 4px 12px; border-radius: 20px;
            font-size: 0.75rem; font-weight: 600; margin-bottom: 15px;
        }
        .cca-category.ethics { background: #8b5cf6; color: white; }
        .cca-category.gotcha { background: #ef4444; color: white; }
        .cca-category.judgment { background: #f59e0b; color: #1a1a2e; }
        .cca-category.cap { background: #10b981; color: white; }
        .cca-category.scoping { background: #6366f1; color: white; }
        .cca-category.terminology { background: #ec4899; color: white; }
        .cca-category.bestanswer { background: #14b8a6; color: white; }
        
        .cca-question { font-size: 1.2rem; font-weight: 600; color: #1a1a2e; line-height: 1.5; margin-bottom: 20px; }
        .cca-scenario { font-size: 1rem; color: #444; line-height: 1.6; margin-bottom: 25px; padding: 20px; background: #f8fafc; border-radius: 12px; border-left: 4px solid #2563EB; }
        
        .cca-options { display: grid; gap: 10px; margin-bottom: 20px; }
        .cca-option {
            padding: 15px 20px; border: 2px solid #e5e7eb; border-radius: 12px;
            cursor: pointer; transition: all 0.2s; font-size: 0.95rem; text-align: left;
        }
        .cca-option:hover:not(.disabled) { border-color: #4fc3f7; background: #f0f9ff; }
        .cca-option.selected { border-color: #2563EB; background: #eff6ff; }
        .cca-option.correct { border-color: #10b981; background: #ecfdf5; }
        .cca-option.incorrect { border-color: #ef4444; background: #fef2f2; }
        .cca-option.disabled { cursor: default; }
        
        .cca-explanation {
            background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 12px;
            padding: 20px; margin-top: 20px; display: none;
        }
        .cca-explanation.show { display: block; }
        .cca-explanation h4 { color: #0369a1; margin-bottom: 10px; font-size: 0.9rem; }
        .cca-explanation p { color: #0c4a6e; line-height: 1.6; font-size: 0.9rem; }
        
        .cca-mindset {
            background: #fef3c7; border: 1px solid #fcd34d; border-radius: 8px;
            padding: 15px; margin-top: 15px;
        }
        .cca-mindset h5 { color: #92400e; margin-bottom: 8px; font-size: 0.85rem; }
        .cca-mindset p { color: #78350f; font-size: 0.85rem; line-height: 1.5; }
        
        /* Deep Dive Styles */
        .deepdive-search {
            width: 100%; padding: 15px 20px; border: 2px solid #e5e7eb;
            border-radius: 12px; font-size: 1rem; margin-bottom: 20px;
        }
        .deepdive-search:focus { outline: none; border-color: #06b6d4; }
        
        .deepdive-domain {
            background: white; border-radius: 16px; margin-bottom: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); overflow: hidden;
        }
        
        .deepdive-domain-header {
            padding: 18px 25px; color: white;
            display: flex; justify-content: space-between; align-items: center;
            cursor: pointer;
        }
        
        .deepdive-domain-content { display: none; padding: 20px; }
        .deepdive-domain.expanded .deepdive-domain-content { display: block; }
        .deepdive-domain.expanded .dd-chevron { transform: rotate(180deg); }
        
        .deepdive-control {
            background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px;
            padding: 20px; margin-bottom: 15px;
        }
        .deepdive-control.hidden { display: none; }
        
        .dd-control-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
        .dd-control-id { font-weight: 700; color: #1a1a2e; }
        .dd-control-name { color: #64748b; font-size: 0.9rem; margin-left: 8px; }
        .dd-badge { padding: 3px 10px; border-radius: 10px; font-size: 0.7rem; font-weight: 700; }
        .dd-badge-5pt { background: #ef4444; color: white; }
        .dd-badge-partial { background: #f59e0b; color: #1a1a2e; }
        
        .dd-statement {
            font-size: 0.9rem; color: #475569; line-height: 1.5;
            padding: 12px; background: white; border-radius: 8px;
            border-left: 3px solid #06b6d4; margin-bottom: 15px;
        }
        
        .dd-takeaways h4 { color: #0891b2; font-size: 0.85rem; margin-bottom: 10px; }
        .dd-takeaways ul { margin: 0; padding-left: 20px; }
        .dd-takeaways li { color: #334155; font-size: 0.85rem; line-height: 1.6; margin-bottom: 5px; }
        
        .dd-tips {
            background: #fef3c7; border: 1px solid #fcd34d; border-radius: 8px;
            padding: 12px; margin-top: 15px;
        }
        .dd-tips h5 { color: #92400e; font-size: 0.8rem; margin-bottom: 6px; }
        .dd-tips p { color: #78350f; font-size: 0.8rem; }
        
        /* Quiz Stats Sidebar for CCA modes */
        .cca-stats {
            background: rgba(255,255,255,0.05); border-radius: 12px;
            padding: 15px; margin-top: 15px;
        }
        .cca-stats-title { font-size: 0.8rem; color: #888; margin-bottom: 10px; }
        .cca-stats-row { display: flex; justify-content: space-between; padding: 5px 0; font-size: 0.85rem; }
        
        /* Mobile Styles */
        .mobile-nav {
            display: none;
            position: fixed; bottom: 0; left: 0; right: 0;
            background: #1a1a2e; padding: 10px; z-index: 200;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.2);
        }
        
        .mobile-nav-inner { display: flex; justify-content: space-around; }
        
        .mobile-nav-btn {
            background: none; border: none; color: #888;
            padding: 8px 12px; border-radius: 8px;
            font-size: 0.7rem; cursor: pointer;
        }
        .mobile-nav-btn.active { color: #4fc3f7; background: rgba(79, 195, 247, 0.1); }
        .mobile-nav-btn .icon { display: block; font-size: 1.3rem; margin-bottom: 2px; }
        
        .sidebar-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5); z-index: 99;
        }
        .sidebar-overlay.show { display: block; }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                width: 280px;
            }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 20px; padding-bottom: 80px; }
            .mobile-nav { display: block; }
            .quiz-options { grid-template-columns: 1fr; }
            .flashcard { height: 250px; }
            .quiz-card, .cca-card { padding: 20px; }
        }
        
        /* Confetti Animation */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
            animation: confetti-fall 3s ease-out forwards;
        }
        @keyframes confetti-fall {
            0% {
                opacity: 1;
                transform: translateY(-100%) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(100vh) rotate(720deg);
            }
        }
        .confetti:nth-child(odd) { animation-duration: 2.5s; }
        .confetti:nth-child(3n) { animation-duration: 3.5s; }
        .confetti:nth-child(4n) { width: 8px; height: 16px; border-radius: 2px; }
        .confetti:nth-child(5n) { width: 12px; height: 12px; border-radius: 50%; }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar-overlay" onclick="closeMobileSidebar()"></div>
        
        <aside class="sidebar">
            <h1>üìö CMMC CCA Study</h1>
            <div class="subtitle">Complete Exam Preparation</div>
            <div class="creator-credit">
                Created by <a href="https://www.linkedin.com/in/charnice-tatum" target="_blank" rel="noopener noreferrer">Charnice Tatum, CCP</a>
            </div>
            
            <div class="section-title">Study Modes</div>
            <div class="mode-nav">
                <button class="mode-btn active" id="modeStudy" onclick="setMode('study')">
                    <span class="icon">üìñ</span> Controls
                </button>
                <button class="mode-btn" id="modeQuiz" onclick="setMode('quiz')">
                    <span class="icon">‚úèÔ∏è</span> Quiz
                </button>
                <button class="mode-btn ethics" id="modeEthics" onclick="setMode('ethics')">
                    <span class="icon">‚öñÔ∏è</span> Ethics
                </button>
                <button class="mode-btn gotcha" id="modeGotcha" onclick="setMode('gotcha')">
                    <span class="icon">‚ö°</span> Gotcha
                </button>
                <button class="mode-btn judgment" id="modeJudgment" onclick="setMode('judgment')">
                    <span class="icon">üéØ</span> Judgment
                </button>
                <button class="mode-btn cap" id="modeCap" onclick="setMode('cap')">
                    <span class="icon">üìã</span> CAP
                </button>
                <button class="mode-btn scoping" id="modeScoping" onclick="setMode('scoping')">
                    <span class="icon">üó∫Ô∏è</span> Scoping
                </button>
                <button class="mode-btn terminology" id="modeTerminology" onclick="setMode('terminology')">
                    <span class="icon">üìö</span> Terms
                </button>
                <button class="mode-btn bestanswer" id="modeBestanswer" onclick="setMode('bestanswer')">
                    <span class="icon">üß†</span> Best Answer
                </button>
                <button class="mode-btn tips" id="modeTips" onclick="setMode('tips')">
                    <span class="icon">üí°</span> Tips
                </button>
                <button class="mode-btn deepdive" id="modeDeepDive" onclick="setMode('deepdive')">
                    <span class="icon">üî¨</span> Deep Dive
                </button>
            </div>
            
            <!-- Study Mode Sidebar -->
            <div id="studySidebar">
                <div class="progress-section">
                    <div class="progress-header">
                        <span class="progress-title">Study Progress</span>
                        <span class="progress-percent" id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    <div class="progress-stats">
                        <span><span id="studiedCount">0</span> / 110 studied</span>
                    </div>
                    <button class="reset-progress" onclick="resetProgress()">‚Ü∫ Reset Progress</button>
                </div>
                
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="üîç Search controls...">
                </div>
                
                <div class="section-title">Filter by Status</div>
                <div class="study-filter">
                    <button class="study-filter-btn active" data-filter="all" onclick="setFilter('all')">All</button>
                    <button class="study-filter-btn" data-filter="studied" onclick="setFilter('studied')">‚úì Studied</button>
                    <button class="study-filter-btn" data-filter="unstudied" onclick="setFilter('unstudied')">‚óã To Study</button>
                </div>
                
                <div class="section-title">Filter by Type</div>
                <div class="legend-item active" data-type="all" onclick="setTypeFilter('all')">
                    <div class="legend-color" style="background: linear-gradient(135deg, #4fc3f7, #29b6f6);"></div>
                    <span class="legend-text">All Types</span>
                </div>
                <div class="legend-item" data-type="policy" onclick="setTypeFilter('policy')">
                    <div class="legend-color policy"></div>
                    <span class="legend-text">Policy/Process</span>
                </div>
                <div class="legend-item" data-type="config" onclick="setTypeFilter('config')">
                    <div class="legend-color config"></div>
                    <span class="legend-text">Configuration</span>
                </div>
                <div class="legend-item" data-type="software" onclick="setTypeFilter('software')">
                    <div class="legend-color software"></div>
                    <span class="legend-text">Software/Tool</span>
                </div>
                <div class="legend-item" data-type="hardware" onclick="setTypeFilter('hardware')">
                    <div class="legend-color hardware"></div>
                    <span class="legend-text">Hardware</span>
                </div>
                <div class="legend-item" data-type="mixed" onclick="setTypeFilter('mixed')">
                    <div class="legend-color mixed"></div>
                    <span class="legend-text">Mixed</span>
                </div>
            </div>
            
            <!-- Quiz Sidebar -->
            <div id="quizSidebar" style="display: none;">
                <div class="cca-stats">
                    <div class="cca-stats-title">Quiz Progress</div>
                    <div class="cca-stats-row">
                        <span>Correct</span>
                        <span style="color: #10b981" id="quizCorrectCount">0</span>
                    </div>
                    <div class="cca-stats-row">
                        <span>Incorrect</span>
                        <span style="color: #ef4444" id="quizIncorrectCount">0</span>
                    </div>
                </div>
                <button class="reset-progress" style="margin-top: 15px;" onclick="endQuiz()">‚úï End Quiz</button>
            </div>
            
            <!-- CCA Mode Sidebar -->
            <div id="ccaSidebar" style="display: none;">
                <div class="cca-stats">
                    <div class="cca-stats-title">Session Progress</div>
                    <div class="cca-stats-row">
                        <span>Question</span>
                        <span id="ccaProgress">0 / 0</span>
                    </div>
                    <div class="cca-stats-row">
                        <span>Correct</span>
                        <span style="color: #10b981" id="ccaCorrect">0</span>
                    </div>
                    <div class="cca-stats-row">
                        <span>Incorrect</span>
                        <span style="color: #ef4444" id="ccaIncorrect">0</span>
                    </div>
                </div>
                <button class="reset-progress" style="margin-top: 15px;" onclick="restartCCAMode()">‚Ü∫ Restart</button>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <span>Total Controls</span>
                    <span class="stat-value">110</span>
                </div>
                <div class="stat-item">
                    <span>CCA Questions</span>
                    <span class="stat-value">58</span>
                </div>
                <div class="stat-item">
                    <span>Domains</span>
                    <span class="stat-value">14</span>
                </div>
            </div>
        </aside>
        
        <main class="main-content">
            <!-- Study Mode -->
            <div id="studyContainer" class="study-container">
                <div class="header">
                    <h2>CMMC Level 2 Controls Reference</h2>
                    <p>Check off controls as you study them ‚Ä¢ Filter by type or study status</p>
                </div>
                <div id="domainsContainer"></div>
            </div>
            
            <!-- Quiz Mode -->
            <div id="quizContainer" class="mode-panel">
                <div class="quiz-settings" id="quizSettings">
                    <h3>üéØ Choose Your Quiz Mode</h3>
                    <div class="quiz-options">
                        <div class="quiz-option selected" data-quiz-type="multiple-choice" onclick="selectQuizType('multiple-choice')">
                            <div class="icon">üìù</div>
                            <div class="label">Multiple Choice</div>
                            <div class="desc">Match controls to requirements</div>
                        </div>
                        <div class="quiz-option" data-quiz-type="flashcard" onclick="selectQuizType('flashcard')">
                            <div class="icon">üÉè</div>
                            <div class="label">Flashcards</div>
                            <div class="desc">Flip to reveal answers</div>
                        </div>
                        <div class="quiz-option" data-quiz-type="type-match" onclick="selectQuizType('type-match')">
                            <div class="icon">üè∑Ô∏è</div>
                            <div class="label">Type Match</div>
                            <div class="desc">Match to implementation type</div>
                        </div>
                        <div class="quiz-option" data-quiz-type="domain-match" onclick="selectQuizType('domain-match')">
                            <div class="icon">üìÇ</div>
                            <div class="label">Domain Match</div>
                            <div class="desc">Identify control domains</div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <div class="section-title" style="color: #666; margin-top: 0;">Number of Questions</div>
                        <div class="study-filter" style="margin-bottom: 0;">
                            <button class="study-filter-btn" data-q-count="10" onclick="setQuestionCount(10)">10</button>
                            <button class="study-filter-btn active" data-q-count="20" onclick="setQuestionCount(20)">20</button>
                            <button class="study-filter-btn" data-q-count="50" onclick="setQuestionCount(50)">50</button>
                            <button class="study-filter-btn" data-q-count="110" onclick="setQuestionCount(110)">All</button>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <div class="section-title" style="color: #666; margin-top: 0;">Focus On</div>
                        <div class="study-filter" style="margin-bottom: 0;">
                            <button class="study-filter-btn active" data-focus="all" onclick="setQuizFocus('all')">All Controls</button>
                            <button class="study-filter-btn" data-focus="studied" onclick="setQuizFocus('studied')">‚úì Studied Only</button>
                            <button class="study-filter-btn" data-focus="unstudied" onclick="setQuizFocus('unstudied')">‚óã Unstudied Only</button>
                        </div>
                    </div>
                    
                    <button class="start-quiz-btn" onclick="startQuiz()">Start Quiz ‚Üí</button>
                </div>
                
                <div class="quiz-card" id="quizCard">
                    <div class="quiz-progress">
                        <span class="quiz-progress-text">Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span></span>
                        <div class="quiz-score">
                            <span class="quiz-score-item correct">‚úì <span id="correctScore">0</span></span>
                            <span class="quiz-score-item incorrect">‚úó <span id="incorrectScore">0</span></span>
                        </div>
                    </div>
                    <div class="quiz-question-label" id="questionLabel">What control is this?</div>
                    <div class="quiz-question" id="questionText">Loading...</div>
                    <div class="quiz-question-sub" id="questionSub"></div>
                    <div class="quiz-answers" id="quizAnswers"></div>
                    <div class="quiz-feedback" id="quizFeedback"></div>
                    <button class="quiz-btn quiz-btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">Next ‚Üí</button>
                </div>
                
                <div class="quiz-card" id="flashcardCard">
                    <div class="quiz-progress">
                        <span class="quiz-progress-text">Card <span id="fcCurrentQuestion">1</span> of <span id="fcTotalQuestions">20</span></span>
                    </div>
                    <div class="flashcard" id="flashcard" onclick="flipCard()">
                        <div class="flashcard-inner">
                            <div class="flashcard-front">
                                <div class="flashcard-id" id="fcControlId">3.1.1</div>
                                <div class="flashcard-label">Control Requirement</div>
                                <div class="flashcard-text" id="fcFront">Loading...</div>
                            </div>
                            <div class="flashcard-back">
                                <div class="flashcard-label">What It Means</div>
                                <div class="flashcard-text" id="fcBack">Loading...</div>
                            </div>
                        </div>
                    </div>
                    <p style="color: #888; font-size: 0.9rem; margin-bottom: 20px;">Tap card to flip</p>
                    <div class="flashcard-buttons">
                        <button class="fc-btn fc-btn-wrong" onclick="markFlashcard(false)">‚úó Didn't Know</button>
                        <button class="fc-btn fc-btn-right" onclick="markFlashcard(true)">‚úì Got It</button>
                    </div>
                </div>
                
                <div class="quiz-results" id="quizResults">
                    <div class="results-icon" id="resultsIcon">üèÜ</div>
                    <div class="results-score" id="resultsScore">85%</div>
                    <div class="results-message" id="resultsMessage">Great job!</div>
                    <div class="results-stats">
                        <div class="results-stat">
                            <div class="results-stat-value correct" id="resultsCorrect">17</div>
                            <div class="results-stat-label">Correct</div>
                        </div>
                        <div class="results-stat">
                            <div class="results-stat-value incorrect" id="resultsIncorrect">3</div>
                            <div class="results-stat-label">Incorrect</div>
                        </div>
                    </div>
                    <button class="quiz-btn quiz-btn-primary" onclick="restartQuiz()">Try Again</button>
                </div>
            </div>
            
            <!-- Ethics Mode -->
            <div id="ethicsContainer" class="mode-panel"></div>
            
            <!-- Gotcha Mode -->
            <div id="gotchaContainer" class="mode-panel"></div>
            
            <!-- Judgment Mode -->
            <div id="judgmentContainer" class="mode-panel"></div>
            
            <!-- CAP Process Mode -->
            <div id="capContainer" class="mode-panel"></div>
            
            <!-- Scoping Mode -->
            <div id="scopingContainer" class="mode-panel"></div>
            
            <!-- Terminology Mode -->
            <div id="terminologyContainer" class="mode-panel"></div>
            
            <!-- Best Answer Mode -->
            <div id="bestanswerContainer" class="mode-panel"></div>
            
            <!-- Tips Mode -->
            <div id="tipsContainer" class="mode-panel"></div>
            
            <!-- Deep Dive Mode -->
            <div id="deepdiveContainer" class="mode-panel"></div>
        </main>
    </div>
    
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
        <div class="mobile-nav-inner">
            <button class="mobile-nav-btn" onclick="toggleMobileSidebar()">
                <span class="icon">‚ò∞</span> Menu
            </button>
            <button class="mobile-nav-btn active" id="mobileStudyBtn" onclick="mobileSetMode('study')">
                <span class="icon">üìñ</span> Study
            </button>
            <button class="mobile-nav-btn" id="mobileQuizBtn" onclick="mobileSetMode('quiz')">
                <span class="icon">‚úèÔ∏è</span> Quiz
            </button>
            <button class="mobile-nav-btn" id="mobileCCABtn" onclick="mobileSetMode('ethics')">
                <span class="icon">‚öñÔ∏è</span> CCA
            </button>
        </div>
    </nav>

    <script>
        // ==================== CONFETTI CELEBRATION ====================
        function launchConfetti() {
            const container = document.createElement('div');
            container.className = 'confetti-container';
            document.body.appendChild(container);
            
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#dfe6e9', '#fd79a8', '#a29bfe', '#00b894', '#fdcb6e'];
            const shapes = ['square', 'circle', 'rectangle'];
            
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                container.appendChild(confetti);
            }
            
            // Clean up after animation
            setTimeout(() => {
                container.remove();
            }, 5000);
        }
        
        // ==================== ASSESSMENT OBJECTIVES ====================
        const ASSESSMENT_OBJECTIVES = {
            // ACCESS CONTROL (AC) - 22 controls
            '3.1.1': [
                '[a] Authorized users are identified',
                '[b] Processes acting on behalf of authorized users are identified',
                '[c] Devices (and other systems) authorized to connect are identified',
                '[d] System access is limited to authorized users',
                '[e] System access is limited to processes acting on behalf of authorized users',
                '[f] System access is limited to authorized devices (including other systems)'
            ],
            '3.1.2': [
                '[a] Types of transactions and functions that authorized users are permitted to execute are defined',
                '[b] System access is limited to the defined types of transactions and functions for authorized users'
            ],
            '3.1.3': [
                '[a] Information flow control policies are defined',
                '[b] Methods and enforcement mechanisms for controlling CUI flow are defined',
                '[c] Designated sources and destinations for CUI within and between systems are identified',
                '[d] Authorizations for controlling the flow of CUI are defined',
                '[e] Approved authorizations for controlling the flow of CUI are enforced'
            ],
            '3.1.4': [
                '[a] Duties of individuals requiring separation are defined',
                '[b] Responsibilities for duties requiring separation are assigned to separate individuals',
                '[c] Access privileges enabling individuals to exercise duties requiring separation are granted to separate individuals'
            ],
            '3.1.5': [
                '[a] Privileged accounts are identified',
                '[b] Access to privileged accounts is authorized per least privilege',
                '[c] Security functions are identified',
                '[d] Access to security functions is authorized per least privilege'
            ],
            '3.1.6': [
                '[a] Non-security functions are identified',
                '[b] Users are required to use non-privileged accounts when accessing non-security functions'
            ],
            '3.1.7': [
                '[a] Privileged functions are defined',
                '[b] Non-privileged users are defined',
                '[c] Non-privileged users are prevented from executing privileged functions',
                '[d] Execution of privileged functions is captured in audit logs'
            ],
            '3.1.8': [
                '[a] Means of limiting unsuccessful logon attempts is defined',
                '[b] Defined means of limiting unsuccessful logon attempts is implemented'
            ],
            '3.1.9': [
                '[a] Privacy and security notices required by CUI rules are identified and consistent',
                '[b] Privacy and security notices are displayed'
            ],
            '3.1.10': [
                '[a] Period of inactivity after which system initiates session lock is defined',
                '[b] Access to system and viewing of data is prevented by initiating session lock after defined period',
                '[c] Previously visible information is concealed via pattern-hiding display after defined period'
            ],
            '3.1.11': [
                '[a] Conditions requiring a user session to terminate are defined',
                '[b] User session is automatically terminated after any defined conditions occur'
            ],
            '3.1.12': [
                '[a] Allowed remote access types are identified',
                '[b] Restrictions on use of allowed remote access types are defined',
                '[c] Remote access to the system is authorized prior to connection',
                '[d] Remote access to the system is monitored'
            ],
            '3.1.13': [
                '[a] Cryptographic mechanisms to protect confidentiality of remote access sessions are identified',
                '[b] Cryptographic mechanisms to protect confidentiality of remote access sessions are implemented'
            ],
            '3.1.14': [
                '[a] Managed access control points are identified and implemented',
                '[b] Remote access is routed through managed network access control points'
            ],
            '3.1.15': [
                '[a] Privileged commands authorized for remote execution are identified',
                '[b] Security-relevant information authorized to be accessed remotely is identified',
                '[c] Execution of identified privileged commands via remote access is authorized',
                '[d] Access to identified security-relevant information via remote access is authorized'
            ],
            '3.1.16': [
                '[a] Wireless access points are identified',
                '[b] Wireless access is authorized prior to allowing such connections'
            ],
            '3.1.17': [
                '[a] Wireless access is protected using authentication and encryption'
            ],
            '3.1.18': [
                '[a] Mobile devices that process, store, or transmit CUI are identified',
                '[b] Mobile device connections are authorized',
                '[c] Mobile device connections are monitored and logged'
            ],
            '3.1.19': [
                '[a] Mobile devices and mobile computing platforms that process, store, or transmit CUI are identified',
                '[b] Encryption is employed to protect CUI on identified mobile devices and platforms'
            ],
            '3.1.20': [
                '[a] Use of external systems to access the system or process/store/transmit CUI is identified',
                '[b] Limits on use of external systems by authorized individuals are defined',
                '[c] Use of external systems to access the system is controlled per defined limits',
                '[d] Connection/processing of CUI on external systems is identified',
                '[e] Limits on connection/processing of CUI on external systems are defined',
                '[f] Connection/processing of CUI on external systems is controlled per defined limits'
            ],
            '3.1.21': [
                '[a] Use of portable storage devices containing CUI on external systems is identified',
                '[b] Limits on use of portable storage devices containing CUI on external systems are defined',
                '[c] Use of portable storage devices containing CUI on external systems is limited as defined'
            ],
            '3.1.22': [
                '[a] Individuals authorized to post/process information on publicly accessible systems are identified',
                '[b] Procedures to ensure FCI is not posted/processed on publicly accessible systems are identified',
                '[c] A review process is in place prior to posting content to publicly accessible systems',
                '[d] Content on publicly accessible systems is reviewed to ensure it does not include FCI',
                '[e] Mechanisms are in place to remove and address improper posting of FCI'
            ],
            // AWARENESS AND TRAINING (AT) - 3 controls
            '3.2.1': [
                '[a] Security risks associated with organizational activities involving CUI are identified',
                '[b] Managers, systems administrators, and users of the system are identified',
                '[c] Identified personnel are made aware of security risks associated with their activities',
                '[d] Identified personnel are made aware of applicable policies, standards, and procedures'
            ],
            '3.2.2': [
                '[a] Information security-related duties, roles, and responsibilities are defined',
                '[b] Information security-related duties, roles, and responsibilities are assigned to designated personnel',
                '[c] Personnel are adequately trained to carry out their assigned security-related duties'
            ],
            '3.2.3': [
                '[a] Potential indicators associated with insider threats are identified',
                '[b] Security awareness training on recognizing and reporting potential indicators of insider threat is provided'
            ],
            // AUDIT AND ACCOUNTABILITY (AU) - 9 controls
            '3.3.1': [
                '[a] Auditable events are defined',
                '[b] Content of audit records needed to support auditing is defined',
                '[c] Audit records are created (generated)',
                '[d] Audit records, once created, contain the defined content',
                '[e] Retention requirements for audit records are defined',
                '[f] Audit records are retained as defined'
            ],
            '3.3.2': [
                '[a] Content of audit records needed to support unique user traceability is defined',
                '[b] Audit records, once created, contain the defined content'
            ],
            '3.3.3': [
                '[a] Process for determining when to review logged events is defined',
                '[b] Event types being logged are reviewed per the defined process',
                '[c] Event types being logged are updated based on the review'
            ],
            '3.3.4': [
                '[a] Personnel or roles to be alerted in event of audit logging process failure are identified',
                '[b] Types of audit logging process failures for which alert will be generated are defined',
                '[c] Identified personnel or roles are alerted in event of audit logging process failure'
            ],
            '3.3.5': [
                '[a] Audit record review, analysis, and reporting processes for investigation/response are defined',
                '[b] Defined audit record review, analysis, and reporting processes are correlated'
            ],
            '3.3.6': [
                '[a] Audit record reduction capability that supports on-demand analysis is provided',
                '[b] Report generation capability that supports on-demand reporting is provided'
            ],
            '3.3.7': [
                '[a] Internal system clocks are used to generate time stamps for audit records',
                '[b] Internal system clocks used to generate time stamps are synchronized to an authoritative time source'
            ],
            '3.3.8': [
                '[a] Audit information is protected from unauthorized access',
                '[b] Audit information is protected from unauthorized modification',
                '[c] Audit information is protected from unauthorized deletion',
                '[d] Audit logging tools are protected from unauthorized access, modification, and deletion'
            ],
            '3.3.9': [
                '[a] Subset of privileged users granted access to manage audit logging functionality is defined',
                '[b] Management of audit logging functionality is limited to the defined subset of privileged users'
            ],
            // CONFIGURATION MANAGEMENT (CM) - 9 controls
            '3.4.1': [
                '[a] A baseline configuration is established',
                '[b] The baseline configuration includes hardware, software, firmware, and documentation',
                '[c] The baseline configuration is maintained (reviewed and updated) throughout SDLC',
                '[d] A system inventory is established',
                '[e] The system inventory includes hardware, software, firmware, and documentation',
                '[f] The inventory is maintained (reviewed and updated) throughout SDLC'
            ],
            '3.4.2': [
                '[a] Security configuration settings for IT products employed in the system are established/documented',
                '[b] Security configuration settings for IT products are enforced'
            ],
            '3.4.3': [
                '[a] Changes to the system are tracked',
                '[b] Changes to the system are reviewed',
                '[c] Changes to the system are approved or disapproved',
                '[d] Changes to the system are logged'
            ],
            '3.4.4': [
                '[a] Security impact of changes to the system is analyzed prior to implementation'
            ],
            '3.4.5': [
                '[a] Physical access restrictions associated with changes to the system are defined',
                '[b] Logical access restrictions associated with changes to the system are defined',
                '[c] Physical access restrictions associated with changes to the system are enforced',
                '[d] Logical access restrictions associated with changes to the system are enforced'
            ],
            '3.4.6': [
                '[a] Essential system capabilities are defined based on the principle of least functionality',
                '[b] The system is configured to provide only the defined essential capabilities'
            ],
            '3.4.7': [
                '[a] Essential programs are defined',
                '[b] Use of nonessential programs is defined',
                '[c] Use of nonessential programs is restricted, disabled, or prevented as defined',
                '[d] Essential functions are defined',
                '[e] Use of nonessential functions is defined',
                '[f] Use of nonessential functions is restricted, disabled, or prevented as defined',
                '[g] Essential ports are defined',
                '[h] Use of nonessential ports is defined',
                '[i] Use of nonessential ports is restricted, disabled, or prevented as defined',
                '[j] Essential protocols are defined',
                '[k] Use of nonessential protocols is defined',
                '[l] Use of nonessential protocols is restricted, disabled, or prevented as defined',
                '[m] Essential services are defined',
                '[n] Use of nonessential services is defined',
                '[o] Use of nonessential services is restricted, disabled, or prevented as defined'
            ],
            '3.4.8': [
                '[a] Software programs authorized to execute on the system are identified',
                '[b] Rules authorizing software program execution are defined',
                '[c] Rules authorizing software program execution are enforced'
            ],
            '3.4.9': [
                '[a] A policy for controlling installation of software by users is established',
                '[b] Installation of software by users is controlled based on the established policy',
                '[c] Installation of software by users is monitored'
            ],
            // IDENTIFICATION AND AUTHENTICATION (IA) - 11 controls
            '3.5.1': [
                '[a] System users are identified',
                '[b] Processes acting on behalf of users are identified',
                '[c] Devices accessing the system are identified'
            ],
            '3.5.2': [
                '[a] Users are authenticated as a prerequisite to system access',
                '[b] Processes acting on behalf of users are authenticated as a prerequisite to system access',
                '[c] Devices are authenticated as a prerequisite to system access'
            ],
            '3.5.3': [
                '[a] Privileged accounts are identified',
                '[b] MFA is implemented for local access to privileged accounts',
                '[c] MFA is implemented for network access to privileged accounts',
                '[d] MFA is implemented for network access to non-privileged accounts'
            ],
            '3.5.4': [
                '[a] Replay-resistant authentication mechanisms are implemented for network access to privileged and non-privileged accounts'
            ],
            '3.5.5': [
                '[a] Period within which identifiers cannot be reused is defined',
                '[b] Reuse of identifiers is prevented within the defined period'
            ],
            '3.5.6': [
                '[a] Period of inactivity after which an identifier is disabled is defined',
                '[b] Identifiers are disabled after the defined period of inactivity'
            ],
            '3.5.7': [
                '[a] Password complexity requirements are defined',
                '[b] Password change of character requirements are defined',
                '[c] Minimum password complexity requirements as defined are enforced when new passwords are created',
                '[d] Minimum password change of character requirements as defined are enforced when new passwords are created'
            ],
            '3.5.8': [
                '[a] Number of generations during which a password cannot be reused is specified',
                '[b] Reuse of passwords is prohibited for the specified number of generations'
            ],
            '3.5.9': [
                '[a] Period for which temporary passwords are valid is defined',
                '[b] Use of temporary passwords is allowed only for an immediate change to a permanent password'
            ],
            '3.5.10': [
                '[a] Passwords are cryptographically protected in storage',
                '[b] Passwords are cryptographically protected in transit'
            ],
            '3.5.11': [
                '[a] Authentication information is obscured during the authentication process'
            ],
            // INCIDENT RESPONSE (IR) - 3 controls
            '3.6.1': [
                '[a] An operational incident-handling capability is established',
                '[b] The operational incident-handling capability includes preparation',
                '[c] The operational incident-handling capability includes detection',
                '[d] The operational incident-handling capability includes analysis',
                '[e] The operational incident-handling capability includes containment',
                '[f] The operational incident-handling capability includes recovery',
                '[g] The operational incident-handling capability includes user response activities'
            ],
            '3.6.2': [
                '[a] Incidents are tracked',
                '[b] Incidents are documented',
                '[c] Incidents are reported to designated officials and/or authorities'
            ],
            '3.6.3': [
                '[a] The incident response capability is tested'
            ],
            // MAINTENANCE (MA) - 6 controls
            '3.7.1': [
                '[a] System maintenance is performed'
            ],
            '3.7.2': [
                '[a] Controls are provided on tools, techniques, mechanisms, and personnel for system maintenance',
                '[b] Media containing diagnostic/test programs are checked for malicious code before use'
            ],
            '3.7.3': [
                '[a] Equipment to be removed from site for off-site maintenance is sanitized of CUI'
            ],
            '3.7.4': [
                '[a] Media containing diagnostic/test programs are checked for malicious code before use on the system'
            ],
            '3.7.5': [
                '[a] Sessions and network connections are terminated when nonlocal maintenance is complete',
                '[b] MFA is employed for establishing nonlocal maintenance sessions',
                '[c] Nonlocal maintenance sessions are established using FIPS-validated cryptography'
            ],
            '3.7.6': [
                '[a] Maintenance personnel without required access authorization are supervised during maintenance'
            ],
            // MEDIA PROTECTION (MP) - 9 controls
            '3.8.1': [
                '[a] Paper media containing CUI is protected',
                '[b] Digital media containing CUI is protected'
            ],
            '3.8.2': [
                '[a] Access to CUI on system media is limited to authorized users'
            ],
            '3.8.3': [
                '[a] CUI media is sanitized or destroyed before disposal',
                '[b] CUI media is sanitized before release for reuse'
            ],
            '3.8.4': [
                '[a] CUI media is marked with applicable CUI markings',
                '[b] CUI media is marked with distribution limitations'
            ],
            '3.8.5': [
                '[a] Access to CUI media is controlled',
                '[b] Accountability for CUI media during transport is maintained outside of controlled areas'
            ],
            '3.8.6': [
                '[a] Cryptographic mechanisms are implemented to protect confidentiality of CUI stored on digital media during transport (unless otherwise protected by alternative physical safeguards)'
            ],
            '3.8.7': [
                '[a] Use of removable media on system components is controlled'
            ],
            '3.8.8': [
                '[a] Use of portable storage devices is prohibited when such devices have no identifiable owner'
            ],
            '3.8.9': [
                '[a] Paper CUI in storage is protected',
                '[b] Digital CUI in storage is protected'
            ],
            // PERSONNEL SECURITY (PS) - 2 controls
            '3.9.1': [
                '[a] Individuals are screened prior to authorizing access to systems containing CUI'
            ],
            '3.9.2': [
                '[a] CUI and systems containing CUI are protected during and after personnel actions such as terminations and transfers'
            ],
            // PHYSICAL PROTECTION (PE) - 6 controls
            '3.10.1': [
                '[a] Authorized individuals with access to systems are identified',
                '[b] Physical access to the system is limited to authorized individuals'
            ],
            '3.10.2': [
                '[a] The physical facility where systems reside is monitored to detect/respond to physical security incidents'
            ],
            '3.10.3': [
                '[a] Visitors are escorted',
                '[b] Visitor activity is monitored'
            ],
            '3.10.4': [
                '[a] Audit logs of physical access are maintained'
            ],
            '3.10.5': [
                '[a] Physical access devices (keys, locks, combinations, card readers) are controlled'
            ],
            '3.10.6': [
                '[a] CUI at alternate work sites is safeguarded'
            ],
            // RISK ASSESSMENT (RA) - 3 controls
            '3.11.1': [
                '[a] Risk to organizational operations, assets, and individuals is assessed periodically'
            ],
            '3.11.2': [
                '[a] Systems and applications are scanned for vulnerabilities periodically',
                '[b] Systems and applications are scanned when new vulnerabilities affecting the system are identified'
            ],
            '3.11.3': [
                '[a] Vulnerabilities are remediated in accordance with risk assessments'
            ],
            // SECURITY ASSESSMENT (CA) - 4 controls
            '3.12.1': [
                '[a] Security controls are assessed periodically to determine if controls are effective'
            ],
            '3.12.2': [
                '[a] Deficiencies and weaknesses in security controls are addressed through a POA&M'
            ],
            '3.12.3': [
                '[a] Security controls are monitored on an ongoing basis to ensure continued effectiveness'
            ],
            '3.12.4': [
                '[a] A system security plan (SSP) is developed and documented',
                '[b] The SSP describes the system boundary',
                '[c] The SSP describes operational environment',
                '[d] The SSP describes how security requirements are implemented',
                '[e] The SSP describes relationships with or connections to other systems'
            ],
            // SYSTEM AND COMMUNICATIONS PROTECTION (SC) - 16 controls
            '3.13.1': [
                '[a] Communications at the external boundary of the system are monitored',
                '[b] Communications at key internal boundaries of the system are monitored',
                '[c] Communications at the external boundary of the system are controlled',
                '[d] Communications at key internal boundaries of the system are controlled'
            ],
            '3.13.2': [
                '[a] Security functions are separated from nonsecurity functions',
                '[b] Architectural designs, software development techniques, and systems engineering principles that promote effective information security are employed'
            ],
            '3.13.3': [
                '[a] User functionality is separated from system management functionality'
            ],
            '3.13.4': [
                '[a] Shared system resources are prevented from transferring unauthorized information between users'
            ],
            '3.13.5': [
                '[a] Publicly accessible system components are identified',
                '[b] Subnetworks for publicly accessible components are physically or logically separated from internal networks'
            ],
            '3.13.6': [
                '[a] Network communications traffic is denied by default',
                '[b] Network communications traffic is allowed by exception'
            ],
            '3.13.7': [
                '[a] Split tunneling is prevented for remote devices connecting to organizational systems'
            ],
            '3.13.8': [
                '[a] Cryptographic mechanisms are implemented to prevent unauthorized disclosure of CUI during transmission (unless otherwise protected by alternative physical safeguards)'
            ],
            '3.13.9': [
                '[a] Network connections are terminated at the end of sessions',
                '[b] Network connections are terminated after defined period of inactivity'
            ],
            '3.13.10': [
                '[a] Cryptographic keys are established and managed when cryptography is employed'
            ],
            '3.13.11': [
                '[a] FIPS-validated cryptography is employed when used to protect confidentiality of CUI'
            ],
            '3.13.12': [
                '[a] Use of collaborative computing devices is controlled',
                '[b] Remote activation of collaborative computing devices is prohibited'
            ],
            '3.13.13': [
                '[a] Use of mobile code is controlled'
            ],
            '3.13.14': [
                '[a] Use of Voice over Internet Protocol (VoIP) technologies is controlled'
            ],
            '3.13.15': [
                '[a] Communications sessions are protected for authenticity'
            ],
            '3.13.16': [
                '[a] Confidentiality of CUI at rest is protected'
            ],
            // SYSTEM AND INFORMATION INTEGRITY (SI) - 7 controls
            '3.14.1': [
                '[a] System flaws are identified',
                '[b] System flaws are reported',
                '[c] System flaws are corrected'
            ],
            '3.14.2': [
                '[a] Malicious code protection mechanisms are employed at designated locations',
                '[b] Malicious code protection mechanisms are updated when new releases are available'
            ],
            '3.14.3': [
                '[a] Security alerts/advisories are received',
                '[b] Security alerts/advisories are acted upon'
            ],
            '3.14.4': [
                '[a] The system is monitored to detect attacks and indicators of potential attacks',
                '[b] Inbound communications traffic is monitored to detect attacks and indicators of potential attacks',
                '[c] Outbound communications traffic is monitored to detect attacks and indicators of potential attacks'
            ],
            '3.14.5': [
                '[a] Incoming communications from external sources are identified',
                '[b] Incoming communications from external sources are analyzed to determine potential security threats'
            ],
            '3.14.6': [
                '[a] Communications are monitored to detect attacks and indicators of potential attacks'
            ],
            '3.14.7': [
                '[a] Authorized use of the system is defined',
                '[b] Unauthorized use of the system is identified'
            ]
        };
        
        // ==================== CONTROL DATA ====================
        const DOMAINS = {
            'ACCESS CONTROL (AC)': {
                id: 'ac', count: 22,
                controls: [
                    { id: '3.1.1', name: 'Authorized Access Control', type: 'config', req: 'Limit information system access to authorized users, processes acting on behalf of authorized users, or devices.', meaning: 'Only approved users and devices can access your systems. Maintain a list of authorized personnel.' },
                    { id: '3.1.2', name: 'Transaction & Function Control', type: 'config', req: 'Limit information system access to the types of transactions and functions that authorized users are permitted to execute.', meaning: 'Users can only do what their job requires. Use role-based access control (RBAC).' },
                    { id: '3.1.3', name: 'Control CUI Flow', type: 'config', req: 'Control the flow of CUI in accordance with approved authorizations.', meaning: 'Track and control where CUI can be sent. Use DLP tools and network segmentation.' },
                    { id: '3.1.4', name: 'Separation of Duties', type: 'policy', req: 'Separate the duties of individuals to reduce the risk of malevolent activity without collusion.', meaning: 'No single person should control an entire critical process. Prevents fraud and mistakes.' },
                    { id: '3.1.5', name: 'Least Privilege', type: 'config', req: 'Employ the principle of least privilege, including for specific security functions and privileged accounts.', meaning: 'Give users minimum access needed for their job. No unnecessary admin rights.' },
                    { id: '3.1.6', name: 'Non-Privileged Account Use', type: 'policy', req: 'Use non-privileged accounts or roles when accessing nonsecurity functions.', meaning: 'Admins use regular accounts for daily tasks. Only use admin accounts when necessary.' },
                    { id: '3.1.7', name: 'Privileged Functions', type: 'config', req: 'Prevent non-privileged users from executing privileged functions and capture the execution of such functions in audit logs.', meaning: 'Regular users cannot run admin commands. All admin actions are logged.' },
                    { id: '3.1.8', name: 'Unsuccessful Logon Attempts', type: 'config', req: 'Limit unsuccessful logon attempts.', meaning: 'Lock accounts after too many failed logins (e.g., 5 attempts). Prevents brute force attacks.' },
                    { id: '3.1.9', name: 'Privacy & Security Notices', type: 'config', req: 'Provide privacy and security notices consistent with applicable CUI rules.', meaning: 'Show warning banners at login about monitoring and authorized use only.' },
                    { id: '3.1.10', name: 'Session Lock', type: 'config', req: 'Use session lock with pattern-hiding displays to prevent access and viewing of data after a period of inactivity.', meaning: 'Screen locks after inactivity (e.g., 15 min). Requires password to unlock.' },
                    { id: '3.1.11', name: 'Session Termination', type: 'config', req: 'Terminate (automatically) a user session after a defined condition.', meaning: 'Auto-logoff after extended inactivity or at end of day.' },
                    { id: '3.1.12', name: 'Control Remote Access', type: 'mixed', req: 'Monitor and control remote access sessions.', meaning: 'Track all remote connections. Use VPN with logging. Approve remote access.' },
                    { id: '3.1.13', name: 'Remote Access Confidentiality', type: 'config', req: 'Employ cryptographic mechanisms to protect the confidentiality of remote access sessions.', meaning: 'Encrypt all remote connections (VPN, TLS). No unencrypted remote access.' },
                    { id: '3.1.14', name: 'Remote Access Routing', type: 'config', req: 'Route remote access via managed access control points.', meaning: 'All remote access goes through controlled entry points like VPN concentrators.' },
                    { id: '3.1.15', name: 'Privileged Remote Access', type: 'policy', req: 'Authorize remote execution of privileged commands and remote access to security-relevant information.', meaning: 'Extra approval needed for remote admin access. Document who has this access.' },
                    { id: '3.1.16', name: 'Wireless Access Authorization', type: 'policy', req: 'Authorize wireless access prior to allowing such connections.', meaning: 'WiFi access requires approval. No unauthorized wireless access points.' },
                    { id: '3.1.17', name: 'Wireless Access Protection', type: 'config', req: 'Protect wireless access using authentication and encryption.', meaning: 'Use WPA2/WPA3 Enterprise. No WEP or open networks for CUI systems.' },
                    { id: '3.1.18', name: 'Mobile Device Connection', type: 'mixed', req: 'Control connection of mobile devices.', meaning: 'Approve and track mobile devices. Use MDM to enforce security policies.' },
                    { id: '3.1.19', name: 'Encrypt CUI on Mobile', type: 'config', req: 'Encrypt CUI on mobile devices and mobile computing platforms.', meaning: 'Full device encryption on all mobile devices that handle CUI.' },
                    { id: '3.1.20', name: 'External Connections', type: 'config', req: 'Verify and control/limit connections to and use of external information systems.', meaning: 'Control access to personal devices and external systems. Approve cloud services.' },
                    { id: '3.1.21', name: 'Portable Storage Use', type: 'mixed', req: 'Limit use of portable storage devices on external systems.', meaning: 'Restrict USB drives on non-company systems. Encrypt portable storage.' },
                    { id: '3.1.22', name: 'Control Public Information', type: 'policy', req: 'Control information posted or processed on publicly accessible information systems.', meaning: 'Review before posting to websites. Ensure no CUI is publicly accessible.' },
                ]
            },
            'AWARENESS AND TRAINING (AT)': {
                id: 'at', count: 3,
                controls: [
                    { id: '3.2.1', name: 'Role-Based Risk Awareness', type: 'policy', req: 'Ensure that managers, systems administrators, and users are made aware of the security risks associated with their activities.', meaning: 'Security awareness training for all staff. Cover phishing, social engineering, policies.' },
                    { id: '3.2.2', name: 'Role-Based Training', type: 'policy', req: 'Ensure that personnel are trained to carry out their assigned information security-related duties.', meaning: 'Job-specific security training. Admins get technical training, users get awareness.' },
                    { id: '3.2.3', name: 'Insider Threat Awareness', type: 'policy', req: 'Provide security awareness training on recognizing and reporting potential indicators of insider threat.', meaning: 'Train staff to recognize suspicious behavior. Provide reporting mechanisms.' },
                ]
            },
            'AUDIT AND ACCOUNTABILITY (AU)': {
                id: 'au', count: 9,
                controls: [
                    { id: '3.3.1', name: 'System Auditing', type: 'software', req: 'Create and retain system audit logs and records to the extent needed to enable the monitoring, analysis, investigation, and reporting of unlawful or unauthorized system activity.', meaning: 'Log all security events. Retain logs for investigation. Use SIEM for analysis.' },
                    { id: '3.3.2', name: 'User Accountability', type: 'config', req: 'Ensure that the actions of individual system users can be uniquely traced to those users.', meaning: 'No shared accounts. Every action traceable to a specific person.' },
                    { id: '3.3.3', name: 'Event Review', type: 'policy', req: 'Review and update logged events.', meaning: 'Regularly review audit logs. Update what is logged based on threats.' },
                    { id: '3.3.4', name: 'Audit Failure Alerting', type: 'software', req: 'Alert in the event of an audit logging process failure.', meaning: 'Get alerts when logging stops working. Ensure continuous audit coverage.' },
                    { id: '3.3.5', name: 'Audit Correlation', type: 'software', req: 'Correlate audit record review, analysis, and reporting processes for investigation and response.', meaning: 'Use SIEM tools to correlate logs from multiple sources for security analysis.' },
                    { id: '3.3.6', name: 'Reduction & Reporting', type: 'software', req: 'Provide audit record reduction and report generation to support on-demand analysis.', meaning: 'Use tools to filter, summarize, and report on audit data. Generate security reports.' },
                    { id: '3.3.7', name: 'Authoritative Time Source', type: 'config', req: 'Provide a system capability that compares and synchronizes internal system clocks.', meaning: 'Sync all system clocks to NTP server. Ensures accurate timestamps for audit logs.' },
                    { id: '3.3.8', name: 'Audit Protection', type: 'config', req: 'Protect audit information and audit logging tools from unauthorized access, modification, and deletion.', meaning: 'Restrict access to audit logs to security personnel only. Use write-once storage.' },
                    { id: '3.3.9', name: 'Audit Management', type: 'policy', req: 'Limit management of audit logging functionality to a subset of privileged users.', meaning: 'Only designated security admins can modify audit configurations.' },
                ]
            },
            'CONFIGURATION MANAGEMENT (CM)': {
                id: 'cm', count: 9,
                controls: [
                    { id: '3.4.1', name: 'System Baselining', type: 'policy', req: 'Establish and maintain baseline configurations and inventories of organizational systems.', meaning: 'Create standard configurations for computers/servers. Maintain hardware/software inventory.' },
                    { id: '3.4.2', name: 'Security Configuration Enforcement', type: 'config', req: 'Establish and enforce security configuration settings for information technology products.', meaning: 'Use security configuration guides (STIGs, CIS Benchmarks). Prevent unauthorized changes.' },
                    { id: '3.4.3', name: 'System Change Management', type: 'policy', req: 'Track, review, approve or disapprove, and log changes to organizational systems.', meaning: 'Document all system changes. Require approval before implementing changes.' },
                    { id: '3.4.4', name: 'Security Impact Analysis', type: 'policy', req: 'Analyze the security impact of changes prior to implementation.', meaning: 'Evaluate how proposed changes affect security before implementing them.' },
                    { id: '3.4.5', name: 'Access Restrictions for Change', type: 'config', req: 'Define, document, approve, and enforce physical and logical access restrictions associated with changes.', meaning: 'Limit who can make system changes. Require authentication for configuration changes.' },
                    { id: '3.4.6', name: 'Least Functionality', type: 'config', req: 'Employ the principle of least functionality by configuring systems to provide only essential capabilities.', meaning: 'Disable unnecessary services, ports, and protocols. Remove unused software.' },
                    { id: '3.4.7', name: 'Nonessential Functionality', type: 'config', req: 'Restrict, disable, or prevent the use of nonessential programs, functions, ports, protocols, and services.', meaning: 'Block unnecessary network ports. Disable unused system services.' },
                    { id: '3.4.8', name: 'Application Execution Policy', type: 'mixed', req: 'Apply deny-by-exception (blacklisting) policy to prevent the use of unauthorized software.', meaning: 'Use application whitelisting/blacklisting to control what software can run.' },
                    { id: '3.4.9', name: 'User-Installed Software', type: 'policy', req: 'Control and monitor user-installed software.', meaning: 'Restrict users from installing software. Monitor for unauthorized installations.' },
                ]
            },
            'IDENTIFICATION AND AUTHENTICATION (IA)': {
                id: 'ia', count: 11,
                controls: [
                    { id: '3.5.1', name: 'Identification', type: 'config', req: 'Identify system users, processes acting on behalf of users, and devices.', meaning: 'Assign unique identifiers to all users, processes, and devices accessing systems.' },
                    { id: '3.5.2', name: 'Authentication', type: 'config', req: 'Authenticate (or verify) the identities of users, processes, or devices, as a prerequisite to allowing access.', meaning: 'Require passwords/credentials before granting system access.' },
                    { id: '3.5.3', name: 'Multifactor Authentication', type: 'mixed', req: 'Use multifactor authentication for local and network access to privileged accounts and for network access to non-privileged accounts.', meaning: 'Implement MFA (password + phone/token) for admin and remote access.' },
                    { id: '3.5.4', name: 'Replay-Resistant Authentication', type: 'config', req: 'Employ replay-resistant authentication mechanisms for network access.', meaning: 'Use authentication protocols that prevent replay attacks (Kerberos, TLS, OTP).' },
                    { id: '3.5.5', name: 'Identifier Reuse', type: 'policy', req: 'Prevent reuse of identifiers for a defined period.', meaning: 'Don\'t reassign usernames to new users for a defined period after account deletion.' },
                    { id: '3.5.6', name: 'Identifier Handling', type: 'policy', req: 'Disable identifiers after a defined period of inactivity.', meaning: 'Disable accounts after 90 days of inactivity. Disable accounts of terminated users immediately.' },
                    { id: '3.5.7', name: 'Password Complexity', type: 'config', req: 'Enforce a minimum password complexity and change of characters when new passwords are created.', meaning: 'Require 12+ characters, mixed case, numbers, symbols. Prevent simple passwords.' },
                    { id: '3.5.8', name: 'Password Reuse', type: 'config', req: 'Prohibit password reuse for a specified number of generations.', meaning: 'Prevent reuse of previous 24 passwords. Enforce password history.' },
                    { id: '3.5.9', name: 'Temporary Passwords', type: 'policy', req: 'Allow temporary password use for system logons with an immediate change to a permanent password.', meaning: 'Force users to change temporary/initial passwords immediately upon first login.' },
                    { id: '3.5.10', name: 'Cryptographically-Protected Passwords', type: 'config', req: 'Store and transmit only cryptographically-protected passwords.', meaning: 'Hash passwords in databases. Use encrypted connections for authentication.' },
                    { id: '3.5.11', name: 'Obscure Feedback', type: 'config', req: 'Obscure feedback of authentication information.', meaning: 'Mask password entry with dots/asterisks. Don\'t display passwords on screen.' },
                ]
            },
            'INCIDENT RESPONSE (IR)': {
                id: 'ir', count: 3,
                controls: [
                    { id: '3.6.1', name: 'Incident Handling', type: 'policy', req: 'Establish an operational incident-handling capability including preparation, detection, analysis, containment, recovery, and user response.', meaning: 'Create incident response procedures. Establish IR team and contact lists.' },
                    { id: '3.6.2', name: 'Incident Reporting', type: 'policy', req: 'Track, document, and report incidents to designated officials and/or authorities.', meaning: 'Document all incidents. Report to management and authorities as required.' },
                    { id: '3.6.3', name: 'Incident Response Testing', type: 'policy', req: 'Test the organizational incident response capability.', meaning: 'Conduct tabletop exercises or simulations to test IR procedures annually.' },
                ]
            },
            'MAINTENANCE (MA)': {
                id: 'ma', count: 6,
                controls: [
                    { id: '3.7.1', name: 'Perform Maintenance', type: 'policy', req: 'Perform maintenance on organizational systems.', meaning: 'Conduct regular system maintenance including patching and updates.' },
                    { id: '3.7.2', name: 'System Maintenance Control', type: 'policy', req: 'Provide controls on the tools, techniques, mechanisms, and personnel used to conduct system maintenance.', meaning: 'Control who performs maintenance and what tools they use. Inspect tools.' },
                    { id: '3.7.3', name: 'Equipment Sanitization', type: 'policy', req: 'Ensure equipment removed for off-site maintenance is sanitized of any CUI.', meaning: 'Remove all CUI data before sending equipment for repair. Verify sanitization.' },
                    { id: '3.7.4', name: 'Media Inspection', type: 'policy', req: 'Check media containing diagnostic and test programs for malicious code before use.', meaning: 'Scan maintenance media for malware before connecting to systems.' },
                    { id: '3.7.5', name: 'Nonlocal Maintenance', type: 'mixed', req: 'Require multifactor authentication to establish nonlocal maintenance sessions and terminate such connections when complete.', meaning: 'MFA required for remote maintenance. Close connections when done.' },
                    { id: '3.7.6', name: 'Maintenance Personnel', type: 'policy', req: 'Supervise the maintenance activities of maintenance personnel without required access authorization.', meaning: 'Escort and supervise third-party maintenance personnel at all times.' },
                ]
            },
            'MEDIA PROTECTION (MP)': {
                id: 'mp', count: 9,
                controls: [
                    { id: '3.8.1', name: 'Media Protection', type: 'hardware', req: 'Protect (i.e., physically control and securely store) system media containing CUI, both paper and digital.', meaning: 'Lock up CUI documents and drives. Control access to media storage areas.' },
                    { id: '3.8.2', name: 'Media Access', type: 'policy', req: 'Limit access to CUI on system media to authorized users.', meaning: 'Only authorized personnel can access CUI media. Document who has access.' },
                    { id: '3.8.3', name: 'Media Disposal', type: 'policy', req: 'Sanitize or destroy system media containing CUI before disposal or release for reuse.', meaning: 'Shred paper. Wipe or destroy hard drives. Follow NIST 800-88 guidelines.' },
                    { id: '3.8.4', name: 'Media Markings', type: 'policy', req: 'Mark media with necessary CUI markings and distribution limitations.', meaning: 'Label CUI media with appropriate markings. Include handling instructions.' },
                    { id: '3.8.5', name: 'Media Accountability', type: 'policy', req: 'Control access to media containing CUI and maintain accountability for media during transport.', meaning: 'Track who has CUI media. Log media when transported outside secure areas.' },
                    { id: '3.8.6', name: 'Portable Storage Encryption', type: 'config', req: 'Implement cryptographic mechanisms to protect the confidentiality of CUI stored on digital media during transport.', meaning: 'Encrypt USB drives and portable storage containing CUI.' },
                    { id: '3.8.7', name: 'Removable Media', type: 'mixed', req: 'Control the use of removable media on system components.', meaning: 'Restrict USB device usage. Use endpoint protection to control removable media.' },
                    { id: '3.8.8', name: 'Shared Media', type: 'policy', req: 'Prohibit the use of portable storage devices when such devices have no identifiable owner.', meaning: 'No anonymous USB drives. All portable storage must be registered to an owner.' },
                    { id: '3.8.9', name: 'Protect Backups', type: 'mixed', req: 'Protect the confidentiality of backup CUI at storage locations.', meaning: 'Encrypt backups containing CUI. Secure backup storage locations.' },
                ]
            },
            'PERSONNEL SECURITY (PS)': {
                id: 'ps', count: 2,
                controls: [
                    { id: '3.9.1', name: 'Screen Individuals', type: 'policy', req: 'Screen individuals prior to authorizing access to organizational systems containing CUI.', meaning: 'Background checks before granting CUI access. Verify employment/identity.' },
                    { id: '3.9.2', name: 'Personnel Actions', type: 'policy', req: 'Ensure that organizational systems containing CUI are protected during and after personnel actions such as terminations and transfers.', meaning: 'Immediately revoke access when employees leave. Update access for transfers.' },
                ]
            },
            'PHYSICAL PROTECTION (PE)': {
                id: 'pe', count: 6,
                controls: [
                    { id: '3.10.1', name: 'Limit Physical Access', type: 'hardware', req: 'Limit physical access to organizational systems, equipment, and the respective operating environments to authorized individuals.', meaning: 'Use badges, locks, guards. Only authorized personnel in server rooms.' },
                    { id: '3.10.2', name: 'Monitor Facility', type: 'hardware', req: 'Protect and monitor the physical facility and support infrastructure for organizational systems.', meaning: 'Security cameras, intrusion detection. Monitor server rooms and data centers.' },
                    { id: '3.10.3', name: 'Escort Visitors', type: 'policy', req: 'Escort visitors and monitor visitor activity.', meaning: 'Visitors must be escorted at all times in secure areas. Log visitor access.' },
                    { id: '3.10.4', name: 'Physical Access Logs', type: 'hardware', req: 'Maintain audit logs of physical access.', meaning: 'Log all badge swipes and physical access. Review logs for anomalies.' },
                    { id: '3.10.5', name: 'Manage Physical Access', type: 'hardware', req: 'Control and manage physical access devices.', meaning: 'Manage keys, badges, and access cards. Recover credentials from departing staff.' },
                    { id: '3.10.6', name: 'Alternative Work Sites', type: 'policy', req: 'Enforce safeguarding measures for CUI at alternate work sites.', meaning: 'Security requirements apply to home offices and remote work locations.' },
                ]
            },
            'RISK ASSESSMENT (RA)': {
                id: 'ra', count: 3,
                controls: [
                    { id: '3.11.1', name: 'Risk Assessments', type: 'policy', req: 'Periodically assess the risk to organizational operations, assets, and individuals resulting from the operation of organizational systems.', meaning: 'Conduct annual risk assessments. Identify and evaluate threats and vulnerabilities.' },
                    { id: '3.11.2', name: 'Vulnerability Scan', type: 'software', req: 'Scan for vulnerabilities in organizational systems and applications periodically and when new vulnerabilities are identified.', meaning: 'Run vulnerability scanners regularly (monthly/quarterly). Scan after changes.' },
                    { id: '3.11.3', name: 'Vulnerability Remediation', type: 'policy', req: 'Remediate vulnerabilities in accordance with risk assessments.', meaning: 'Fix high-risk vulnerabilities first. Track remediation progress.' },
                ]
            },
            'SECURITY ASSESSMENT (CA)': {
                id: 'ca', count: 4,
                controls: [
                    { id: '3.12.1', name: 'Security Control Assessment', type: 'policy', req: 'Periodically assess the security controls in organizational systems to determine if the controls are effective.', meaning: 'Annual security assessments. Test if controls actually work.' },
                    { id: '3.12.2', name: 'Plan of Action', type: 'policy', req: 'Develop and implement plans of action designed to correct deficiencies and reduce or eliminate vulnerabilities.', meaning: 'POA&M for security gaps. Track progress on fixing issues.' },
                    { id: '3.12.3', name: 'Security Control Monitoring', type: 'software', req: 'Monitor security controls on an ongoing basis to ensure the continued effectiveness of the controls.', meaning: 'Continuous monitoring. Don\'t just assess annually - watch continuously.' },
                    { id: '3.12.4', name: 'System Security Plan', type: 'policy', req: 'Develop, document, and periodically update system security plans.', meaning: 'Create and maintain SSP. Document how you meet each security requirement.' },
                ]
            },
            'SYSTEM AND COMMUNICATIONS PROTECTION (SC)': {
                id: 'sc', count: 16,
                controls: [
                    { id: '3.13.1', name: 'Boundary Protection', type: 'hardware', req: 'Monitor, control, and protect organizational communications at the external boundaries and key internal boundaries.', meaning: 'Use firewalls at network boundaries. Monitor traffic in and out.' },
                    { id: '3.13.2', name: 'Security Engineering', type: 'mixed', req: 'Employ architectural designs, software development techniques, and systems engineering principles that promote effective information security.', meaning: 'Build security into system design. Defense in depth architecture.' },
                    { id: '3.13.3', name: 'Security Function Isolation', type: 'config', req: 'Separate user functionality from system management functionality.', meaning: 'Admin interfaces separate from user interfaces. Management networks isolated.' },
                    { id: '3.13.4', name: 'Shared Resource Control', type: 'config', req: 'Prevent unauthorized and unintended information transfer via shared system resources.', meaning: 'Prevent data leakage in multi-tenant environments. Clear memory between uses.' },
                    { id: '3.13.5', name: 'Public-Access System Separation', type: 'config', req: 'Implement subnetworks for publicly accessible system components that are physically or logically separated from internal networks.', meaning: 'DMZ for public-facing servers. Web servers isolated from internal network.' },
                    { id: '3.13.6', name: 'Network Communication by Exception', type: 'config', req: 'Deny network communications traffic by default and allow network communications traffic by exception.', meaning: 'Default deny firewall rules. Only allow necessary traffic explicitly.' },
                    { id: '3.13.7', name: 'Split Tunneling', type: 'config', req: 'Prevent remote devices from simultaneously establishing non-remote connections with organizational systems and communicating via some other connection to resources in external networks.', meaning: 'Disable split tunneling on VPN. All traffic goes through corporate network.' },
                    { id: '3.13.8', name: 'Data in Transit', type: 'config', req: 'Implement cryptographic mechanisms to prevent unauthorized disclosure of CUI during transmission.', meaning: 'Encrypt CUI in transit. Use TLS 1.2+ for all network communications.' },
                    { id: '3.13.9', name: 'Connections Termination', type: 'config', req: 'Terminate network connections associated with communications sessions at the end of the sessions or after a defined period of inactivity.', meaning: 'Auto-disconnect idle sessions. Don\'t leave connections open indefinitely.' },
                    { id: '3.13.10', name: 'Key Management', type: 'policy', req: 'Establish and manage cryptographic keys for cryptography employed in organizational systems.', meaning: 'Manage encryption keys securely. Rotate keys, protect key storage.' },
                    { id: '3.13.11', name: 'CUI Encryption', type: 'config', req: 'Employ FIPS-validated cryptography when used to protect the confidentiality of CUI.', meaning: 'Use FIPS 140-2 validated encryption for CUI. AES-256 for data at rest.' },
                    { id: '3.13.12', name: 'Collaborative Device Control', type: 'config', req: 'Prohibit remote activation of collaborative computing devices and provide indication of devices in use.', meaning: 'Control webcams and microphones. Indicator lights when devices are active.' },
                    { id: '3.13.13', name: 'Mobile Code', type: 'config', req: 'Control and monitor the use of mobile code.', meaning: 'Control JavaScript, ActiveX, Flash. Use browser security settings.' },
                    { id: '3.13.14', name: 'Voice over IP', type: 'config', req: 'Control and monitor the use of Voice over Internet Protocol (VoIP) technologies.', meaning: 'Secure VoIP systems. Monitor for unauthorized use.' },
                    { id: '3.13.15', name: 'Communications Authenticity', type: 'config', req: 'Protect the authenticity of communications sessions.', meaning: 'Use certificates for server authentication. Prevent man-in-the-middle attacks.' },
                    { id: '3.13.16', name: 'Data at Rest', type: 'config', req: 'Protect the confidentiality of CUI at rest.', meaning: 'Encrypt CUI when stored. Full disk encryption on endpoints.' },
                ]
            },
            'SYSTEM AND INFORMATION INTEGRITY (SI)': {
                id: 'si', count: 7,
                controls: [
                    { id: '3.14.1', name: 'Flaw Remediation', type: 'policy', req: 'Identify, report, and correct information and information system flaws in a timely manner.', meaning: 'Patch systems promptly. Track vulnerabilities and fixes.' },
                    { id: '3.14.2', name: 'Malicious Code Protection', type: 'software', req: 'Provide protection from malicious code at appropriate locations within organizational information systems.', meaning: 'Install antivirus/antimalware on all systems. Keep definitions updated.' },
                    { id: '3.14.3', name: 'Security Alerts', type: 'policy', req: 'Monitor system security alerts and advisories and take action in response.', meaning: 'Subscribe to security alerts (US-CERT, vendors). Act on critical alerts.' },
                    { id: '3.14.4', name: 'Update Malicious Code Protection', type: 'software', req: 'Update malicious code protection mechanisms when new releases are available.', meaning: 'Auto-update AV signatures. Keep malware protection current.' },
                    { id: '3.14.5', name: 'System & File Scanning', type: 'software', req: 'Perform periodic scans of the information system and real-time scans of files from external sources.', meaning: 'Weekly full system scans. Real-time scanning of downloads and email.' },
                    { id: '3.14.6', name: 'Monitor Communications', type: 'software', req: 'Monitor organizational systems, including inbound and outbound communications traffic, to detect attacks and indicators of potential attacks.', meaning: 'Use IDS/IPS. Monitor network traffic for threats.' },
                    { id: '3.14.7', name: 'Identify Unauthorized Use', type: 'software', req: 'Identify unauthorized use of organizational systems.', meaning: 'Monitor for policy violations. Detect unauthorized access attempts.' },
                ]
            }
        };

        const DOMAIN_NAMES = Object.keys(DOMAINS);
        
        const TYPE_STYLES = {
            policy: { bg: '#2E86AB', label: 'Policy/Process' },
            config: { bg: '#A23B72', label: 'Configuration' },
            software: { bg: '#F18F01', label: 'Software/Tool' },
            hardware: { bg: '#C73E1D', label: 'Hardware' },
            mixed: { bg: '#7B2D8E', label: 'Mixed' }
        };

        // ==================== CCA MODE DATA ====================
        const ETHICS_QUESTIONS = [
            { q: "A CCA's brother works as the IT Director at an OSC. The CCA has been assigned to assess this company. What should they do?", options: ["Proceed but document the relationship", "Recuse themselves from the assessment", "Get written consent from the OSC", "Only assess controls their brother doesn't manage"], correct: 1, explanation: "CCAs must recuse themselves when family members work at the OSC. This is a direct conflict of interest per the Code of Professional Conduct.", category: "Conflict of Interest" },
            { q: "How long must a CCA wait after providing consulting services to an OSC before they can assess that same organization?", options: ["6 months", "1 year", "2 years", "3 years"], correct: 3, explanation: "Per 32 CFR ¬ß170.8(b)(17)(ii)(G), there's a 3-year prohibition on assessing organizations you've consulted for.", category: "Cooling Off Period" },
            { q: "An OSC offers a CCA a $500 gift card as thanks for a smooth assessment. What should the CCA do?", options: ["Accept if under $1000", "Politely decline", "Accept but report it", "Donate it to charity"], correct: 1, explanation: "CCAs must decline gifts that could influence or appear to influence their judgment. Accepting creates a conflict of interest.", category: "Gifts & Impartiality" },
            { q: "After completing an assessment, a CCA is asked by a journalist about the OSC's security posture. What should they say?", options: ["Provide general comments only", "Share only positive findings", "Decline to comment entirely", "Refer them to the OSC"], correct: 2, explanation: "Confidentiality requirements persist after the engagement ends. CCAs cannot disclose ANY assessment information to third parties.", category: "Confidentiality" },
            { q: "A CCA notices during assessment that an OSC has unreported CUI spillage. What is required?", options: ["Note it in findings only", "Report to C3PAO and require incident response", "Ignore if not in scope", "Give them time to fix it"], correct: 1, explanation: "CCAs must report security incidents. CUI spillage requires immediate notification and proper incident handling.", category: "Incident Reporting" },
            { q: "A CCP wants to perform CMMC assessments independently without a C3PAO. Is this permitted?", options: ["Yes, CCPs can assess independently", "Only for Level 1 assessments", "No, CCPs cannot lead assessments", "Only with CAICO approval"], correct: 2, explanation: "CCPs can only participate in assessments as part of a C3PAO assessment team. They cannot conduct assessments independently.", category: "Role Boundaries" },
            { q: "Who may a CCI consult for after becoming certified?", options: ["Any organization except OSCs", "No one - CCIs cannot consult", "Only C3PAOs", "Only government agencies"], correct: 1, explanation: "CCIs (Instructors) are prohibited from providing consulting services. They can only train and develop exam content.", category: "CCI Restrictions" },
            { q: "An OSC asks a CCA to use their personal laptop for the assessment because their C3PAO systems are slow. What should the CCA do?", options: ["Use it to help the client", "Decline - only authorized C3PAO systems allowed", "Use it but don't store data", "Get C3PAO approval first"], correct: 1, explanation: "Assessment activities must be conducted on authorized C3PAO systems only. Personal devices are prohibited.", category: "Proper Use of Technology" },
            { q: "During assessment, a CCA finds the OSC has excellent marketing materials but weak technical controls. How should this affect scoring?", options: ["Give partial credit for effort", "Score based only on objective evidence", "Consider company size and resources", "Weight marketing as documentation"], correct: 1, explanation: "All OSCs are subject to the same assessment standards regardless of size, reputation, or presentation quality. Only objective evidence matters.", category: "Impartiality" },
            { q: "A CCA discovers a minor administrative error in their assessment report after submission. What should they do?", options: ["Ignore if minor", "Notify the responsible C3PAO immediately", "Contact the OSC directly", "Wait for the next assessment"], correct: 1, explanation: "CCAs must immediately notify their responsible C3PAO of any errors, omissions, or security concerns - even minor ones.", category: "Honesty & Integrity" },
            { q: "May a CCA use AI tools to process OSC customer data during an assessment?", options: ["Yes, if efficient", "Only with encryption", "No - prohibited for customer data", "Only for non-CUI data"], correct: 2, explanation: "Customer data must not be submitted to Internet-accessible AI/ML tools per the Code of Professional Conduct.", category: "AI Restrictions" },
            { q: "How often must a CCA report their continuing education and qualifications?", options: ["Monthly", "Quarterly", "Annually", "Only at renewal"], correct: 2, explanation: "CCAs must annually report to the Accreditation Body/CAICO demonstrating continued qualification requirements.", category: "Disclosure Requirements" }
        ];
        
        // ==================== CAP PROCESS QUIZ ====================
        const CAP_QUESTIONS = [
            { q: "What are the FOUR phases of the CMMC Assessment Process (CAP)?", options: ["Planning, Execution, Reporting, Closure", "Pre-Assessment, Assessment, Results, Certificate/POA&M", "Scoping, Testing, Validation, Certification", "Discovery, Evaluation, Remediation, Certification"], correct: 1, explanation: "The 4 phases are: Phase 1 (Pre-Assessment), Phase 2 (Assessment), Phase 3 (Complete/Report Results), Phase 4 (Issue Certificate & Close-Out POA&M).", category: "CAP Phases" },
            { q: "Who leads the Assessment Team and serves as counterpart to the Affirming Official?", options: ["Quality Assurance Individual", "Authorized Certifying Official", "Lead CCA", "OSC POC"], correct: 2, explanation: "The Lead CCA oversees and manages the Assessment Team on behalf of the C3PAO. They serve as counterpart to the OSC's Affirming Official.", category: "CAP Roles" },
            { q: "Who is responsible for uploading assessment results into CMMC eMASS?", options: ["Lead CCA", "Affirming Official", "Quality Assurance Individual", "Any CCA on the team"], correct: 2, explanation: "The C3PAO Quality Assurance Individual uploads certification assessment results into CMMC eMASS after conducting quality review.", category: "CAP Roles" },
            { q: "Can a QA individual be a member of the Assessment Team they're reviewing?", options: ["Yes, if they're the Lead CCA", "Yes, but only for Phase 1", "No, they must be separate", "Only with C3PAO approval"], correct: 2, explanation: "A QA individual must be a CCA and CANNOT be a member of the Assessment Team for which they're performing QA.", category: "CAP Roles" },
            { q: "When must the In-Brief Meeting occur?", options: ["Before Phase 1 begins", "At the start of Phase 2, before assessing requirements", "After Phase 2 testing completes", "It's optional"], correct: 1, explanation: "The Lead CCA shall convene an In-Brief Meeting prior to commencement of assessing security requirements (start of Phase 2).", category: "CAP Process" },
            { q: "What must the Assessment Team use when assessing CMMC Level 2 requirements?", options: ["ANY reasonable sampling approach", "FOCUSED assessment method", "100% testing of all controls", "Statistical sampling"], correct: 1, explanation: "For Level 2 certification assessments, the Assessment Team SHALL use FOCUSED assessment methods as defined in the methodology.", category: "Assessment Method" },
            { q: "How long after Phase 2 can assessors re-evaluate NOT MET requirements?", options: ["5 business days", "10 business days", "30 calendar days", "Until the Out-Brief Meeting"], correct: 1, explanation: "Assessors may re-evaluate NOT MET security requirements for 10 business days following the conclusion of Phase 2 assessment activities.", category: "Assessment Process" },
            { q: "Who must approve and sign the Certificate of CMMC Status?", options: ["Lead CCA", "Quality Assurance Individual", "Authorized Certifying Official", "The Cyber AB"], correct: 2, explanation: "An Authorized Certifying Official reviews and signs the Certificate to convey formal issuance on behalf of the C3PAO.", category: "Certificate Issuance" },
            { q: "Within how many days must an OSC close out a POA&M to obtain FINAL certification?", options: ["90 days", "180 days", "365 days", "No time limit"], correct: 1, explanation: "All POA&M requirements must be remedied within 180 days of receiving Conditional certification.", category: "POA&M Rules" },
            { q: "Can an OSC use a different C3PAO for POA&M close-out than the one that did the original assessment?", options: ["No, must use same C3PAO", "Yes, any authorized C3PAO", "Only with DoD approval", "Only if original C3PAO agrees"], correct: 1, explanation: "The OSC may engage a C3PAO different from the one that conducted Phases 1-3. The POA&M close-out C3PAO assumes responsibility for FINAL status.", category: "POA&M Rules" },
            { q: "What minimum attendance is required at the Out-Brief Meeting?", options: ["Lead CCA only", "Lead CCA and Affirming Official only", "Lead CCA, Affirming Official, OSC POC, and all Assessment Team members", "Anyone the C3PAO designates"], correct: 2, explanation: "Attendees shall include Lead CCA, Affirming Official, OSC POC, and ALL Assessment Team members. OSC can insist all attend.", category: "Out-Brief Meeting" },
            { q: "How long must the OSC retain hashed artifacts used as evidence?", options: ["3 years from assessment date", "6 years from CMMC Status Date", "Until next assessment", "Indefinitely"], correct: 1, explanation: "The OSC must retain hashed artifacts used as evidence for 6 years from the CMMC Status Date on their certificate.", category: "Evidence Retention" },
            { q: "Is the CMMC Level 2 Certificate of CMMC Status considered CUI?", options: ["Yes, always", "Only if marked", "No, it is not CUI", "Only during assessment"], correct: 2, explanation: "The CMMC Level 2 Certificate of CMMC Status is NOT considered CUI and is not required to be stored, processed, or transmitted as such.", category: "Certificate Rules" },
            { q: "Who initiates the engagement for a CMMC Level 2 certification assessment?", options: ["DoD", "The Cyber AB", "The C3PAO", "The OSC"], correct: 3, explanation: "An OSC generally initiates the engagement by contacting an authorized or accredited C3PAO.", category: "Assessment Initiation" },
            { q: "What is required before the CMMC Level 2 certification assessment can proceed to Phase 2?", options: ["OSC payment in full", "Resolution of any CMMC Assessment Scope disagreements", "DoD approval", "The Cyber AB notification"], correct: 1, explanation: "Any disagreements concerning the CMMC Assessment Scope must be resolved between C3PAO and OSC before proceeding to Phase 2.", category: "Phase 1 Requirements" },
            { q: "Can the C3PAO offer 'pay for pass' arrangements?", options: ["Yes, if disclosed", "Only for small businesses", "No, strictly prohibited", "Yes, with OSC consent"], correct: 2, explanation: "The C3PAO is prohibited from offering any 'pay for pass' arrangements relating to assessment results.", category: "Contract Rules" },
            { q: "During Phase 2, who convenes the Daily Checkpoint Meeting?", options: ["The Affirming Official", "The OSC POC", "The Assessment Team", "The QA Individual"], correct: 2, explanation: "The Assessment Team shall host a Daily Checkpoint Meeting with the OSC POC and other OSC representatives during assessment.", category: "Phase 2 Process" },
            { q: "What happens if the Assessment Team cannot confirm proper incorporation of an ESP in the assessment scope?", options: ["Proceed without assessing ESP", "Mark all ESP controls N/A", "Discuss with Affirming Official about not proceeding", "Automatically fail the OSC"], correct: 2, explanation: "If ESP incorporation cannot be confirmed, the C3PAO should confer with the OSC Affirming Official and discuss not proceeding.", category: "ESP Handling" }
        ];
        
        // ==================== SCOPING QUIZ ====================
        const SCOPING_QUESTIONS = [
            { q: "Which asset category includes assets that process, store, or transmit CUI?", options: ["Security Protection Assets", "Contractor Risk Managed Assets", "CUI Assets", "Specialized Assets"], correct: 2, explanation: "CUI Assets are assets that process, store, or transmit CUI. They must be documented in inventory, SSP, and network diagrams.", category: "Asset Categories" },
            { q: "What is the key distinction between Out-of-Scope assets and Contractor Risk Managed Assets (CRMA)?", options: ["CRMA requires assessment, Out-of-Scope doesn't", "Out-of-Scope CUI can NEVER flow there; CRMA CUI COULD flow there", "They're functionally equivalent", "CRMA is for cloud, Out-of-Scope is for on-prem"], correct: 1, explanation: "Out-of-Scope = CUI can NEVER flow there (physical/logical separation). CRMA = CUI COULD flow there but organization ensures it doesn't through policy.", category: "Asset Categories" },
            { q: "What are Security Protection Assets?", options: ["Assets storing CUI backups", "Assets providing security functions regardless of CUI handling", "Encrypted storage devices", "Cloud security services only"], correct: 1, explanation: "Security Protection Assets provide security functions or capabilities to the CMMC Assessment Scope, WHETHER OR NOT they process/store/transmit CUI.", category: "Asset Categories" },
            { q: "Which of the following is an example of a Specialized Asset?", options: ["Domain controller", "Firewall", "IoT sensor that cannot support endpoint protection", "Encrypted laptop"], correct: 2, explanation: "Specialized Assets include IoT/IIoT, OT, test equipment, and other systems that cannot support standard security capabilities due to technical limitations.", category: "Asset Categories" },
            { q: "An ESP that stores CUI must have what to be acceptable for use by an OSC?", options: ["ISO 27001 certification", "SOC 2 Type II report", "FedRAMP Moderate authorization OR equivalency, or Level 2 Certificate", "NIST CSF assessment"], correct: 2, explanation: "ESPs handling CUI must demonstrate FedRAMP Moderate (or higher) authorization, FedRAMP equivalency, OR hold a valid Level 2 Certificate of CMMC Status.", category: "ESP Requirements" },
            { q: "What document must an ESP provide to support the OSC's assessment?", options: ["Service Level Agreement (SLA)", "Customer Responsibility Matrix (CRM)", "Statement of Work (SOW)", "Master Service Agreement (MSA)"], correct: 1, explanation: "A Customer Responsibility Matrix (CRM) identifies which CMMC requirements are performed wholly, partially, or jointly by the ESP.", category: "ESP Requirements" },
            { q: "What does CMMC Assessment Scope define?", options: ["Only the CUI-handling systems", "The set of ALL assets to be assessed against CMMC requirements", "The security controls to be tested", "The assessment timeline"], correct: 1, explanation: "The CMMC Assessment Scope is the set of ALL assets in the OSC's environment that will be assessed against CMMC security requirements.", category: "Scoping Fundamentals" },
            { q: "Which of these 18 security requirements may require on-site validation?", options: ["Password complexity requirements", "Physical protection and maintenance controls", "Audit logging requirements", "Awareness training controls"], correct: 1, explanation: "Physical protection (PE) and maintenance (MA) controls are among the 18 requirements that may require in-person on-site validation.", category: "On-Site Requirements" },
            { q: "Can CMMC Assessment Scope include multiple CAGE codes?", options: ["No, one CAGE code per assessment", "Yes, if associated with a singular assessment scope", "Only with DoD approval", "Only for Level 1"], correct: 1, explanation: "A single CMMC assessment may cover multiple entities if more than one CAGE code is associated with a singular CMMC Level 2 Assessment Scope.", category: "Scope Boundaries" },
            { q: "Where must the OSC document their CUI Assets?", options: ["Only in the SSP", "Asset inventory, SSP, AND network diagram", "Only in network diagrams", "In SPRS only"], correct: 1, explanation: "CUI Assets must be documented in the asset inventory, the System Security Plan (SSP), AND the network diagram of the CMMC Assessment Scope.", category: "Documentation Requirements" },
            { q: "If an OSC's ESP is FedRAMP Authorized at Moderate baseline, what must the Assessment Team verify?", options: ["Nothing - FedRAMP is automatically accepted", "That the specific cloud service offering is listed in the FedRAMP Marketplace", "That the OSC paid for the authorization", "Only the authorization date"], correct: 1, explanation: "The Assessment Team must verify the authorization AND that the specific cloud service offering is documented in the FedRAMP Marketplace.", category: "FedRAMP Verification" },
            { q: "What does FedRAMP 'equivalency' mean in CMMC context?", options: ["SOC 2 Type II certification", "CSP meets FedRAMP Moderate requirements but isn't authorized", "ISO 27001 certification", "DoD-specific cloud authorization"], correct: 1, explanation: "FedRAMP equivalency means the CSP meets FedRAMP Moderate security requirements but hasn't gone through official FedRAMP authorization.", category: "FedRAMP Equivalency" }
        ];
        
        // ==================== TERMINOLOGY TRAPS (Exam gotcha questions!) ====================
        const TERMINOLOGY_QUESTIONS = [
            { q: "What is the difference between 'Lead CCA' and 'Lead Assessor'?", options: ["They're the same thing", "Lead CCA is formal designation; Lead Assessor is informal", "Lead Assessor is higher rank", "Lead CCA is for Level 3 only"], correct: 1, explanation: "Lead CCA is the formal qualified designation issued by CAICO. 'Lead Assessor' is sometimes used informally but Lead CCA is the correct term.", category: "Role Terminology" },
            { q: "What is the difference between the 'Affirming Official' and the 'Authorized Certifying Official'?", options: ["Same person, different phases", "Affirming Official is OSC side; Authorized Certifying Official is C3PAO side", "Affirming Official issues certificate", "They're interchangeable terms"], correct: 1, explanation: "Affirming Official = OSC executive who affirms assessment. Authorized Certifying Official = C3PAO official who signs the certificate.", category: "Role Terminology" },
            { q: "What is the difference between 'adequate' and 'sufficient' evidence?", options: ["They mean the same thing", "Adequate = right kind/quality; Sufficient = enough quantity/coverage", "Adequate = quantity; Sufficient = quality", "Neither term is used in CMMC"], correct: 1, explanation: "Adequate evidence is the RIGHT KIND/QUALITY. Sufficient evidence means ENOUGH coverage across the scope. You need BOTH.", category: "Evidence Terminology" },
            { q: "CUI vs FCI: Which requires Level 2 certification?", options: ["FCI requires Level 2", "CUI requires Level 2", "Both require Level 2", "Neither - both are Level 1"], correct: 1, explanation: "CUI requires Level 2. FCI only requires Level 1. CUI is a subset of FCI with additional protection requirements.", category: "Data Classification" },
            { q: "What's the difference between EO 13526 and EO 13556?", options: ["Both establish CUI Program", "13526 = Classified info; 13556 = CUI Program", "13526 = CUI Program; 13556 = Classified info", "They're the same Executive Order"], correct: 1, explanation: "EO 13556 (2010) established the CUI Program. EO 13526 covers CLASSIFIED information. Common exam trap!", category: "Regulatory References" },
            { q: "NIST SP 800-171 vs NIST SP 800-171A: What's the difference?", options: ["Same document, different versions", "800-171 = requirements; 800-171A = assessment procedures", "800-171A replaced 800-171", "800-171 is for government; 800-171A is for contractors"], correct: 1, explanation: "800-171 contains the REQUIREMENTS. 800-171A contains the ASSESSMENT PROCEDURES for evaluating those requirements.", category: "Standards" },
            { q: "What is the difference between 'MET' and 'NOT APPLICABLE (N/A)'?", options: ["Both mean the control passes", "MET = implemented; N/A = control doesn't apply to the environment", "N/A means partially implemented", "MET requires evidence; N/A doesn't"], correct: 1, explanation: "MET = control is implemented and meets all objectives. N/A = control doesn't apply to this assessment scope (with documented justification).", category: "Assessment Findings" },
            { q: "What's the difference between a C3PAO and The Cyber AB?", options: ["Same organization", "C3PAO assesses OSCs; Cyber AB accredits C3PAOs", "Cyber AB assesses OSCs", "C3PAO accredits Cyber AB"], correct: 1, explanation: "C3PAOs conduct assessments of OSCs. The Cyber AB is the sole Accreditation Body that accredits C3PAOs and certifies assessors.", category: "Ecosystem Roles" },
            { q: "Basic Security Requirements vs Derived Security Requirements: Where do they come from?", options: ["Both from NIST 800-171", "Basic from FIPS 200; Derived from NIST 800-53", "Both from FIPS 200", "Basic from 800-53; Derived from FIPS 200"], correct: 1, explanation: "Basic requirements come from FIPS 200. Derived requirements are tailored from NIST SP 800-53 moderate baseline.", category: "Standards Origin" },
            { q: "Examine vs Test assessment methods: What's the key difference?", options: ["Examine is faster", "Examine reviews documentation/mechanisms; Test exercises them under conditions", "Test is only for technical controls", "They're interchangeable"], correct: 1, explanation: "EXAMINE = reviewing, inspecting, studying documentation and mechanisms. TEST = exercising mechanisms under specified conditions to compare actual vs expected behavior.", category: "Assessment Methods" },
            { q: "CONDITIONAL vs FINAL Certificate of CMMC Status: What's the difference?", options: ["CONDITIONAL is temporary with POA&M; FINAL means all requirements MET", "CONDITIONAL is for Level 1; FINAL is for Level 2", "They're the same validity period", "CONDITIONAL requires re-assessment"], correct: 0, explanation: "CONDITIONAL = some NOT MET items in POA&M (must close within 180 days). FINAL = all requirements MET or POA&M successfully closed.", category: "Certification Types" },
            { q: "What differentiates 'interview' from 'examine' assessment methods?", options: ["Interview is for technical staff only", "Interview = discussions with individuals; Examine = reviewing objects", "Examine is for people; Interview is for documents", "They're both documentation review"], correct: 1, explanation: "INTERVIEW = holding discussions with individuals to obtain evidence. EXAMINE = reviewing specifications, mechanisms, activities (objects, not people).", category: "Assessment Methods" }
        ];
        
        // ==================== BEST ANSWER SCENARIOS (Multiple plausible options!) ====================
        const BEST_ANSWER_QUESTIONS = [
            { q: "During assessment, you find the OSC has a policy requiring MFA but technical implementation only covers 80% of privileged accounts. What is the BEST assessment finding?", options: ["MET - they have a policy and mostly implemented", "NOT MET - implementation doesn't match policy across all accounts", "CONDITIONAL MET - good progress shown", "N/A - partial implementation doesn't count"], correct: 1, explanation: "NOT MET is correct. The control requires MFA for ALL privileged accounts. 80% is not full implementation regardless of policy existence.", category: "Assessment Judgment" },
            { q: "The OSC presents a 200-page SSP. During review, you notice it's mostly copy/pasted templates with minimal customization. What's the BEST approach?", options: ["Accept it - SSP exists as required", "Fail them immediately for poor documentation", "Interview staff to verify actual implementation beyond the document", "Request they rewrite the entire SSP"], correct: 2, explanation: "Interview and examine actual implementation. Documents show intent; testing shows reality. A template SSP isn't automatic failure but requires verification.", category: "Assessment Judgment" },
            { q: "An OSC's 90-day password expiration policy conflicts with current NIST guidance recommending against arbitrary expiration. How should you assess IA.L2-3.5.7?", options: ["NOT MET - doesn't follow NIST best practices", "MET - complexity requirements are defined and enforced", "Recommend they change policy first", "Cannot assess until policy is updated"], correct: 1, explanation: "Assess against the CMMC requirement (password complexity), not general best practices. If complexity requirements ARE defined and enforced, it's MET.", category: "Standards Application" },
            { q: "You discover the OSC's CUI boundary includes a subnet they forgot to document in their SSP. The systems ARE properly protected. BEST action?", options: ["Automatically NOT MET for CA.L2-3.12.4 (SSP)", "MET - systems are protected even if documentation gap exists", "Document the finding but assess technical controls normally", "Stop assessment until SSP is corrected"], correct: 2, explanation: "Document the SSP gap (may affect CA.L2-3.12.4), but assess the technical controls on those systems. Documentation issues don't automatically fail technical implementation.", category: "Documentation vs Implementation" },
            { q: "The OSC uses a cloud ESP that claims 'FedRAMP equivalent' security but isn't in the FedRAMP Marketplace. What's the BEST approach?", options: ["Accept their claim - they said it's equivalent", "Automatically reject - must be FedRAMP Authorized", "Request the Body of Evidence (BoE) demonstrating equivalency", "Ignore the ESP and assess only on-prem systems"], correct: 2, explanation: "FedRAMP equivalency is acceptable, but requires verifiable BoE. Request evidence including all required elements per the scoping guide.", category: "ESP Verification" },
            { q: "During interview, a system administrator gives conflicting information about their backup procedures compared to the documented policy. BEST action?", options: ["Trust the documentation over verbal statements", "Trust the administrator over documentation", "Test the actual backup system to verify which is accurate", "Average the two accounts for your finding"], correct: 2, explanation: "When documentation and interviews conflict, TEST the actual implementation. Testing provides objective evidence of actual behavior.", category: "Evidence Hierarchy" },
            { q: "The OSC shows you audit logs, but the retention period is 60 days instead of policy-required 90 days. However, they DO have offline backups extending to 90+ days. BEST assessment?", options: ["NOT MET - primary system doesn't meet 90 days", "MET - combination of online and offline meets retention requirement", "Partial credit for effort", "Cannot determine without more testing"], correct: 1, explanation: "The REQUIREMENT is retention for the defined period. If offline backups extend retention to meet the policy, the objective is satisfied.", category: "Compensating Controls" },
            { q: "An OSC has excellent technical controls but their employees couldn't articulate the security awareness training they received. How assess AT.L2-3.2.1?", options: ["MET - training records exist", "NOT MET - employees must demonstrate awareness", "Test a sample of employees with security questions", "Trust the documentation of completed training"], correct: 2, explanation: "Interview method tests whether training was EFFECTIVE. If employees can't articulate basic awareness, additional sampling or testing may be warranted.", category: "Training Verification" },
            { q: "You find the OSC's vulnerability scanning runs weekly, but policy states 'regularly' without defining frequency. Is this sufficient for RA.L2-3.11.2?", options: ["NOT MET - 'regularly' must be defined with specific frequency", "MET - weekly is reasonable and regular", "Cannot assess without defined frequency in policy", "NOT MET - must be daily scanning"], correct: 1, explanation: "Weekly scanning IS regular. The policy not defining 'regularly' is a documentation issue but doesn't fail the technical implementation if scanning occurs consistently.", category: "Policy Interpretation" },
            { q: "During testing, you find a single workstation with outdated antivirus signatures (3 days old) in a population of 500 systems. BEST assessment for SI.L2-3.14.2?", options: ["NOT MET - any gap fails the control", "MET - 499/500 is acceptable sampling", "MET with observation about the outlier", "Expand testing before determination"], correct: 3, explanation: "One outlier in sampling could be anomaly or systemic issue. Expand testing to determine if this is isolated incident or pattern before final determination.", category: "Sampling Decisions" }
        ];
        
        // ==================== TEST STRATEGY TIPS ====================
        const TEST_STRATEGY_TIPS = [
            { tip: "Read the QUESTION before the scenario", detail: "Read what they're actually asking FIRST, then read the scenario. It helps you focus on what matters and avoid getting lost in details." },
            { tip: "Questions may be poorly worded", detail: "Some questions have grammatical issues or confusing phrasing. Focus on the INTENT of the question, not perfect grammar." },
            { tip: "Look for the BEST answer, not just a correct answer", detail: "Often 2-3 answers seem correct. Pick the MOST complete or MOST accurate answer, not just one that's technically true." },
            { tip: "Watch for terminology traps", detail: "C3PAO Certified Assessor vs Lead Assessor, Affirming Official vs Authorized Certifying Official - know the exact terms." },
            { tip: "CAP and Scoping Guide are heavily tested", detail: "The exam is built from foundational documents: CAP + Scoping Guide + Assessment Guide. Don't rely solely on LTP slides." },
            { tip: "Controls are spelled out on the exam", detail: "You don't need to memorize control numbers or objectives word-for-word. They'll be provided. Focus on HOW TO ASSESS them." },
            { tip: "Understand MET vs NOT MET logic", detail: "ALL objectives must be satisfied for MET. No partial credit at objective level. One failure = NOT MET for that practice." },
            { tip: "Know the 4 phases of CAP", detail: "Phase 1: Pre-Assessment, Phase 2: Assessment, Phase 3: Results, Phase 4: Certificate/POA&M. Know what happens in each." },
            { tip: "POA&M rules matter", detail: "180 days to close out. Cannot exceed 80% of requirements in POA&M. Only certain controls are POA&M-eligible." },
            { tip: "Evidence hierarchy: Test > Interview > Examine", detail: "Testing shows what IS. Interviews show what people BELIEVE. Documents show INTENT. Know when to escalate." }
        ];

        const GOTCHA_QUESTIONS = [
            { q: "When was NIST SP 800-171 FIRST published?", options: ["December 2017", "June 2015", "November 2021", "February 2020"], correct: 1, explanation: "NIST SP 800-171 was first published in June 2015. December 2017 is when DFARS 7012 went into effect - a common confusion!", category: "Regulatory History" },
            { q: "DFARS 252.204-7012 became effective on what date?", options: ["June 2015", "November 2021", "December 31, 2017", "October 2024"], correct: 2, explanation: "DFARS 7012 became effective December 31, 2017. This is when contractors were required to implement 800-171.", category: "Regulatory History" },
            { q: "What is the MAXIMUM score possible on a CMMC Level 2 assessment?", options: ["100 points", "110 points", "172 points", "320 points"], correct: 1, explanation: "The maximum score is 110 points - one point for each of the 110 Level 2 security requirements.", category: "Scoring" },
            { q: "Which controls have PARTIAL SCORING in CMMC Level 2?", options: ["Any high-value control", "Only IA.L2-3.5.3 and SC.L2-3.13.11", "All 5-point controls", "PE and PS controls only"], correct: 1, explanation: "Only TWO controls have partial scoring: MFA (IA.L2-3.5.3) and FIPS Encryption (SC.L2-3.13.11). All others are binary MET/NOT MET.", category: "Scoring" },
            { q: "A control is NOT MET if:", options: ["More than 50% of objectives fail", "Any single objective is not satisfied", "The primary objective fails", "It depends on control weight"], correct: 1, explanation: "ALL assessment objectives must be MET for a practice to be MET. There is no partial credit at the objective level.", category: "Scoring" },
            { q: "What distinguishes Out of Scope assets from CRMA?", options: ["CRMA has CUI, Out of Scope doesn't", "Out of Scope CUI can NEVER flow there; CRMA CUI COULD flow there", "They're the same thing", "CRMA requires assessment, Out of Scope doesn't"], correct: 1, explanation: "Out of Scope = CUI can NEVER flow there (physical/logical separation). CRMA = CUI COULD flow there but doesn't based on policy.", category: "Asset Categories" },
            { q: "The CMMC 2.0 framework was announced in:", options: ["June 2015", "December 2017", "November 2021", "October 2024"], correct: 2, explanation: "CMMC 2.0 was announced November 2021, streamlining the original 5-level model to 3 levels.", category: "Regulatory History" },
            { q: "The 32 CFR Part 170 final rule was published in:", options: ["November 2021", "December 2017", "October 2024", "June 2015"], correct: 2, explanation: "The final rule establishing CMMC requirements was published October 15, 2024.", category: "Regulatory History" },
            { q: "Which Executive Order established the CUI Program?", options: ["EO 13526", "EO 13556", "EO 14028", "EO 12333"], correct: 1, explanation: "EO 13556 (2010) established the CUI Program. EO 13526 is about CLASSIFIED information - a common trick!", category: "Regulatory History" },
            { q: "NIST SP 800-171 derived requirements come from:", options: ["FAR 52.204-21", "FIPS 200", "NIST SP 800-53", "DFARS 7012"], correct: 2, explanation: "The derived requirements in 800-171 come from NIST SP 800-53 moderate baseline controls. Basic requirements come from FIPS 200.", category: "Standards Origin" },
            { q: "The purpose of CMMC is to:", options: ["Create new security requirements", "Replace NIST 800-171", "VERIFY implementation of existing requirements", "Simplify compliance"], correct: 2, explanation: "CMMC doesn't create new controls - it VERIFIES that contractors have actually implemented 800-171 requirements.", category: "CMMC Purpose" },
            { q: "What is required for a cloud service provider handling CUI?", options: ["SOC 2 Type II", "ISO 27001", "FedRAMP Moderate or equivalent", "Any security certification"], correct: 2, explanation: "CSPs handling CUI must meet FedRAMP Moderate baseline (or equivalent) per 32 CFR Part 170.", category: "Cloud Requirements" },
            { q: "Evidence is 'adequate' when it is:", options: ["Sufficient quantity", "The right KIND of evidence", "Both quality and quantity", "Approved by the OSC"], correct: 1, explanation: "Adequate = right KIND (quality/relevance). Sufficient = ENOUGH of the right kind (quantity). They're different!", category: "Evidence Terms" },
            { q: "Can an SSP be placed on a POA&M?", options: ["Yes, if other documentation exists", "Yes, for up to 180 days", "No, SSP must exist at assessment time", "Only for self-assessments"], correct: 2, explanation: "Per 32 CFR 170.24(c)(5), OSAs must have an SSP in place at assessment time. It cannot be POA&M'd.", category: "POA&M Rules" },
            { q: "A Security Protection Asset (SPA) is:", options: ["An asset containing CUI", "An asset that protects CUI assets (like firewalls)", "An out of scope asset", "A specialized asset"], correct: 1, explanation: "SPAs provide security functions for CUI assets - firewalls, SIEM, domain controllers, etc. They don't store CUI but protect systems that do.", category: "Asset Categories" },
            { q: "The POA&M closeout deadline is:", options: ["90 days", "120 days", "180 days", "1 year"], correct: 2, explanation: "POA&M items must be closed within 180 days of Conditional certification, or the certification expires.", category: "POA&M Rules" }
        ];

        const JUDGMENT_SCENARIOS = [
            // === SCOPING & ASSET CATEGORIES ===
            { category: "Scoping Judgment", scenario: "A contractor has a smart TV in their conference room connected to the corporate network. Employees occasionally cast presentations from laptops that handle CUI. The contractor has categorized this TV as Out of Scope because 'it's just a display device.'", options: ["Accept ‚Äî TVs don't store data", "Flag as a scoping error ‚Äî CUI is transmitted to/displayed on this device", "Categorize as a CRMA since CUI could flow there", "Recommend they unplug the TV"], correct: 1, explanation: "If CUI is being cast/displayed on the TV, CUI IS being transmitted to that device. It cannot be Out of Scope because CUI demonstrably flows there.", mindset: "A reasonable assessor looks at data FLOW, not device TYPE. The question isn't 'is this a TV?' but 'does CUI touch this asset?'" },
            { category: "Scoping Judgment", scenario: "A contractor's HR system is on the same network segment as CUI systems but the contractor insists HR data never contains CUI. They've categorized the HR server as Out of Scope.", options: ["Accept as Out of Scope since it doesn't contain CUI", "Categorize as CRMA ‚Äî it's on a network where CUI COULD flow", "Categorize as a Security Protection Asset", "Require physical network separation before accepting Out of Scope"], correct: 1, explanation: "Out of Scope means CUI can NEVER flow there (physical/logical separation). CRMA means CUI COULD flow there but doesn't based on documented business processes.", mindset: "The distinction between Out of Scope and CRMA is about POSSIBILITY, not actuality. If CUI COULD reach an asset, it's in scope as CRMA." },
            { category: "Scoping Judgment", scenario: "A contractor has a dedicated jump server used by IT administrators to access CUI systems. The jump server itself never stores CUI ‚Äî it's just a transit point for remote administration.", options: ["Out of Scope ‚Äî no CUI is stored on it", "CUI Asset ‚Äî administrators access CUI through it", "Security Protection Asset (SPA) ‚Äî it protects/provides access to CUI assets", "CRMA ‚Äî CUI could flow there"], correct: 2, explanation: "Security Protection Assets provide security functions for CUI assets. A jump server controlling access to CUI systems is a security protection mechanism.", mindset: "SPAs aren't defined by whether they HOLD CUI, but whether they PROTECT systems that do. Firewalls, domain controllers, SIEM servers, jump boxes ‚Äî all SPAs." },
            
            // === EVIDENCE EVALUATION ===
            { category: "Evidence Evaluation", scenario: "A contractor shows you a comprehensive Access Control policy dated 2019. When you ask for implementation evidence, they say 'we follow this policy' but cannot produce screenshots, configurations, or logs.", options: ["MET ‚Äî the policy is comprehensive", "NOT MET ‚Äî policy alone without implementation evidence is insufficient", "Request more time for them to gather evidence", "MET with observation that documentation should be updated"], correct: 1, explanation: "Policy ‚â† Implementation. Assessment requires EVIDENCE that controls are implemented, not just documented intent.", mindset: "Interviews tell you what they BELIEVE. Documentation shows INTENT. Testing shows what's ACTUALLY happening. A reasonable assessor needs all three aligned." },
            { category: "Evidence Evaluation", scenario: "A contractor provides a policy document with 'DRAFT' watermarked on every page. The IT manager says 'It's basically final, we just haven't removed the watermark.'", options: ["Accept ‚Äî content matters, not watermark", "Reject ‚Äî drafts cannot be evidence per 32 CFR 170.24", "Accept with manager sign-off", "Accept with POA&M to finalize"], correct: 1, explanation: "Per 32 CFR 170.24(b)(1), 'All evidence must be in final form and not draft. Unacceptable forms include working papers, drafts, and unofficial policies.'", mindset: "The rule is explicit: no drafts. A reasonable assessor cannot accept draft evidence regardless of verbal assurances." },
            { category: "Evidence Evaluation", scenario: "A contractor's vulnerability scan report is 8 months old. They say they scan quarterly but didn't bring more recent reports. The scan shows a clean environment.", options: ["MET ‚Äî the scan shows compliance", "NOT MET ‚Äî evidence is too old", "Request current scan results before making a determination", "MET with observation to improve retention"], correct: 2, explanation: "An 8-month-old scan doesn't demonstrate CURRENT security posture. However, request current evidence ‚Äî assessors can ask for additional evidence during assessment.", mindset: "Evidence staleness matters. A reasonable assessor asks: 'Does this evidence prove the control is implemented NOW?'" },
            { category: "Evidence Evaluation", scenario: "The System Administrator confidently describes their patch management process. However, when you examine WSUS, you see the last sync was 6 months ago and most systems show 'Update Status: Unknown.'", options: ["Trust the interview ‚Äî the admin knows their environment", "Trust the technical evidence ‚Äî WSUS shows reality", "Split the difference ‚Äî partially MET", "Ask for clarification before making a determination"], correct: 3, explanation: "When interview and technical evidence conflict, dig deeper. Perhaps they use a different tool. A reasonable assessor asks clarifying questions before assuming NOT MET.", mindset: "Conflicting evidence is a signal to investigate, not immediately conclude. Ask: 'I see WSUS shows X ‚Äî can you explain?'" },
            { category: "Evidence Evaluation", scenario: "A contractor shows their Incident Response Plan covering preparation, detection, analysis, containment, recovery, and user response. However, they admit they've never actually had a security incident.", options: ["NOT MET ‚Äî no evidence of actual incident handling", "MET ‚Äî the plan establishes the CAPABILITY as required", "Require a tabletop exercise to prove capability", "NOT MET without evidence of plan testing"], correct: 1, explanation: "IR.L2-3.6.1 requires establishing an incident-handling CAPABILITY, not proving you've handled incidents. The plan IS the capability. Testing is separate (3.6.3).", mindset: "Read the requirement precisely. 'Establish an operational incident-handling capability' doesn't require actual incidents." },
            
            // === ADEQUATE vs SUFFICIENT EVIDENCE (CRITICAL CONCEPT!) ===
            { category: "Adequate vs Sufficient", scenario: "For IA.L2-3.5.3 (MFA), a contractor provides their MFA policy document stating 'All users must use multifactor authentication.' No other evidence is provided.", options: ["ADEQUATE and SUFFICIENT ‚Äî policy covers requirement", "ADEQUATE but NOT SUFFICIENT ‚Äî right type but not enough", "NOT ADEQUATE and NOT SUFFICIENT ‚Äî policy alone shows intent, not implementation", "SUFFICIENT but NOT ADEQUATE ‚Äî enough quantity but wrong type"], correct: 2, explanation: "A policy document shows INTENT, not implementation. Evidence must prove MFA is actually deployed. This is neither adequate (wrong kind) nor sufficient (doesn't cover scope).", mindset: "ADEQUATE = right KIND of evidence. SUFFICIENT = enough COVERAGE. A policy alone fails both tests ‚Äî you need proof of implementation." },
            { category: "Adequate vs Sufficient", scenario: "For IA.L2-3.5.3 (MFA), a contractor shows you a screenshot of their MFA login prompt from ONE workstation in the Accounting department.", options: ["ADEQUATE and SUFFICIENT ‚Äî shows MFA is implemented", "ADEQUATE but NOT SUFFICIENT ‚Äî right evidence type but only covers one area", "NOT ADEQUATE ‚Äî screenshots aren't valid evidence", "SUFFICIENT but NOT ADEQUATE ‚Äî covers scope but wrong evidence type"], correct: 1, explanation: "A screenshot of MFA working IS the right kind of evidence (adequate), but one department doesn't prove organization-wide implementation (not sufficient).", mindset: "This is the classic trap! Evidence can be the RIGHT KIND but not ENOUGH. One screenshot proves MFA exists somewhere ‚Äî not that it's deployed everywhere in scope." },
            { category: "Adequate vs Sufficient", scenario: "For IA.L2-3.5.3 (MFA), a contractor provides screenshots of MFA login prompts from all 5 departments, plus system configuration showing MFA is enforced organization-wide via Conditional Access policy.", options: ["ADEQUATE but NOT SUFFICIENT ‚Äî need more evidence types", "SUFFICIENT but NOT ADEQUATE ‚Äî need different evidence", "ADEQUATE and SUFFICIENT ‚Äî right evidence type with full coverage", "Neither ‚Äî need live demonstration"], correct: 2, explanation: "Multiple screenshots across all departments (coverage) plus system config (enforcement proof) = both adequate (right kind) AND sufficient (full scope).", mindset: "This is what GOOD evidence looks like: correct type AND comprehensive coverage. Screenshots + config + all departments = both tests passed." },
            { category: "Adequate vs Sufficient", scenario: "For AU.L2-3.3.1 (System Auditing), a contractor shows comprehensive audit logs from their domain controller. However, they have 50 CUI assets and only showed logs from 1 system.", options: ["ADEQUATE and SUFFICIENT ‚Äî DC logs are comprehensive", "ADEQUATE but NOT SUFFICIENT ‚Äî right evidence but only 1 of 50 systems", "NOT ADEQUATE ‚Äî need different log types", "SUFFICIENT ‚Äî DC captures all domain activity"], correct: 1, explanation: "Audit logs ARE the right kind of evidence (adequate), but 1 of 50 systems doesn't demonstrate organization-wide implementation (not sufficient). Need representative sample.", mindset: "Even great evidence from one system doesn't prove the control works everywhere. Sufficient = coverage across the FULL assessment scope." },
            { category: "Adequate vs Sufficient", scenario: "For AT.L2-3.2.1 (Security Awareness Training), contractor shows a spreadsheet listing all 200 employees with 'Training Complete' checkmarks. No other evidence provided.", options: ["ADEQUATE and SUFFICIENT ‚Äî shows all employees trained", "ADEQUATE but NOT SUFFICIENT ‚Äî need training from more departments", "NOT ADEQUATE but SUFFICIENT ‚Äî covers everyone but wrong evidence type", "Neither adequate nor sufficient"], correct: 2, explanation: "A self-reported spreadsheet isn't adequate evidence ‚Äî it shows a CLAIM, not proof. You need training records, completion certificates, or LMS reports. Coverage is there, but evidence type is weak.", mindset: "A spreadsheet someone typed up isn't proof of training. ADEQUATE evidence would be LMS completion records, signed acknowledgments, or training certificates." },
            { category: "Adequate vs Sufficient", scenario: "For AT.L2-3.2.1 (Security Awareness Training), contractor provides LMS completion reports showing training records for 180 of 200 employees.", options: ["ADEQUATE and SUFFICIENT ‚Äî LMS reports are valid evidence", "ADEQUATE but NOT SUFFICIENT ‚Äî right evidence type but missing 20 employees", "NOT ADEQUATE ‚Äî LMS reports aren't acceptable", "SUFFICIENT ‚Äî 90% is good enough"], correct: 1, explanation: "LMS completion reports ARE adequate evidence (right kind), but 180/200 means 20 employees aren't covered. That's not sufficient ‚Äî you need 100% of in-scope personnel.", mindset: "90% isn't 100%. If 20 people with CUI access haven't completed training, the control isn't fully implemented. Close doesn't count in CMMC." },
            { category: "Adequate vs Sufficient", scenario: "Assessing SC.L2-3.13.16 (Data at Rest Encryption). Contractor shows BitLocker status for all 75 laptops (all encrypted). However, you notice they also have 3 file servers storing CUI that weren't mentioned.", options: ["ADEQUATE and SUFFICIENT ‚Äî laptops are encrypted", "ADEQUATE but NOT SUFFICIENT ‚Äî missed the file servers", "NOT ADEQUATE ‚Äî need different encryption evidence", "Ask about file server encryption before determining"], correct: 3, explanation: "The laptop evidence is adequate AND sufficient for laptops. But the assessor noticed assets not covered. Good assessor instinct ‚Äî investigate before concluding.", mindset: "Sufficient means covering the FULL scope. If you discover assets not in the evidence, you haven't achieved sufficient coverage yet. Investigate!" },
            { category: "Adequate vs Sufficient", scenario: "For CM.L2-3.4.1 (Baseline Configurations), contractor provides a 200-page document titled 'System Baseline Standards' that describes configurations in detail. When you ask to see actual system configs, they say 'just look at the document.'", options: ["ADEQUATE and SUFFICIENT ‚Äî detailed baseline document", "ADEQUATE but NOT SUFFICIENT ‚Äî need to verify on actual systems", "NOT ADEQUATE ‚Äî documentation alone doesn't prove implementation", "SUFFICIENT but NOT ADEQUATE ‚Äî covers scope but wrong evidence"], correct: 2, explanation: "A baseline DOCUMENT shows what SHOULD be configured, not what IS configured. You need to examine/test actual systems to verify the baseline is applied.", mindset: "Baseline documentation is necessary but not sufficient. 'We have a standard' isn't 'systems match the standard.' Verify implementation!" },
            { category: "Adequate vs Sufficient", scenario: "You're assessing AC.L2-3.1.7 (Privileged Functions). Contractor shows that Domain Admins can't browse the web (technical restriction). However, they have 8 different privileged roles and only demonstrated restriction for one.", options: ["ADEQUATE and SUFFICIENT ‚Äî demonstrated the control works", "ADEQUATE but NOT SUFFICIENT ‚Äî only showed 1 of 8 privileged roles", "NOT ADEQUATE ‚Äî need policy documentation too", "MET ‚Äî one example proves the concept"], correct: 1, explanation: "The demonstration IS adequate evidence (shows technical enforcement), but 1 of 8 roles isn't sufficient coverage. Need to verify restrictions apply to ALL privileged roles.", mindset: "Sampling is acceptable, but 1 of 8 isn't a representative sample. Either test more roles or get evidence that the same restriction applies to all." },
            { category: "Adequate vs Sufficient", scenario: "For PS.L2-3.9.1 (Screen Individuals), contractor shows background check results for their 5 most recent hires. They have 150 employees total with CUI access.", options: ["ADEQUATE and SUFFICIENT ‚Äî shows screening process works", "ADEQUATE but NOT SUFFICIENT ‚Äî only 5 of 150 employees", "NOT ADEQUATE ‚Äî need HR policy documentation", "SUFFICIENT ‚Äî recent hires prove current process"], correct: 1, explanation: "Background check results ARE adequate evidence. But 5 of 150 raises the question: what about the other 145? Need evidence that ALL personnel with CUI access were screened.", mindset: "Recent hires prove the current process works, but CMMC requires ALL personnel be screened. Ask: 'Can you show screening for longer-tenured employees too?'" },
            
            // === PARTIAL IMPLEMENTATION ===
            { category: "Partial Implementation", scenario: "An organization has MFA for all remote access and privileged accounts, but local non-privileged users in the office don't use MFA.", options: ["MET ‚Äî they have MFA implemented", "NOT MET ‚Äî all users must have MFA", "Partial credit ‚Äî 3 points subtracted instead of 5", "NOT MET with no scoring impact"], correct: 2, explanation: "IA.L2-3.5.3 is one of only TWO practices with partial scoring. MFA for remote/privileged = 3 points subtracted. No MFA = 5 points.", mindset: "Know which practices have partial scoring ‚Äî it's ONLY MFA and FIPS encryption." },
            { category: "Partial Implementation", scenario: "A contractor uses BitLocker on all laptops. However, BitLocker is NOT running in FIPS mode ‚Äî it's using standard AES-256 but without FIPS validation.", options: ["MET ‚Äî AES-256 is strong encryption", "NOT MET ‚Äî 5 points subtracted for no encryption", "NOT MET ‚Äî 3 points subtracted for non-FIPS-validated encryption", "MET with observation about FIPS mode"], correct: 2, explanation: "SC.L2-3.13.11 has partial scoring. Encryption exists but isn't FIPS-validated = 3 points. No encryption = 5 points. Must be FIPS 140-2/3 VALIDATED.", mindset: "FIPS-validated means the cryptographic MODULE was tested ‚Äî not just that an approved algorithm is used. Check the CMVP database." },
            { category: "Partial Implementation", scenario: "A contractor has MFA, but their solution uses SMS text messages for the second factor. Is this MET?", options: ["NOT MET ‚Äî SMS is not secure MFA", "MET ‚Äî SMS provides a second authentication factor", "MET but recommend upgrading", "Partial credit ‚Äî it's better than nothing"], correct: 1, explanation: "NIST 800-171 requires 'two or more factors.' SMS provides something you HAVE. While deprecated in 800-63B, CMMC doesn't prohibit it.", mindset: "Assess against the requirement as written, not industry best practice. MFA means 2+ factors. SMS qualifies." },
            
            // === INHERITANCE & ESP ===
            { category: "Inheritance", scenario: "A contractor uses a FedRAMP Moderate authorized CSP for email. When assessing SC.L2-3.13.8, they say 'our CSP handles that.' What evidence do you need?", options: ["Contractor's word is sufficient", "CSP's FedRAMP authorization letter only", "Evidence the inherited control applies to contractor's specific use AND meets objectives", "No evidence ‚Äî FedRAMP handles all SC controls"], correct: 2, explanation: "Inheritance requires evidence that: (1) CSP performs the function, (2) it applies to contractor's specific assets, (3) objectives are met.", mindset: "Inheritance isn't a blank check. Verify inherited controls are APPLICABLE to the contractor's environment." },
            { category: "Inheritance", scenario: "A contractor uses an MSP for IT management. The MSP claims to handle AU.L2-3.3.1 but doesn't have CMMC certification. They provide a Customer Responsibility Matrix.", options: ["NOT MET ‚Äî MSP must have CMMC certification", "Evaluate the CRM and interview the MSP for 'ownership'", "Accept the CRM at face value", "Contractor must do all logging themselves"], correct: 1, explanation: "Per CAP v2.0, ESPs must 'demonstrate sufficient knowledge and credible ownership' ‚Äî same standard as if contractor owned it.", mindset: "ESPs don't need CMMC certification, but they DO need to prove competence. Treat ESP claims same as contractor claims." },
            { category: "Inheritance", scenario: "A contractor uses Microsoft 365 GCC High (FedRAMP High authorized). They claim ALL security controls are inherited from Microsoft.", options: ["Accept ‚Äî FedRAMP High covers all CMMC L2 controls", "Reject ‚Äî contractor still has responsibilities that can't be inherited", "Accept for technical controls only", "Request Microsoft's full FedRAMP package"], correct: 1, explanation: "Even with FedRAMP High, contractor retains responsibilities: user access management, training, incident response, physical security of endpoints.", mindset: "FedRAMP authorization doesn't mean 'CSP does everything.' Review the Customer Responsibility Matrix." },
            { category: "Inheritance", scenario: "An ESP held a valid CMMC Level 2 certificate when assessment began, but you discover the ESP's certificate expired last week.", options: ["No impact ‚Äî ESP was certified when assessment started", "NOT MET for all inherited controls", "ESP can still support inheritance if they demonstrate control effectiveness", "Pause assessment until ESP renews"], correct: 2, explanation: "Per 32 CFR 170.19(c)(2)(ii), without valid certificate, ESP can still support inheritance BUT must demonstrate control effectiveness through normal methods.", mindset: "ESP certification is a convenience, not a requirement. Without it, assess ESP controls same as contractor's own." },
            
            // === POA&M DECISIONS ===
            { category: "POA&M Decisions", scenario: "A contractor is missing PE.L2-3.10.2 (Monitor Facility) ‚Äî no camera system monitoring their server room. Can this be POA&M'd?", options: ["Yes ‚Äî any NOT MET can go on POA&M", "No ‚Äî PE.L2-3.10.2 cannot be POA&M'd", "Yes, if contractor commits to 30-day remediation", "Only with compensating controls"], correct: 1, explanation: "Per 32 CFR 170.21(a)(2)(iii), certain physical access controls including PE.L2-3.10.2 CANNOT be POA&M'd for Conditional status.", mindset: "Know the POA&M exclusion list. Physical security controls (PE.L2-3.10.1, 3.10.2, 3.10.4, 3.10.5) are among them." },
            { category: "POA&M Decisions", scenario: "A contractor wants Conditional Level 2 status. They have 25 one-point controls NOT MET.", options: ["Acceptable ‚Äî one-point controls can all be POA&M'd", "Not acceptable ‚Äî maximum 22 one-point controls on POA&M", "Acceptable if they fix 3 during re-evaluation", "Not acceptable ‚Äî need minimum 80% MET"], correct: 1, explanation: "Per 32 CFR 170.21, POA&M can include up to 22 security requirements with value of 1. With 25 NOT MET, they exceed the limit.", mindset: "POA&Ms have quantity limits, not just exclusions. Max 22 one-point controls." },
            { category: "POA&M Decisions", scenario: "Day 170 since Conditional Level 2. Contractor still has 2 POA&M items open. What happens at day 180?", options: ["Automatic extension", "Conditional status expires ‚Äî lose certification", "POA&M items convert to 'Accepted Risk'", "Can request DoD waiver"], correct: 1, explanation: "Per 32 CFR 170.21(b), 'If POA&M is not successfully closed within 180 days, Conditional CMMC Status will expire.' No extensions.", mindset: "180 days is a hard deadline. Conditional isn't permanent." },
            
            // === RE-EVALUATION WINDOW ===
            { category: "Re-evaluation Window", scenario: "Day 8 after assessment ends, contractor emails saying they fixed AU.L2-3.3.2 and want re-evaluation. Can you re-assess?", options: ["Yes ‚Äî 10 business days after assessment for re-evaluation", "No ‚Äî only during active assessment", "Yes, but restart entire assessment", "Only if Assessment Findings Report hasn't been delivered"], correct: 3, explanation: "Per 32 CFR 170.17(c)(2), re-evaluation possible for 10 business days after, BUT ONLY if report hasn't been delivered.", mindset: "The 10-day window isn't unlimited. Once report is delivered, it's final." },
            { category: "Re-evaluation Window", scenario: "Contractor fixes a NOT MET finding during re-evaluation window. The fix involved changing firewall rules, which could affect SC.L2-3.13.1 you already marked MET.", options: ["Yes ‚Äî fix is valid regardless of other impacts", "No ‚Äî fix could impact previously MET finding", "Yes, but re-assess SC.L2-3.13.1 as well", "Accept provisionally"], correct: 1, explanation: "Per 32 CFR 170.17(c)(2)(ii), re-evaluation evidence 'cannot change or limit effectiveness of other requirements scored MET.'", mindset: "Re-evaluation isn't a loophole. Consider cascading impacts ‚Äî does this fix break something else?" },
            
            // === SSP & DOCUMENTATION ===
            { category: "SSP Judgment", scenario: "Contractor's SSP describes boundary as 'Building A network.' During assessment, you discover they also process CUI in Building B. SSP hasn't been updated.", options: ["MET ‚Äî they have an SSP", "NOT MET ‚Äî SSP doesn't accurately describe environment", "MET with observation to update", "Pause until SSP corrected"], correct: 1, explanation: "CA.L2-3.12.4 requires SSP to 'describe the boundary' accurately. An SSP that doesn't match reality fails the objectives.", mindset: "An SSP isn't just a checkbox. It must accurately reflect the environment. Verify SSP accuracy against observed reality." },
            { category: "SSP Judgment", scenario: "You arrive for assessment and contractor says 'Our SSP is on a server that crashed yesterday. We have backups but it will take a few days to restore.'", options: ["Yes ‚Äî assess without SSP", "No ‚Äî SSP must exist at assessment time", "Yes if they describe environment verbally", "Proceed with POA&M for SSP"], correct: 1, explanation: "Per 32 CFR 170.24(c)(5), 'OSAs must have an SSP in place at time of assessment.' SSP cannot be POA&M'd.", mindset: "The SSP is foundational. No SSP = no assessment." },
            
            // === AMBIGUOUS SITUATIONS ===
            { category: "Ambiguous Situations", scenario: "Contractor rotates passwords every 90 days per policy. Policy doesn't document reuse prohibition. But AD testing shows passwords can't be reused for 5 generations. Is IA.L2-3.5.8 MET?", options: ["MET ‚Äî some reuse restriction exists", "NOT MET ‚Äî policy doesn't document it", "MET ‚Äî technical implementation is evidence", "Depends on whether 5 is 'adequate'"], correct: 2, explanation: "The practice requires prohibiting reuse for a specified number. If AD is configured to prevent reuse, the TECHNICAL control is implemented.", mindset: "Technical evidence weighs heavily. If technically enforced, that's more meaningful than policy. But flag documentation gaps." },
            { category: "Ambiguous Situations", scenario: "Security awareness training completed for 98 of 100 employees. Two joined last week and haven't completed training yet.", options: ["NOT MET ‚Äî 100% must be trained", "MET ‚Äî 98% is substantially compliant", "MET if contractor has documented onboarding process requiring training within X days", "NOT MET with POA&M for 2 employees"], correct: 2, explanation: "If contractor has documented process requiring training within reasonable onboarding window, and new employees are within that window, the PROCESS works.", mindset: "Perfect point-in-time compliance isn't always realistic. Look for the PROCESS." },
            { category: "Ambiguous Situations", scenario: "Contractor uses two SIEM products ‚Äî legacy being phased out and new being implemented. Log data is split with some overlap and gaps.", options: ["NOT MET ‚Äî inconsistent implementation", "MET if COMBINED coverage meets all requirements", "NOT MET until migration complete", "MET for new system, NOT MET for legacy"], correct: 1, explanation: "If the combination of both SIEMs provides complete coverage, the control can be MET. Migration state is irrelevant if objectives are satisfied.", mindset: "Evaluate OUTCOME, not elegance. Two messy systems that together meet objectives = MET." },
            
            // === SPECIALIZED ASSETS ===
            { category: "Specialized Assets", scenario: "Defense manufacturer has CNC machines running Windows XP that receive technical drawings (CUI). Categorized as 'Specialized Assets' with network segmentation and monitoring.", options: ["No ‚Äî Windows XP cannot meet requirements", "Yes ‚Äî as Specialized Assets with compensating controls, can be MET", "Must upgrade to Windows 10", "Must be removed from scope"], correct: 1, explanation: "Specialized Assets recognize some assets CANNOT meet standard controls. Key is documentation in SSP and appropriate compensating controls.", mindset: "Manufacturing can't always upgrade legacy equipment. Has contractor documented risk and implemented reasonable compensating controls?" },
            { category: "Specialized Assets", scenario: "IoT sensors on factory floor collect telemetry combined with CUI for analysis. Sensors run embedded Linux with no ability to install endpoint protection. How assess SI.L1-3.14.2?", options: ["NOT MET ‚Äî all systems must have malicious code protection", "N/A ‚Äî embedded systems can't run AV", "MET if categorized as Specialized Asset with compensating controls", "NOT MET ‚Äî sensors must be replaced"], correct: 2, explanation: "Specialized Assets include IoT that cannot support standard security capabilities. With proper documentation and compensating controls, can be assessed appropriately.", mindset: "Specialized Asset category exists for this. Don't demand the impossible ‚Äî verify appropriate risk management." },
            
            // === NOT MET DETERMINATIONS ===
            { category: "NOT MET Determination", scenario: "Contractor has 100 CUI assets. For AU.L2-3.3.1, 95 systems have proper audit logging, but 5 recently added systems don't have logging enabled.", options: ["MET ‚Äî 95% is excellent", "NOT MET ‚Äî all CUI assets must have auditing", "Conditional MET with POA&M for 5 systems", "MET with observation"], correct: 1, explanation: "There is no 'percentage compliance' in CMMC. ALL CUI assets must meet ALL applicable controls. 5 systems without logging = NOT MET.", mindset: "CMMC doesn't grade on a curve. ALL in-scope assets must meet the control. 'Almost' isn't MET." },
            { category: "NOT MET Determination", scenario: "For AU.L2-3.3.1, objectives [a]-[e] fully satisfied, but [f] shows records deleted after 60 days instead of policy-required 90 days.", options: ["MET ‚Äî 5 out of 6 objectives is passing", "NOT MET ‚Äî ALL objectives must be satisfied", "Partial MET ‚Äî deduct proportional points", "MET with observation about retention"], correct: 1, explanation: "ALL assessment objectives must be satisfied for MET. No partial credit at objective level. One failed objective = NOT MET.", mindset: "Objectives aren't a pick-list. Missing one fails the whole practice." },
            { category: "NOT MET Determination", scenario: "Objective states: 'Determine if privileged accounts are identified.' Contractor shows list of 50 privileged accounts. During testing, you discover 3 service accounts with admin rights not on the list.", options: ["MET ‚Äî they have a process for identifying", "NOT MET ‚Äî privileged accounts not fully identified", "MET with observation to update list", "Partially MET"], correct: 1, explanation: "The objective requires accounts to BE identified. If accounts with privileged access aren't on the list, objective isn't satisfied.", mindset: "Test claims. 'We have a list' isn't enough ‚Äî verify it's complete." },
            
            // === ACCESS CONTROL (AC) SCENARIOS ===
            { category: "AC - Access Control", scenario: "For AC.L2-3.1.5 (Least Privilege), a contractor shows you their AD groups structure. The 'IT Staff' group has Domain Admin rights. When asked, they say 'All 12 IT staff need admin access for their jobs.'", options: ["MET ‚Äî they have documented groups", "NOT MET ‚Äî least privilege means minimum necessary, not everyone gets admin", "MET if all 12 truly need admin", "Request job descriptions before determining"], correct: 1, explanation: "Least privilege means users get the MINIMUM access necessary. It's highly unlikely all 12 IT staff need Domain Admin. This should be role-based with tiered access.", mindset: "Question 'everyone needs it' claims. Least privilege requires granular analysis of actual job functions." },
            { category: "AC - Access Control", scenario: "Assessing AC.L2-3.1.7 (Privileged Functions). Contractor shows non-privileged users cannot access admin consoles. However, you discover local admin rights are granted to all users 'so they can install printer drivers.'", options: ["MET ‚Äî admin consoles are restricted", "NOT MET ‚Äî local admin IS a privileged function", "MET with observation about local admin", "Partial credit for console restriction"], correct: 1, explanation: "Local administrator rights allow execution of privileged functions. The requirement is to PREVENT non-privileged users from executing privileged functions AND log when they do.", mindset: "Local admin rights = privileged functions. 'Convenience' doesn't override security requirements." },
            { category: "AC - Access Control", scenario: "For AC.L2-3.1.8 (Unsuccessful Logon Attempts), policy states accounts lock after 5 failed attempts. Testing shows lockout occurs at 5 attempts on Windows systems, but Linux servers allow unlimited attempts.", options: ["MET ‚Äî Windows systems comply", "NOT MET ‚Äî ALL systems must enforce lockout", "MET if Linux servers don't handle CUI", "NOT MET unless Linux servers are Out of Scope"], correct: 1, explanation: "If Linux servers are in scope (handle CUI or are SPAs), they must also enforce unsuccessful logon attempt limits. Partial implementation = NOT MET.", mindset: "Control applies to ALL in-scope systems. Check every platform type, not just the primary one." },
            { category: "AC - Access Control", scenario: "Contractor has AC.L2-3.1.12 (Monitor Remote Access) implemented via VPN logs. However, they admit 'We collect the logs but nobody reviews them regularly.'", options: ["MET ‚Äî logs are being collected", "NOT MET ‚Äî monitoring requires both collection AND review", "MET with observation to improve review process", "Partial MET for collection only"], correct: 1, explanation: "The control requires MONITOR and control. Monitoring implies active review, not just passive collection. Logs that nobody looks at don't provide monitoring.", mindset: "'Monitor' is an active verb. Collection without review isn't monitoring." },
            { category: "AC - Access Control", scenario: "For AC.L2-3.1.3 (Control CUI Flow), a contractor has firewalls between network segments. However, you discover users can email CUI attachments to personal Gmail accounts without restriction.", options: ["MET ‚Äî network segmentation controls flow", "NOT MET ‚Äî CUI flow via email is uncontrolled", "MET if email is encrypted", "NOT MET ‚Äî need DLP or email restrictions"], correct: 1, explanation: "Controlling CUI flow means ALL flow paths, not just network segments. Unrestricted email to personal accounts = uncontrolled CUI flow.", mindset: "Think like data. Where can CUI actually GO? Network, email, USB, cloud, print ‚Äî all flow paths need control." },
            { category: "AC - Access Control", scenario: "Assessing AC.L2-3.1.4 (Separation of Duties). In a 5-person IT shop, the same person manages user accounts, approves access requests, AND reviews audit logs.", options: ["MET ‚Äî small companies can't always separate duties", "NOT MET ‚Äî critical functions aren't separated", "MET with compensating controls documented", "NOT MET unless they implement approval workflows"], correct: 2, explanation: "Small organizations can implement compensating controls (manager approval, periodic review by leadership, etc.) when true separation isn't possible. Document in SSP.", mindset: "Small companies get flexibility with COMPENSATING controls, not exemptions. What oversight exists?" },
            { category: "AC - Access Control", scenario: "For AC.L2-3.1.19 (Encrypt CUI on Mobile), contractor shows BitLocker on laptops. You ask about phones ‚Äî they say 'We don't allow CUI on phones' but have no MDM or technical enforcement.", options: ["MET ‚Äî laptops are encrypted", "NOT MET ‚Äî no technical enforcement of phone policy", "MET if policy prohibits phone use", "Request MDM evidence or phone encryption proof"], correct: 3, explanation: "If phones aren't used for CUI, that's acceptable. But verify: Is there technical enforcement (MDM blocking CUI apps)? Or just policy? Ask for evidence either way.", mindset: "Policy claims need verification. If phones aren't in scope, how do you KNOW CUI doesn't reach them?" },
            { category: "AC - Access Control", scenario: "Contractor's wireless network (AC.L2-3.1.17) uses WPA2-Enterprise with RADIUS authentication. Guest WiFi is WPA2-Personal with posted password. Both networks reach the internet.", options: ["MET ‚Äî corporate WiFi is properly secured", "NOT MET ‚Äî guest network is insecure", "MET if guest network is isolated from CUI systems", "NOT MET ‚Äî all WiFi must use Enterprise authentication"], correct: 2, explanation: "The control applies to wireless access to systems containing CUI. If guest network is properly isolated and can't reach CUI systems, it may be Out of Scope.", mindset: "Scope matters. Guest WiFi that's truly isolated from CUI environment may not need Enterprise auth." },
            
            // === AUDIT AND ACCOUNTABILITY (AU) SCENARIOS ===
            { category: "AU - Audit", scenario: "For AU.L2-3.3.1 (System Auditing), contractor shows Windows Event Logs on all systems. However, logs only retain 7 days due to disk space constraints.", options: ["MET ‚Äî they're logging events", "NOT MET ‚Äî retention is insufficient for investigation", "MET if they can justify 7 days", "NOT MET ‚Äî need to define adequate retention period"], correct: 3, explanation: "The control requires retention 'to the extent needed to enable monitoring, analysis, investigation.' 7 days likely isn't enough for investigation. What's their defined retention policy?", mindset: "Retention should match investigation needs. Ask: 'How long until you'd notice an incident? Can you investigate with 7 days of logs?'" },
            { category: "AU - Audit", scenario: "Assessing AU.L2-3.3.2 (User Accountability). All users have unique accounts. However, you discover a shared 'ServiceDesk' account used by 4 help desk staff to reset passwords.", options: ["MET ‚Äî user accounts are unique", "NOT MET ‚Äî shared account prevents individual accountability", "MET if ServiceDesk actions are logged separately", "NOT MET ‚Äî all actions must trace to individuals"], correct: 1, explanation: "The requirement is that actions can be 'uniquely traced to those users.' A shared account used by 4 people means password resets can't be traced to the individual who performed them.", mindset: "Shared accounts = accountability gap. Even for service functions, who specifically did what?" },
            { category: "AU - Audit", scenario: "For AU.L2-3.3.5 (Audit Correlation), contractor has a SIEM that collects logs from all systems. When asked about correlation rules, they say 'We haven't configured any custom rules yet, we just collect everything.'", options: ["MET ‚Äî SIEM provides correlation capability", "NOT MET ‚Äî correlation capability exists but isn't used", "MET if default rules exist", "NOT MET ‚Äî must demonstrate active correlation"], correct: 0, explanation: "The control requires 'correlate audit record review, analysis, and reporting.' Having a SIEM with correlation CAPABILITY that isn't being used for actual correlation is NOT MET.", mindset: "Capability ‚â† implementation. A SIEM that just stores logs isn't correlating anything." },
            { category: "AU - Audit", scenario: "AU.L2-3.3.4 (Audit Failure Alerting) ‚Äî contractor's SIEM sends email alerts when log sources stop reporting. However, the alert goes to a shared mailbox that IT checks 'when they have time.'", options: ["MET ‚Äî alerts are generated", "NOT MET ‚Äî alerts must be actionable and monitored", "MET with observation to improve response", "MET if SLA exists for checking mailbox"], correct: 0, explanation: "The control requires 'alert in the event of an audit logging process failure.' If alerts aren't monitored timely, they don't provide the intended protection. Alerts need response procedures.", mindset: "Alerts that no one acts on aren't really alerts. What's the response process?" },
            { category: "AU - Audit", scenario: "For AU.L2-3.3.8 (Audit Protection), audit logs are stored on the same servers that generate them. Admins who can modify systems can also delete the local logs.", options: ["MET ‚Äî logs exist", "NOT MET ‚Äî logs aren't protected from admin modification", "MET if logs are also sent to SIEM", "NOT MET ‚Äî need write-once storage"], correct: 2, explanation: "If logs are ALSO forwarded to a protected central location (SIEM) where local admins can't modify them, protection exists. Local-only logs modifiable by admins = NOT MET.", mindset: "Who can tamper with evidence? Logs must be protected from those they're logging." },
            { category: "AU - Audit", scenario: "AU.L2-3.3.7 (Time Synchronization) ‚Äî all Windows systems sync to the domain controller. The DC syncs to time.windows.com. Linux systems sync to pool.ntp.org.", options: ["MET ‚Äî all systems use NTP", "NOT MET ‚Äî systems use different time sources", "MET if all sources are accurate", "NOT MET ‚Äî need single authoritative source"], correct: 0, explanation: "The requirement is to 'compare and synchronize internal system clocks.' Different external sources that are both accurate still provide synchronized time for log correlation.", mindset: "The goal is correlated timestamps. Multiple accurate NTP sources achieve this. One internal source is cleaner but not required." },
            { category: "AU - Audit", scenario: "Assessing AU.L2-3.3.9 (Audit Management). The SIEM admin can modify audit configurations. That same person is also a system administrator on CUI systems being audited.", options: ["MET ‚Äî audit management is restricted to privileged users", "NOT MET ‚Äî person auditing shouldn't be person being audited", "MET if they're the only qualified person", "NOT MET ‚Äî conflict of interest in audit management"], correct: 1, explanation: "The control limits audit management to 'a subset of privileged users.' If the sysadmin manages their own audit trail, accountability is compromised. Separation needed.", mindset: "Would you let someone grade their own test? Audit managers shouldn't audit themselves." },
            
            // === IDENTIFICATION AND AUTHENTICATION (IA) SCENARIOS ===
            { category: "IA - Authentication", scenario: "For IA.L2-3.5.3 (MFA), contractor uses Microsoft Authenticator for VPN and O365 access. However, local console logins to CUI servers don't require MFA.", options: ["MET ‚Äî MFA covers remote and cloud access", "NOT MET ‚Äî local privileged access also needs MFA", "MET for network access requirement only", "Partial credit ‚Äî 3 points for remote MFA"], correct: 2, explanation: "IA.L2-3.5.3 requires MFA for 'local and network access to privileged accounts.' Physical console access to CUI servers by admins IS local privileged access. Partial scoring applies.", mindset: "Read the requirement carefully. LOCAL and network access. Console logins count as local." },
            { category: "IA - Authentication", scenario: "Assessing IA.L2-3.5.5 (Identifier Reuse). Contractor's policy states usernames won't be reused for 90 days. AD is configured for 90-day account retention. However, you find an exception where a username was reused after 60 days 'because the new hire had the same name.'", options: ["MET ‚Äî policy and technical control exist", "NOT MET ‚Äî exception violates the control", "MET if exception was documented and approved", "NOT MET ‚Äî no exceptions allowed"], correct: 2, explanation: "If the exception was documented, risk-assessed, and approved by appropriate authority, it may be acceptable. Undocumented exceptions = NOT MET.", mindset: "Exceptions happen. The question is: Was it managed properly or just done ad-hoc?" },
            { category: "IA - Authentication", scenario: "For IA.L2-3.5.6 (Disable Inactive Identifiers), policy requires disabling accounts after 90 days of inactivity. You find 15 accounts that haven't logged in for 120+ days but are still active.", options: ["MET ‚Äî policy exists", "NOT MET ‚Äî policy isn't being enforced", "MET if accounts belong to on-leave employees", "NOT MET unless justified and documented"], correct: 1, explanation: "The control requires identifiers BE disabled after the defined period. 15 active accounts past the threshold means the control isn't implemented effectively.", mindset: "Policy without enforcement isn't implementation. Test actual account status." },
            { category: "IA - Authentication", scenario: "IA.L2-3.5.7 (Password Complexity) ‚Äî contractor requires 12 characters with mixed case, numbers, and symbols. You test and find the system accepts 'Password123!' despite being a common pattern.", options: ["MET ‚Äî technical requirements are enforced", "NOT MET ‚Äî common passwords should be blocked", "MET ‚Äî CMMC doesn't require dictionary checks", "NOT MET ‚Äî complexity without blocklist is insufficient"], correct: 2, explanation: "CMMC requires 'minimum password complexity' with character requirements. Blocking common passwords is a best practice but not explicitly required by the control.", mindset: "Assess against the requirement, not best practice. Complexity ‚â† dictionary blocking (though it should)." },
            { category: "IA - Authentication", scenario: "For IA.L2-3.5.10 (Cryptographically Protected Passwords), contractor shows passwords are hashed in AD using NTLM. They say 'We're planning to upgrade to Kerberos but haven't yet.'", options: ["MET ‚Äî NTLM hashes passwords", "NOT MET ‚Äî NTLM is cryptographically weak", "MET with observation to upgrade", "NOT MET ‚Äî must use approved cryptography"], correct: 0, explanation: "NTLM does hash passwords (it uses MD4). While weak by modern standards, the control requires 'cryptographically protected' storage, which NTLM technically provides.", mindset: "The requirement is protection, not specific algorithm. NTLM is weak but IS cryptographic protection. Note as observation." },
            { category: "IA - Authentication", scenario: "Assessing IA.L2-3.5.4 (Replay-Resistant Authentication). Contractor uses Kerberos for domain authentication. However, a legacy application uses basic authentication over HTTPS for a CUI database.", options: ["MET ‚Äî Kerberos is replay-resistant", "NOT MET ‚Äî basic auth is replayable", "MET if HTTPS prevents replay", "NOT MET ‚Äî all network auth must be replay-resistant"], correct: 2, explanation: "Basic auth over HTTPS: the credentials could be replayed if captured, BUT TLS prevents interception. Combined, this provides replay resistance through transport security.", mindset: "Consider the full stack. Weak auth + strong transport can = adequate protection." },
            { category: "IA - Authentication", scenario: "For IA.L2-3.5.1 (Identification), all users have unique usernames. However, automated backup jobs run under a generic 'BackupService' account shared across 5 backup servers.", options: ["MET ‚Äî users are uniquely identified", "NOT MET ‚Äî processes must also be identified", "MET if BackupService is documented", "NOT MET ‚Äî each server needs unique service account"], correct: 2, explanation: "The control requires identifying 'processes acting on behalf of users.' A documented service account for backups, associated with the admin who authorized it, satisfies this.", mindset: "Service accounts are acceptable if documented and associated with responsible individuals." },
            { category: "IA - Authentication", scenario: "IA.L2-3.5.9 (Temporary Passwords) ‚Äî new users receive temporary passwords via encrypted email and must change at first login. However, password reset tickets include temp passwords in plain text in the ticketing system.", options: ["MET ‚Äî temp passwords work correctly", "NOT MET ‚Äî temp passwords exposed in ticketing system", "MET if ticketing system is access-controlled", "NOT MET ‚Äî temp passwords must be protected everywhere"], correct: 2, explanation: "The control requires 'immediate change to permanent password.' If temp passwords are visible in an access-controlled system (IT staff only), and forced change works, the CONTROL is met.", mindset: "Focus on the control objective: can temp passwords be used indefinitely? No = working as intended." }
        ];

        // ==================== CONTROL DEEP DIVES (110 controls with key takeaways) ====================
        const controlDeepDives = {
            "AC": {
                name: "Access Control",
                color: "#2563eb",
                controls: [
                    { id: "AC.L1-3.1.1", name: "Authorized Access Control", points: 1, keyTakeaways: ["Identify ALL users, processes, and devices allowed to use company systems", "Automated processes must be associated with the user who authorized them", "Maintain a list of authorized personnel supporting ID/authentication activities"], assessmentTips: "Look for: maintained user lists, device authorization records, account request approval workflows" },
                    { id: "AC.L1-3.1.2", name: "Transaction & Function Control", points: 1, keyTakeaways: ["Limit users to ONLY systems, roles, or applications needed for their job", "Common function types: Create, Read, Update, Delete (CRUD)", "Access based on roles AND responsibilities"], assessmentTips: "Verify ACLs match documented roles; test that users can't access unauthorized functions" },
                    { id: "AC.L1-3.1.20", name: "External Connections", points: 1, keyTakeaways: ["External = outside direct supervision (internet, partner networks, personal devices)", "Use firewalls, allow/deny lists, VPNs to control external access", "Cloud services count as external systems"], assessmentTips: "Check for documented external connection inventory, VPN policies, BYOD controls" },
                    { id: "AC.L1-3.1.22", name: "Control Public Information", points: 1, keyTakeaways: ["Never allow FCI/CUI to become public", "Identify WHO is authorized to post to public systems", "Implement review process BEFORE posting public content"], assessmentTips: "Look for: designated posting authorities, pre-publication review process" },
                    { id: "AC.L2-3.1.3", name: "Control CUI Flow", points: 1, keyTakeaways: ["Information FLOW control (where data travels) vs ACCESS control (who can see it)", "Use firewalls, proxies, network segmentation to control flow", "Encryption required for CUI flowing across internet"], assessmentTips: "Review network diagrams, firewall rules, DLP policies, encryption for data in transit" },
                    { id: "AC.L2-3.1.4", name: "Separation of Duties", points: 1, keyTakeaways: ["No single person in charge of entire critical task", "Divide mission functions AND system support functions", "Security admins managing access should NOT also manage audit functions"], assessmentTips: "Document which functions require separation; verify access privileges enforce separation" },
                    { id: "AC.L2-3.1.5", name: "Least Privilege", points: 1, keyTakeaways: ["Restrict user access to ONLY machines and information needed for job", "Limit who can change system configuration settings", "Privileged accounts must be identified and documented"], assessmentTips: "Review privileged account list; verify default accounts are non-privileged" },
                    { id: "AC.L2-3.1.6", name: "Non-Privileged Account Use", points: 1, keyTakeaways: ["Admins must NOT use privileged accounts for everyday tasks", "Web browsing, email = use non-privileged account", "Separating accounts limits blast radius of compromise"], assessmentTips: "Interview admins about account usage habits; check for separate admin and user accounts" },
                    { id: "AC.L2-3.1.7", name: "Privileged Functions", points: 1, keyTakeaways: ["Privileged functions = control, monitoring, administration of system security", "Non-privileged users must be PREVENTED from executing these", "ALL privileged function execution must be LOGGED"], assessmentTips: "Test that non-privileged users can't access admin functions; verify logging" },
                    { id: "AC.L2-3.1.8", name: "Unsuccessful Logon Attempts", points: 1, keyTakeaways: ["Define maximum number of failed attempts before lockout", "Define lockout duration or unlock procedure", "Protects against brute force attacks"], assessmentTips: "Check lockout threshold settings; verify lockout triggers; review unlock procedures" },
                    { id: "AC.L2-3.1.9", name: "Privacy & Security Notices", points: 1, keyTakeaways: ["Display notice/banner BEFORE granting access", "Notice must reference monitoring, recording, and auditing", "User must acknowledge notice before proceeding"], assessmentTips: "Verify login banners exist on all systems; confirm acknowledgment required" },
                    { id: "AC.L2-3.1.10", name: "Session Lock", points: 1, keyTakeaways: ["Lock screen after organizationally-defined inactivity period", "Pattern-hiding = can't see data on locked screen", "User must re-authenticate to unlock"], assessmentTips: "Test inactivity timeout; verify screen lock engages; confirm re-auth required" },
                    { id: "AC.L2-3.1.11", name: "Session Termination", points: 1, keyTakeaways: ["Different from session LOCK - this ENDS the session entirely", "Conditions: time of day, inactivity duration, concurrent session limits", "Forces re-authentication for new session"], assessmentTips: "Identify termination conditions; test sessions terminate; verify new auth required" },
                    { id: "AC.L2-3.1.12", name: "Control Remote Access", points: 1, keyTakeaways: ["Remote access = access from outside controlled facility", "Automated monitoring required (not just manual review)", "Control methods: session limits, time restrictions, encryption"], assessmentTips: "Review remote access logs; verify monitoring is automated; check session controls" },
                    { id: "AC.L2-3.1.13", name: "Remote Access Confidentiality", points: 1, keyTakeaways: ["ALL remote access must be encrypted", "VPN, TLS, SSH are common mechanisms", "Applies to both incoming and outgoing remote connections"], assessmentTips: "Verify encryption on VPN, RDP, SSH; check TLS versions (1.2+)" },
                    { id: "AC.L2-3.1.14", name: "Remote Access Routing", points: 1, keyTakeaways: ["All remote access through controlled entry points (jump servers, VPN concentrators)", "No direct connections bypassing access control points", "Enables monitoring and enforcement at single point"], assessmentTips: "Review network architecture; verify no backdoor remote access paths" },
                    { id: "AC.L2-3.1.15", name: "Privileged Remote Access", points: 1, keyTakeaways: ["Privileged remote commands need EXPLICIT authorization", "Document which commands are allowed remotely", "More restrictive than standard remote access"], assessmentTips: "Review privileged remote access authorization; verify logging" },
                    { id: "AC.L2-3.1.16", name: "Wireless Access Authorization", points: 1, keyTakeaways: ["Wireless access requires authorization BEFORE connection", "Establish usage restrictions and implementation guidance", "Applies to both corporate WiFi and personal hotspots"], assessmentTips: "Review wireless authorization process; verify unauthorized devices can't connect" },
                    { id: "AC.L2-3.1.17", name: "Wireless Access Protection", points: 1, keyTakeaways: ["WPA2/WPA3 Enterprise with EAP-TLS recommended", "Pre-shared keys (PSK) less secure than enterprise auth", "Rogue access point detection recommended"], assessmentTips: "Verify WPA2/3 in use; check authentication method; test for rogue AP detection" },
                    { id: "AC.L2-3.1.18", name: "Mobile Device Connection", points: 1, keyTakeaways: ["Mobile = laptops, tablets, phones that connect to multiple networks", "May require MDM (Mobile Device Management) solution", "Define what's allowed: company-owned only vs BYOD"], assessmentTips: "Review mobile device policy; verify MDM enforcement; check connection controls" },
                    { id: "AC.L2-3.1.19", name: "Encrypt CUI on Mobile", points: 1, keyTakeaways: ["Full disk encryption required for mobile devices with CUI", "FIPS-validated encryption recommended for CUI", "Complemented by SC.L2-3.13.10 (key management)"], assessmentTips: "Verify encryption enabled on all mobile devices; check FIPS validation" },
                    { id: "AC.L2-3.1.21", name: "Portable Storage Use", points: 1, keyTakeaways: ["Portable storage = USB drives, external hard drives", "External systems = systems not controlled by organization", "Risk: malware introduction, data exfiltration"], assessmentTips: "Review portable storage policy; verify technical controls (USB blocking); check DLP" }
                ]
            },
            "AT": {
                name: "Awareness and Training",
                color: "#059669",
                controls: [
                    { id: "AT.L2-3.2.1", name: "Role-Based Risk Awareness", points: 1, keyTakeaways: ["AWARENESS training (general security) - different from role-based TRAINING", "Must cover: risks of activities, applicable policies/standards/procedures", "Initial AND refresher training required"], assessmentTips: "Review training materials and completion records; check refresher schedule" },
                    { id: "AT.L2-3.2.2", name: "Role-Based Training", points: 1, keyTakeaways: ["Role-based TRAINING = skills/knowledge for specific job function", "Different from awareness training - this is job-specific", "Examples: firewall admin training, incident responder training"], assessmentTips: "Identify security-related roles; verify training exists for each role" },
                    { id: "AT.L2-3.2.3", name: "Insider Threat Awareness", points: 1, keyTakeaways: ["Insider threat = authorized access used to do harm (intentional or not)", "Indicators: unusual access patterns, policy violations, behavior changes", "Training must cover how to REPORT potential threats"], assessmentTips: "Review insider threat training content; verify reporting mechanisms covered" }
                ]
            },
            "AU": {
                name: "Audit and Accountability",
                color: "#7c3aed",
                controls: [
                    { id: "AU.L2-3.3.1", name: "System Auditing", points: 5, keyTakeaways: ["5-POINT CONTROL - critical for CUI protection", "Define WHAT to log: event types, content needed", "Minimum content: timestamps, source/dest, user/process IDs, success/fail"], assessmentTips: "Verify logging enabled on ALL CUI systems; check retention period" },
                    { id: "AU.L2-3.3.2", name: "User Accountability", points: 1, keyTakeaways: ["Logs must link actions to INDIVIDUAL users", "No shared accounts for accountability-sensitive functions", "Enables investigation and attribution"], assessmentTips: "Verify logs contain user IDs; check for shared account usage" },
                    { id: "AU.L2-3.3.3", name: "Event Review", points: 1, keyTakeaways: ["Logs must be REVIEWED (not just collected)", "Update what's logged based on review findings", "Anomalies and suspicious events must be investigated"], assessmentTips: "Review log review procedures; check for documented review activities" },
                    { id: "AU.L2-3.3.4", name: "Audit Failure Alerting", points: 1, keyTakeaways: ["If logging fails, you must know immediately", "Alert appropriate personnel (not just log it)", "May include: disk full, service stopped, log corruption"], assessmentTips: "Test alerting for log failures; verify alerts go to appropriate personnel" },
                    { id: "AU.L2-3.3.5", name: "Audit Correlation", points: 1, keyTakeaways: ["Correlate logs from MULTIPLE sources for better visibility", "SIEM tools commonly used for correlation", "Enables detection of distributed attacks"], assessmentTips: "Check for log aggregation/SIEM; verify correlation rules exist" },
                    { id: "AU.L2-3.3.6", name: "Reduction & Reporting", points: 1, keyTakeaways: ["Raw logs often too voluminous for direct analysis", "Reduction = filtering, summarizing, normalizing data", "Support on-demand queries and reports"], assessmentTips: "Verify ability to search/filter logs; check reporting capabilities" },
                    { id: "AU.L2-3.3.7", name: "Authoritative Time Source", points: 1, keyTakeaways: ["All systems must sync to authoritative time source (NTP)", "Consistent timestamps critical for log correlation", "Check for time drift regularly"], assessmentTips: "Verify NTP configuration; check time source is authoritative" },
                    { id: "AU.L2-3.3.8", name: "Audit Protection", points: 1, keyTakeaways: ["Attackers often try to modify/delete logs to cover tracks", "Restrict access to logs and logging tools", "Consider write-once storage or off-site backup"], assessmentTips: "Check log file permissions; verify access restrictions" },
                    { id: "AU.L2-3.3.9", name: "Audit Management", points: 1, keyTakeaways: ["Only specific privileged users can manage logging", "Supports separation of duties", "Prevents users from disabling their own audit trail"], assessmentTips: "Identify who can manage logging; verify it's a limited subset" }
                ]
            },
            "CM": {
                name: "Configuration Management",
                color: "#dc2626",
                controls: [
                    { id: "CM.L2-3.4.1", name: "System Baselining", points: 1, keyTakeaways: ["Baseline = known good configuration state", "Must include: hardware, software, firmware, documentation", "Enables detection of unauthorized changes"], assessmentTips: "Review baseline documentation; verify inventory is current" },
                    { id: "CM.L2-3.4.2", name: "Security Configuration Enforcement", points: 1, keyTakeaways: ["Security settings must be documented AND enforced", "Use industry benchmarks (CIS, DISA STIGs) as starting point", "Enforce through technical controls, not just policy"], assessmentTips: "Review security configuration standards; verify enforcement mechanisms" },
                    { id: "CM.L2-3.4.3", name: "System Change Management", points: 1, keyTakeaways: ["All changes must go through formal process", "Track: who, what, when, why", "Review and approve BEFORE implementation"], assessmentTips: "Review change management process; check change logs" },
                    { id: "CM.L2-3.4.4", name: "Security Impact Analysis", points: 1, keyTakeaways: ["Analyze security impact BEFORE making changes", "Consider effects on confidentiality, integrity, availability", "Part of change management process"], assessmentTips: "Review security impact analysis procedures; check for documented analyses" },
                    { id: "CM.L2-3.4.5", name: "Access Restrictions for Change", points: 1, keyTakeaways: ["Limit who can make changes to systems", "Both physical AND logical access restrictions", "Enforce through technical controls"], assessmentTips: "Identify who has change access; verify restrictions are enforced" },
                    { id: "CM.L2-3.4.6", name: "Least Functionality", points: 1, keyTakeaways: ["Disable/remove unnecessary functions, ports, protocols, services", "Reduces attack surface", "Document what's essential vs what's disabled"], assessmentTips: "Review enabled services/ports; verify unnecessary functions disabled" },
                    { id: "CM.L2-3.4.7", name: "Nonessential Programs", points: 1, keyTakeaways: ["Identify essential vs nonessential software/services", "Multiple options: restrict, disable, or prevent", "Technical controls preferred over policy alone"], assessmentTips: "Review installed software; check for nonessential services" },
                    { id: "CM.L2-3.4.8", name: "Application Execution Policy", points: 1, keyTakeaways: ["Whitelisting (deny-all, permit-by-exception) is more secure", "Blacklisting blocks known bad, allows unknown", "Technical enforcement required"], assessmentTips: "Identify which approach is used; test that unauthorized software blocked" },
                    { id: "CM.L2-3.4.9", name: "User-Installed Software", points: 1, keyTakeaways: ["Users shouldn't install software without authorization", "Monitor for unauthorized installations", "Balance usability with security"], assessmentTips: "Review user software installation policy; verify monitoring in place" }
                ]
            },
            "IA": {
                name: "Identification and Authentication",
                color: "#0891b2",
                controls: [
                    { id: "IA.L1-3.5.1", name: "Identification", points: 1, keyTakeaways: ["Every user, process, and device must have unique identifier", "Foundation for authentication and access control", "Device identification supports network access control"], assessmentTips: "Verify unique identifiers for users; check process authorization" },
                    { id: "IA.L1-3.5.2", name: "Authentication", points: 1, keyTakeaways: ["Authentication verifies claimed identity", "Must occur BEFORE access is granted", "Strength should match sensitivity of access"], assessmentTips: "Verify authentication required before access; check auth strength" },
                    { id: "IA.L2-3.5.3", name: "Multifactor Authentication", points: "3 or 5", keyTakeaways: ["‚òÖ PARTIAL SCORING CONTROL ‚òÖ", "MFA required for: privileged accounts (local & network) AND non-privileged network access", "3 points if MFA only for remote/privileged; 5 points if no MFA"], assessmentTips: "Test MFA on all required access paths; verify factors are independent" },
                    { id: "IA.L2-3.5.4", name: "Replay-Resistant Authentication", points: 1, keyTakeaways: ["Prevent captured authentication from being reused", "Kerberos, TLS, OTP are replay-resistant", "Simple password over unencrypted connection is NOT"], assessmentTips: "Verify authentication protocols are replay-resistant" },
                    { id: "IA.L2-3.5.5", name: "Identifier Reuse", points: 1, keyTakeaways: ["Don't reassign user IDs to new users immediately", "Define period before reuse is allowed", "Prevents confusion in audit trails"], assessmentTips: "Check identifier reuse policy; verify enforcement" },
                    { id: "IA.L2-3.5.6", name: "Identifier Handling", points: 1, keyTakeaways: ["Inactive accounts are security risk", "Define inactivity period (e.g., 45-90 days)", "Disable (not delete) to preserve audit trail"], assessmentTips: "Review inactivity policy; verify automated detection" },
                    { id: "IA.L2-3.5.7", name: "Password Complexity", points: 1, keyTakeaways: ["Define minimum length and character types", "Require change of characters on password update", "Technical enforcement (not just policy)"], assessmentTips: "Test password complexity enforcement; verify requirements documented" },
                    { id: "IA.L2-3.5.8", name: "Password Reuse", points: 1, keyTakeaways: ["Define number of password generations before reuse", "Technical enforcement in directory/authentication system", "Prevents cycling through passwords"], assessmentTips: "Test password history enforcement; verify generation count" },
                    { id: "IA.L2-3.5.9", name: "Temporary Passwords", points: 1, keyTakeaways: ["Temporary passwords only valid for first login", "Force immediate change to permanent password", "Avoid predictable temporary password patterns"], assessmentTips: "Test temporary password process; verify forced change" },
                    { id: "IA.L2-3.5.10", name: "Cryptographically-Protected Passwords", points: 1, keyTakeaways: ["Passwords must be hashed for storage (one-way function)", "Passwords must be encrypted in transit", "Use salting to prevent rainbow table attacks"], assessmentTips: "Verify password storage is hashed; check transmission encrypted" },
                    { id: "IA.L2-3.5.11", name: "Obscure Feedback", points: 1, keyTakeaways: ["Display asterisks or dots when entering passwords", "Prevents shoulder surfing", "Mobile devices may briefly show characters (acceptable)"], assessmentTips: "Test password entry feedback; verify obscuring on all systems" }
                ]
            },
            "IR": {
                name: "Incident Response",
                color: "#ea580c",
                controls: [
                    { id: "IR.L2-3.6.1", name: "Incident Handling", points: 5, keyTakeaways: ["5-POINT CONTROL", "Must cover ALL phases: preparation, detection, analysis, containment, recovery, user response", "Establishes CAPABILITY - doesn't require actual incidents"], assessmentTips: "Review IR plan for all phases; verify roles are assigned" },
                    { id: "IR.L2-3.6.2", name: "Incident Reporting", points: 5, keyTakeaways: ["5-POINT CONTROL", "CUI incidents must be reported to DIBNet within 72 hours", "Document ALL incidents (not just major ones)"], assessmentTips: "Review reporting procedures; verify DIBNet 72-hour requirement" },
                    { id: "IR.L2-3.6.3", name: "Incident Response Testing", points: 5, keyTakeaways: ["5-POINT CONTROL", "Testing validates capability actually works", "Methods: tabletop exercises, simulations, actual exercises"], assessmentTips: "Review testing records; verify testing frequency" }
                ]
            },
            "MA": {
                name: "Maintenance",
                color: "#4f46e5",
                controls: [
                    { id: "MA.L2-3.7.1", name: "Perform Maintenance", points: 1, keyTakeaways: ["Maintenance keeps systems secure and operational", "Includes patches, updates, hardware servicing", "Schedule based on vendor recommendations and risk"], assessmentTips: "Review maintenance schedules; verify maintenance is performed" },
                    { id: "MA.L2-3.7.2", name: "System Maintenance Control", points: 5, keyTakeaways: ["5-POINT CONTROL", "Control WHO performs maintenance", "Control WHAT tools are used", "Inspect tools before and after use"], assessmentTips: "Review maintenance personnel authorization; verify tool controls" },
                    { id: "MA.L2-3.7.3", name: "Equipment Sanitization", points: 1, keyTakeaways: ["Remove ALL CUI before equipment leaves facility", "Sanitize storage media, memory, configuration data", "Verify sanitization before release"], assessmentTips: "Review sanitization procedures; verify process before removal" },
                    { id: "MA.L2-3.7.4", name: "Media Inspection", points: 1, keyTakeaways: ["Scan maintenance media BEFORE use", "Applies to diagnostic tools, firmware updates", "Prevents introduction of malware via maintenance"], assessmentTips: "Verify scanning procedures for maintenance media" },
                    { id: "MA.L2-3.7.5", name: "Nonlocal Maintenance", points: 5, keyTakeaways: ["5-POINT CONTROL", "Remote maintenance requires MFA", "Sessions must be terminated when complete"], assessmentTips: "Verify MFA for remote maintenance; check session termination" },
                    { id: "MA.L2-3.7.6", name: "Maintenance Personnel", points: 1, keyTakeaways: ["Uncleared personnel must be supervised during maintenance", "Escort and observe at all times", "Review and approve work performed"], assessmentTips: "Review supervision procedures; verify escort requirements" }
                ]
            },
            "MP": {
                name: "Media Protection",
                color: "#be185d",
                controls: [
                    { id: "MP.L2-3.8.1", name: "Media Protection", points: 1, keyTakeaways: ["Applies to BOTH paper and digital media", "Physical control = know where media is", "Secure storage = locked cabinets, safes, secure areas"], assessmentTips: "Review media storage locations; verify access controls" },
                    { id: "MP.L2-3.8.2", name: "Media Access", points: 1, keyTakeaways: ["Only authorized users can access CUI media", "Both physical and logical access controls", "Review access periodically"], assessmentTips: "Review access authorization; verify access controls enforced" },
                    { id: "MP.L2-3.8.3", name: "Media Disposal", points: 5, keyTakeaways: ["5-POINT CONTROL", "Sanitization methods depend on media type", "Destruction may be required for highest sensitivity"], assessmentTips: "Review sanitization/destruction procedures; verify methods appropriate" },
                    { id: "MP.L2-3.8.4", name: "Media Markings", points: 1, keyTakeaways: ["CUI markings per NARA guidelines", "Distribution limitations must be visible", "Enables proper handling"], assessmentTips: "Review marking procedures; verify markings applied" },
                    { id: "MP.L2-3.8.5", name: "Media Accountability", points: 1, keyTakeaways: ["Track media during transport", "Know who has custody at all times", "Document chain of custody"], assessmentTips: "Review transport procedures; verify chain of custody" },
                    { id: "MP.L2-3.8.6", name: "Portable Storage Encryption", points: 1, keyTakeaways: ["Encrypt CUI on portable digital media", "FIPS-validated encryption recommended", "Alternative: physical safeguards (courier, locked container)"], assessmentTips: "Verify encryption on portable media; check encryption strength" },
                    { id: "MP.L2-3.8.7", name: "Removable Media", points: 5, keyTakeaways: ["5-POINT CONTROL", "USB drives, external drives, optical media", "May restrict, disable, or prohibit"], assessmentTips: "Review removable media policy; verify technical controls" },
                    { id: "MP.L2-3.8.8", name: "Shared Media", points: 1, keyTakeaways: ["No anonymous/shared USB drives", "All portable storage must have identifiable owner", "Supports accountability"], assessmentTips: "Review portable storage ownership requirements" },
                    { id: "MP.L2-3.8.9", name: "Protect Backups", points: 1, keyTakeaways: ["Backups contain CUI - must be protected", "Encryption for offsite backups", "Physical security for onsite backups"], assessmentTips: "Review backup protection; verify encryption" }
                ]
            },
            "PS": {
                name: "Personnel Security",
                color: "#0d9488",
                controls: [
                    { id: "PS.L2-3.9.1", name: "Screen Individuals", points: 1, keyTakeaways: ["Screen BEFORE granting CUI access", "Background checks, reference checks", "Level of screening based on sensitivity"], assessmentTips: "Review screening procedures; verify screening before access" },
                    { id: "PS.L2-3.9.2", name: "Personnel Actions", points: 5, keyTakeaways: ["5-POINT CONTROL", "Termination: revoke access immediately", "Transfer: adjust access for new role", "Return all equipment and media"], assessmentTips: "Review termination/transfer procedures; verify timely access revocation" }
                ]
            },
            "PE": {
                name: "Physical Protection",
                color: "#9333ea",
                controls: [
                    { id: "PE.L2-3.10.1", name: "Limit Physical Access", points: 5, keyTakeaways: ["5-POINT CONTROL - cannot be POA&M'd", "Control access to facilities with CUI systems", "Badges, locks, guards, fences"], assessmentTips: "Review physical access controls; verify authorization process" },
                    { id: "PE.L2-3.10.2", name: "Monitor Facility", points: 5, keyTakeaways: ["5-POINT CONTROL - cannot be POA&M'd", "Monitoring = cameras, intrusion detection, guards", "Cover both facility and infrastructure"], assessmentTips: "Review monitoring systems; verify coverage" },
                    { id: "PE.L2-3.10.3", name: "Escort Visitors", points: 1, keyTakeaways: ["Visitors must be escorted in secure areas", "Monitor visitor activity at all times", "Log visitor access"], assessmentTips: "Review visitor procedures; verify escort requirements" },
                    { id: "PE.L2-3.10.4", name: "Physical Access Logs", points: 1, keyTakeaways: ["Cannot be POA&M'd at Level 2", "Log entry/exit to secure areas", "Include visitor access"], assessmentTips: "Review physical access logs; verify retention" },
                    { id: "PE.L2-3.10.5", name: "Manage Physical Access", points: 1, keyTakeaways: ["Cannot be POA&M'd at Level 2", "Physical access devices = keys, badges, cards", "Revoke lost/stolen devices immediately"], assessmentTips: "Review device inventory; verify tracking" },
                    { id: "PE.L2-3.10.6", name: "Alternative Work Sites", points: 1, keyTakeaways: ["Remote work/home offices need protection", "Define safeguarding requirements", "May include physical security, encryption, VPN"], assessmentTips: "Review telework policy; verify safeguards" }
                ]
            },
            "RA": {
                name: "Risk Assessment",
                color: "#ca8a04",
                controls: [
                    { id: "RA.L2-3.11.1", name: "Risk Assessments", points: 1, keyTakeaways: ["Assess risk periodically (at least annually)", "Cover: operations, assets, individuals", "Consider CUI processing, storage, transmission"], assessmentTips: "Review risk assessment; verify currency" },
                    { id: "RA.L2-3.11.2", name: "Vulnerability Scan", points: 5, keyTakeaways: ["5-POINT CONTROL", "Scan periodically (define frequency)", "Also scan when new vulnerabilities announced"], assessmentTips: "Review scanning frequency; verify coverage" },
                    { id: "RA.L2-3.11.3", name: "Vulnerability Remediation", points: 1, keyTakeaways: ["Prioritize remediation based on risk", "Define remediation timeframes", "Track remediation progress"], assessmentTips: "Review remediation process; verify prioritization" }
                ]
            },
            "CA": {
                name: "Security Assessment",
                color: "#2563eb",
                controls: [
                    { id: "CA.L2-3.12.1", name: "Security Control Assessment", points: 5, keyTakeaways: ["5-POINT CONTROL", "Assess periodically (not just once)", "Determine if controls are EFFECTIVE"], assessmentTips: "Review security assessment schedule; verify assessments performed" },
                    { id: "CA.L2-3.12.2", name: "Plan of Action", points: 1, keyTakeaways: ["POA&M for identified deficiencies", "Must be actionable with timelines", "Different from CMMC assessment POA&M"], assessmentTips: "Review POA&M; verify items have timelines" },
                    { id: "CA.L2-3.12.3", name: "Security Control Monitoring", points: 5, keyTakeaways: ["5-POINT CONTROL", "Continuous monitoring (not just periodic assessment)", "Detect changes that affect control effectiveness"], assessmentTips: "Review monitoring procedures; verify ongoing activities" },
                    { id: "CA.L2-3.12.4", name: "System Security Plan", points: 1, keyTakeaways: ["‚òÖ REQUIRED AT ASSESSMENT - CANNOT BE POA&M'd ‚òÖ", "Must include: boundary, environment, implementation methods, connections", "Foundation document for CMMC assessment"], assessmentTips: "Verify SSP exists; check accuracy against actual environment" }
                ]
            },
            "SC": {
                name: "System and Communications Protection",
                color: "#dc2626",
                controls: [
                    { id: "SC.L1-3.13.1", name: "Boundary Protection", points: 5, keyTakeaways: ["5-POINT CONTROL", "External boundaries = perimeter (internet-facing)", "Internal boundaries = network segmentation"], assessmentTips: "Review network architecture; verify boundary controls" },
                    { id: "SC.L2-3.13.2", name: "Security Engineering", points: 5, keyTakeaways: ["5-POINT CONTROL", "Security built into design (not bolted on)", "Defense in depth architecture"], assessmentTips: "Review architecture documentation; verify security design principles" },
                    { id: "SC.L2-3.13.3", name: "Security Function Isolation", points: 1, keyTakeaways: ["Users can't access admin functions", "Physical or logical separation", "Reduces attack surface"], assessmentTips: "Verify separation of user and admin functions" },
                    { id: "SC.L2-3.13.4", name: "Shared Resource Control", points: 1, keyTakeaways: ["Shared resources = memory, storage in multi-tenant", "Prevent data leakage between users/processes", "Apply to virtualization environments"], assessmentTips: "Review shared resource controls; verify isolation" },
                    { id: "SC.L1-3.13.5", name: "Public-Access System Separation", points: 1, keyTakeaways: ["DMZ for public-facing systems", "Physically or logically separated", "May be N/A if no public systems"], assessmentTips: "Review network segmentation; verify DMZ implementation" },
                    { id: "SC.L2-3.13.6", name: "Network Communication by Exception", points: 5, keyTakeaways: ["5-POINT CONTROL", "Default deny = whitelist approach", "Only explicitly allowed traffic permitted"], assessmentTips: "Review firewall rules; verify default deny" },
                    { id: "SC.L2-3.13.7", name: "Split Tunneling", points: 1, keyTakeaways: ["Split tunneling = VPN user accessing corporate and internet directly", "Creates bypass around corporate security", "Disable or control split tunneling"], assessmentTips: "Review VPN configuration; verify split tunneling controls" },
                    { id: "SC.L2-3.13.8", name: "Data in Transit", points: 1, keyTakeaways: ["Encrypt CUI in transit", "TLS 1.2+ for web traffic", "Alternative: protected distribution system (PDS)"], assessmentTips: "Verify encryption for CUI transmission; check TLS versions" },
                    { id: "SC.L2-3.13.9", name: "Connections Termination", points: 1, keyTakeaways: ["Define inactivity timeout", "Terminate sessions when complete", "Prevents hijacking of idle sessions"], assessmentTips: "Verify timeout configuration; test session termination" },
                    { id: "SC.L2-3.13.10", name: "Key Management", points: 1, keyTakeaways: ["Key generation must be secure", "Key storage must be protected", "Include key rotation and revocation"], assessmentTips: "Review key management procedures; verify key protection" },
                    { id: "SC.L2-3.13.11", name: "CUI Encryption", points: "3 or 5", keyTakeaways: ["‚òÖ PARTIAL SCORING CONTROL ‚òÖ", "3 points if encryption exists but not FIPS-validated", "FIPS 140-2/3 VALIDATED module required (not just algorithm)"], assessmentTips: "Check CMVP database for validation; verify FIPS mode enabled" },
                    { id: "SC.L2-3.13.12", name: "Collaborative Device Control", points: 1, keyTakeaways: ["Collaborative devices = cameras, mics in meeting rooms", "Prevent remote activation without user knowledge", "Users must know if being recorded"], assessmentTips: "Review collaborative device controls; verify indicators" },
                    { id: "SC.L2-3.13.13", name: "Mobile Code", points: 1, keyTakeaways: ["Mobile code = JavaScript, ActiveX, Flash", "Control what mobile code can execute", "May block or restrict by type"], assessmentTips: "Review mobile code controls; check browser settings" },
                    { id: "SC.L2-3.13.14", name: "Voice over IP", points: 1, keyTakeaways: ["VoIP has unique security considerations", "Separate VoIP and data traffic", "Encrypt VoIP when carrying CUI"], assessmentTips: "Review VoIP implementation; verify segmentation" },
                    { id: "SC.L2-3.13.15", name: "Communications Authenticity", points: 5, keyTakeaways: ["5-POINT CONTROL", "Verify both endpoints are who they claim", "TLS with certificates provides authenticity"], assessmentTips: "Verify session authentication; check certificate validation" },
                    { id: "SC.L2-3.13.16", name: "Data at Rest", points: 1, keyTakeaways: ["CUI must be protected when stored", "Encryption is primary method", "Applies to all storage locations"], assessmentTips: "Verify CUI storage protection; check encryption" }
                ]
            },
            "SI": {
                name: "System and Information Integrity",
                color: "#65a30d",
                controls: [
                    { id: "SI.L1-3.14.1", name: "Flaw Remediation", points: 5, keyTakeaways: ["5-POINT CONTROL", "Timely patching is critical", "Define what 'timely' means for different severity"], assessmentTips: "Review patching procedures; verify patch currency" },
                    { id: "SI.L1-3.14.2", name: "Malicious Code Protection", points: 5, keyTakeaways: ["5-POINT CONTROL", "Antivirus/antimalware at endpoints and gateways", "'Appropriate locations' = entry/exit points, workstations, servers"], assessmentTips: "Verify AV/AM deployment; check coverage" },
                    { id: "SI.L2-3.14.3", name: "Security Alerts", points: 5, keyTakeaways: ["5-POINT CONTROL", "Subscribe to security advisory sources", "Take appropriate action (patch, mitigate, accept)"], assessmentTips: "Review advisory monitoring; verify action process" },
                    { id: "SI.L1-3.14.4", name: "Update Malicious Code Protection", points: 5, keyTakeaways: ["5-POINT CONTROL", "Signature updates must be current", "Automate updates where possible"], assessmentTips: "Verify signature currency; check update automation" },
                    { id: "SI.L1-3.14.5", name: "System & File Scanning", points: 1, keyTakeaways: ["Periodic full system scans", "Real-time scanning for files from external sources", "Scan downloads, email attachments, external media"], assessmentTips: "Verify scan schedules; check real-time scanning" },
                    { id: "SI.L2-3.14.6", name: "Monitor Communications", points: 5, keyTakeaways: ["5-POINT CONTROL", "Monitor both inbound AND outbound", "IDS/IPS, SIEM, network monitoring tools"], assessmentTips: "Review monitoring capabilities; verify inbound/outbound coverage" },
                    { id: "SI.L2-3.14.7", name: "Identify Unauthorized Use", points: 1, keyTakeaways: ["Detect when systems used without authorization", "Monitor for policy violations", "User behavior analytics can help"], assessmentTips: "Review detection mechanisms; verify log analysis" }
                ]
            }
        };

        // ==================== STATE ====================
        let currentMode = 'study';
        let studiedControls = JSON.parse(localStorage.getItem('studiedControls') || '[]');
        let searchTerm = '';
        let studyFilter = 'all';
        let typeFilter = 'all';
        let selectedQuizType = 'multiple-choice';
        let questionCount = 20;
        let quizFocus = 'all';
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let incorrectAnswers = 0;
        let answered = false;
        let ccaMode = '';
        let ccaQuestions = [];
        let ccaIndex = 0;
        let ccaCorrect = 0;
        let ccaIncorrect = 0;

        // ==================== MODE SWITCHING ====================
        function setMode(mode) {
            currentMode = mode;
            
            // Update buttons
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            const modeBtn = document.getElementById('mode' + mode.charAt(0).toUpperCase() + mode.slice(1));
            if (modeBtn) modeBtn.classList.add('active');
            
            // Hide all containers
            document.getElementById('studyContainer').classList.add('hidden');
            document.getElementById('quizContainer').classList.remove('active');
            document.getElementById('ethicsContainer').classList.remove('active');
            document.getElementById('gotchaContainer').classList.remove('active');
            document.getElementById('judgmentContainer').classList.remove('active');
            document.getElementById('capContainer').classList.remove('active');
            document.getElementById('scopingContainer').classList.remove('active');
            document.getElementById('terminologyContainer').classList.remove('active');
            document.getElementById('bestanswerContainer').classList.remove('active');
            document.getElementById('tipsContainer').classList.remove('active');
            document.getElementById('deepdiveContainer').classList.remove('active');
            
            // Hide all sidebars
            document.getElementById('studySidebar').style.display = 'none';
            document.getElementById('quizSidebar').style.display = 'none';
            document.getElementById('ccaSidebar').style.display = 'none';
            
            // Show appropriate content
            if (mode === 'study') {
                document.getElementById('studyContainer').classList.remove('hidden');
                document.getElementById('studySidebar').style.display = 'block';
            } else if (mode === 'quiz') {
                document.getElementById('quizContainer').classList.add('active');
                showQuizSettings();
            } else if (mode === 'ethics') {
                document.getElementById('ethicsContainer').classList.add('active');
                document.getElementById('ccaSidebar').style.display = 'block';
                startCCAMode('ethics', ETHICS_QUESTIONS);
            } else if (mode === 'gotcha') {
                document.getElementById('gotchaContainer').classList.add('active');
                document.getElementById('ccaSidebar').style.display = 'block';
                startCCAMode('gotcha', GOTCHA_QUESTIONS);
            } else if (mode === 'judgment') {
                document.getElementById('judgmentContainer').classList.add('active');
                document.getElementById('ccaSidebar').style.display = 'block';
                startCCAMode('judgment', JUDGMENT_SCENARIOS);
            } else if (mode === 'cap') {
                document.getElementById('capContainer').classList.add('active');
                document.getElementById('ccaSidebar').style.display = 'block';
                startCCAMode('cap', CAP_QUESTIONS);
            } else if (mode === 'scoping') {
                document.getElementById('scopingContainer').classList.add('active');
                document.getElementById('ccaSidebar').style.display = 'block';
                startCCAMode('scoping', SCOPING_QUESTIONS);
            } else if (mode === 'terminology') {
                document.getElementById('terminologyContainer').classList.add('active');
                document.getElementById('ccaSidebar').style.display = 'block';
                startCCAMode('terminology', TERMINOLOGY_QUESTIONS);
            } else if (mode === 'bestanswer') {
                document.getElementById('bestanswerContainer').classList.add('active');
                document.getElementById('ccaSidebar').style.display = 'block';
                startCCAMode('bestanswer', BEST_ANSWER_QUESTIONS);
            } else if (mode === 'tips') {
                document.getElementById('tipsContainer').classList.add('active');
                renderTips();
            } else if (mode === 'deepdive') {
                document.getElementById('deepdiveContainer').classList.add('active');
                document.getElementById('studySidebar').style.display = 'block';
                renderDeepDive();
            }
        }

        // ==================== STUDY MODE ====================
        function renderDomains() {
            const container = document.getElementById('domainsContainer');
            let html = '';
            
            for (const [domainName, domain] of Object.entries(DOMAINS)) {
                const studiedInDomain = domain.controls.filter(c => studiedControls.includes(domain.id + '-' + c.id)).length;
                const filteredControls = domain.controls.filter(c => {
                    const isStudied = studiedControls.includes(domain.id + '-' + c.id);
                    const matchesSearch = !searchTerm || 
                        c.id.toLowerCase().includes(searchTerm) ||
                        c.name.toLowerCase().includes(searchTerm) ||
                        c.req.toLowerCase().includes(searchTerm) ||
                        c.meaning.toLowerCase().includes(searchTerm);
                    const matchesStudyFilter = studyFilter === 'all' || 
                        (studyFilter === 'studied' && isStudied) ||
                        (studyFilter === 'unstudied' && !isStudied);
                    const matchesTypeFilter = typeFilter === 'all' || c.type === typeFilter;
                    return matchesSearch && matchesStudyFilter && matchesTypeFilter;
                });
                
                if (filteredControls.length === 0 && (searchTerm || studyFilter !== 'all' || typeFilter !== 'all')) continue;
                
                html += `
                    <div class="domain domain-${domain.id}">
                        <div class="domain-header" onclick="toggleDomain('${domain.id}')">
                            <span class="domain-title">${domainName}</span>
                            <div class="domain-meta">
                                <span class="domain-progress">${studiedInDomain}/${domain.count} studied</span>
                                <span class="domain-count">${domain.count} controls</span>
                                <span class="domain-chevron">‚ñº</span>
                            </div>
                        </div>
                        <div class="domain-content">
                            <table class="controls-table">
                                <thead>
                                    <tr>
                                        <th style="width: 40px;">‚úì</th>
                                        <th style="width: 120px;">Control</th>
                                        <th>Requirement</th>
                                        <th style="width: 280px;">What It Means</th>
                                        <th style="width: 100px;">Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${domain.controls.map(c => {
                                        const controlKey = domain.id + '-' + c.id;
                                        const isStudied = studiedControls.includes(controlKey);
                                        const hidden = !filteredControls.includes(c);
                                        return `
                                            <tr class="${isStudied ? 'studied' : ''} ${hidden ? 'hidden' : ''}">
                                                <td><input type="checkbox" class="study-checkbox" data-control="${controlKey}" ${isStudied ? 'checked' : ''} onchange="toggleStudied('${controlKey}')"></td>
                                                <td><div class="control-id">${c.id}</div><div class="control-name">${c.name}</div></td>
                                                <td class="control-req">${c.req}</td>
                                                <td class="control-meaning">${c.meaning}</td>
                                                <td><span class="impl-badge" style="background: ${TYPE_STYLES[c.type].bg}">${TYPE_STYLES[c.type].label}</span></td>
                                            </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            }
            container.innerHTML = html;
        }

        function toggleDomain(domainId) {
            const domain = document.querySelector(`.domain-${domainId}`);
            domain.classList.toggle('collapsed');
        }

        function toggleStudied(controlKey) {
            if (studiedControls.includes(controlKey)) {
                studiedControls = studiedControls.filter(k => k !== controlKey);
            } else {
                studiedControls.push(controlKey);
            }
            localStorage.setItem('studiedControls', JSON.stringify(studiedControls));
            updateProgressDisplay();
            
            // Update just this control's checkbox without re-rendering everything
            const checkbox = document.querySelector(`[data-control="${controlKey}"]`);
            if (checkbox) {
                checkbox.checked = studiedControls.includes(controlKey);
            }
            
            // Update domain count
            const domainId = controlKey.split('-')[0];
            updateDomainCount(domainId);
            
            // Only re-render if filter requires it (studied/unstudied filter active)
            if (studyFilter !== 'all') {
                // Save expanded states before re-render
                const expandedDomains = [];
                document.querySelectorAll('.domain-section.expanded').forEach(el => {
                    expandedDomains.push(el.dataset.domain);
                });
                
                renderDomains();
                
                // Restore expanded states after re-render
                expandedDomains.forEach(domainId => {
                    const section = document.querySelector(`.domain-section[data-domain="${domainId}"]`);
                    if (section) section.classList.add('expanded');
                });
            }
        }
        
        function updateDomainCount(domainId) {
            for (const [domainName, domain] of Object.entries(DOMAINS)) {
                if (domain.id === domainId) {
                    const studiedInDomain = domain.controls.filter(c => 
                        studiedControls.includes(domain.id + '-' + c.id)
                    ).length;
                    const progressEl = document.querySelector(`.domain-section[data-domain="${domainId}"] .domain-progress`);
                    if (progressEl) {
                        progressEl.textContent = `${studiedInDomain}/${domain.count} studied`;
                    }
                    break;
                }
            }
        }

        function updateProgressDisplay() {
            const percent = Math.round((studiedControls.length / 110) * 100);
            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('studiedCount').textContent = studiedControls.length;
        }

        function resetProgress() {
            if (confirm('Reset all study progress?')) {
                studiedControls = [];
                localStorage.setItem('studiedControls', JSON.stringify(studiedControls));
                updateProgressDisplay();
                renderDomains();
            }
        }

        function setFilter(filter) {
            studyFilter = filter;
            document.querySelectorAll('[data-filter]').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
            renderDomains();
        }

        function setTypeFilter(type) {
            typeFilter = type;
            document.querySelectorAll('.legend-item').forEach(item => item.classList.remove('active'));
            document.querySelector(`[data-type="${type}"]`).classList.add('active');
            renderDomains();
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchTerm = e.target.value.toLowerCase();
            renderDomains();
        });

        // ==================== QUIZ MODE ====================
        function selectQuizType(type) {
            selectedQuizType = type;
            document.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
            document.querySelector(`[data-quiz-type="${type}"]`).classList.add('selected');
        }

        function setQuestionCount(count) {
            questionCount = count;
            document.querySelectorAll('[data-q-count]').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-q-count="${count}"]`).classList.add('active');
        }

        function setQuizFocus(focus) {
            quizFocus = focus;
            document.querySelectorAll('[data-focus]').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-focus="${focus}"]`).classList.add('active');
        }

        function showQuizSettings() {
            document.getElementById('quizSettings').style.display = 'block';
            document.getElementById('quizCard').classList.remove('active');
            document.getElementById('flashcardCard').classList.remove('active');
            document.getElementById('quizResults').classList.remove('active');
            document.getElementById('quizSidebar').style.display = 'none';
        }

        function startQuiz() {
            let allControls = [];
            for (const [domainName, domain] of Object.entries(DOMAINS)) {
                domain.controls.forEach(c => {
                    const controlKey = domain.id + '-' + c.id;
                    const isStudied = studiedControls.includes(controlKey);
                    
                    // Filter based on focus
                    if (quizFocus === 'all' || 
                        (quizFocus === 'studied' && isStudied) || 
                        (quizFocus === 'unstudied' && !isStudied)) {
                        allControls.push({ ...c, domain: domainName });
                    }
                });
            }
            
            // Check if we have enough questions
            if (allControls.length === 0) {
                alert(quizFocus === 'studied' 
                    ? "You haven't marked any controls as studied yet! Go to Controls mode and check some off first." 
                    : "All controls are already studied! Try 'All Controls' or 'Studied Only' instead.");
                return;
            }
            
            const actualCount = Math.min(questionCount, allControls.length);
            quizQuestions = shuffle(allControls).slice(0, actualCount);
            currentQuestionIndex = 0;
            correctAnswers = 0;
            incorrectAnswers = 0;
            
            document.getElementById('quizSettings').style.display = 'none';
            document.getElementById('quizSidebar').style.display = 'block';
            
            if (selectedQuizType === 'flashcard') {
                document.getElementById('flashcardCard').classList.add('active');
                showFlashcard();
            } else {
                document.getElementById('quizCard').classList.add('active');
                showQuestion();
            }
            updateQuizStats();
        }

        function showQuestion() {
            answered = false;
            const q = quizQuestions[currentQuestionIndex];
            
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = quizQuestions.length;
            
            let questionLabel, questionText, questionSub, correctAnswer;
            
            if (selectedQuizType === 'multiple-choice') {
                questionLabel = 'What control matches this requirement?';
                questionText = q.req;
                questionSub = '';
                correctAnswer = q.id;
                
                const wrongAnswers = shuffle(quizQuestions.filter(x => x.id !== q.id)).slice(0, 3);
                const answers = shuffle([q, ...wrongAnswers]);
                
                document.getElementById('quizAnswers').innerHTML = answers.map(a => `
                    <div class="quiz-answer" data-answer="${a.id}" onclick="selectAnswer('${a.id}', '${correctAnswer}')">
                        <strong>${a.id}</strong> - ${a.name}
                    </div>
                `).join('');
                
            } else if (selectedQuizType === 'type-match') {
                questionLabel = 'What implementation type is this control?';
                questionText = `${q.id} - ${q.name}`;
                questionSub = q.meaning;
                correctAnswer = q.type;
                
                const types = ['policy', 'config', 'software', 'hardware', 'mixed'];
                document.getElementById('quizAnswers').innerHTML = types.map(t => `
                    <div class="quiz-answer" data-answer="${t}" onclick="selectAnswer('${t}', '${correctAnswer}')">
                        <span class="impl-badge" style="background: ${TYPE_STYLES[t].bg}">${TYPE_STYLES[t].label}</span>
                    </div>
                `).join('');
                
            } else if (selectedQuizType === 'domain-match') {
                questionLabel = 'Which domain does this control belong to?';
                questionText = `${q.id} - ${q.name}`;
                questionSub = q.meaning;
                correctAnswer = q.domain;
                
                const domains = shuffle(DOMAIN_NAMES).slice(0, 4);
                if (!domains.includes(q.domain)) domains[0] = q.domain;
                
                document.getElementById('quizAnswers').innerHTML = shuffle(domains).map(d => `
                    <div class="quiz-answer" data-answer="${d}" onclick="selectAnswer('${d.replace(/'/g, "\\'")}', '${correctAnswer.replace(/'/g, "\\'")}')">
                        ${d}
                    </div>
                `).join('');
            }
            
            document.getElementById('questionLabel').textContent = questionLabel;
            document.getElementById('questionText').textContent = questionText;
            document.getElementById('questionSub').textContent = questionSub;
            document.getElementById('quizFeedback').classList.remove('show', 'correct', 'incorrect');
            document.getElementById('nextBtn').style.display = 'none';
        }

        function selectAnswer(selected, correct) {
            if (answered) return;
            answered = true;
            
            const isCorrect = selected === correct;
            if (isCorrect) correctAnswers++;
            else incorrectAnswers++;
            
            document.querySelectorAll('.quiz-answer').forEach(el => {
                el.classList.add('disabled');
                if (el.dataset.answer === correct) el.classList.add('correct');
                else if (el.dataset.answer === selected && !isCorrect) el.classList.add('incorrect');
            });
            
            const feedback = document.getElementById('quizFeedback');
            feedback.classList.add('show', isCorrect ? 'correct' : 'incorrect');
            feedback.textContent = isCorrect ? '‚úì Correct!' : `‚úó Incorrect. Answer: ${correct}`;
            
            document.getElementById('correctScore').textContent = correctAnswers;
            document.getElementById('incorrectScore').textContent = incorrectAnswers;
            document.getElementById('nextBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').textContent = currentQuestionIndex < quizQuestions.length - 1 ? 'Next ‚Üí' : 'Results';
            updateQuizStats();
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex >= quizQuestions.length) showResults();
            else showQuestion();
        }

        function showFlashcard() {
            document.getElementById('quizCard').classList.remove('active');
            document.getElementById('flashcardCard').classList.add('active');
            
            const q = quizQuestions[currentQuestionIndex];
            document.getElementById('fcCurrentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('fcTotalQuestions').textContent = quizQuestions.length;
            document.getElementById('fcControlId').textContent = q.id;
            document.getElementById('fcFront').textContent = q.name + ': ' + q.req;
            document.getElementById('fcBack').textContent = q.meaning;
            document.getElementById('flashcard').classList.remove('flipped');
            updateQuizStats();
        }

        function flipCard() {
            document.getElementById('flashcard').classList.toggle('flipped');
        }

        function markFlashcard(gotIt) {
            if (gotIt) correctAnswers++;
            else incorrectAnswers++;
            currentQuestionIndex++;
            updateQuizStats();
            if (currentQuestionIndex >= quizQuestions.length) showResults();
            else showFlashcard();
        }

        function showResults() {
            document.getElementById('quizCard').classList.remove('active');
            document.getElementById('flashcardCard').classList.remove('active');
            document.getElementById('quizResults').classList.add('active');
            
            const total = correctAnswers + incorrectAnswers;
            const percent = Math.round((correctAnswers / total) * 100);
            
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('resultsCorrect').textContent = correctAnswers;
            document.getElementById('resultsIncorrect').textContent = incorrectAnswers;
            
            let icon, message;
            if (percent >= 90) { icon = 'üèÜ'; message = 'Outstanding! Exam ready!'; launchConfetti(); }
            else if (percent >= 80) { icon = 'üéâ'; message = 'Great job!'; }
            else if (percent >= 70) { icon = 'üëç'; message = 'Good progress!'; }
            else { icon = 'üí™'; message = 'Keep studying!'; }
            
            document.getElementById('resultsIcon').textContent = icon;
            document.getElementById('resultsMessage').textContent = message;
        }

        function restartQuiz() { showQuizSettings(); }
        function endQuiz() { if (confirm('End quiz?')) showQuizSettings(); }
        
        function updateQuizStats() {
            document.getElementById('quizCorrectCount').textContent = correctAnswers;
            document.getElementById('quizIncorrectCount').textContent = incorrectAnswers;
        }

        // ==================== CCA MODES ====================
        function startCCAMode(mode, questions) {
            ccaMode = mode;
            ccaQuestions = shuffle([...questions]);
            ccaIndex = 0;
            ccaCorrect = 0;
            ccaIncorrect = 0;
            renderCCAQuestion();
        }

        function renderCCAQuestion() {
            const containerId = ccaMode + 'Container';
            const container = document.getElementById(containerId);
            const q = ccaQuestions[ccaIndex];
            
            updateCCAStats();
            
            const modeTitles = {
                'ethics': '‚öñÔ∏è Ethics & Code of Conduct',
                'gotcha': '‚ö° Gotcha Questions',
                'judgment': 'üéØ Assessor Judgment',
                'cap': 'üìã CAP Process',
                'scoping': 'üó∫Ô∏è Scoping & Assets',
                'terminology': 'üìö Terminology Traps',
                'bestanswer': 'üß† Best Answer Training'
            };
            
            let html = `
                <div class="header">
                    <h2>${modeTitles[ccaMode] || ccaMode}</h2>
                    <p>Question ${ccaIndex + 1} of ${ccaQuestions.length}</p>
                </div>
                <div class="cca-card">
                    <span class="cca-category ${ccaMode}">${q.category}</span>
            `;
            
            if (ccaMode === 'judgment' || ccaMode === 'bestanswer') {
                html += `
                    <div class="cca-scenario">${q.scenario || q.q}</div>
                    <div class="cca-options">
                        ${q.options.map((opt, i) => `
                            <div class="cca-option" data-index="${i}">${opt}</div>
                        `).join('')}
                    </div>
                `;
            } else {
                html += `
                    <div class="cca-question">${q.q}</div>
                    <div class="cca-options">
                        ${q.options.map((opt, i) => `
                            <div class="cca-option" data-index="${i}">${opt}</div>
                        `).join('')}
                    </div>
                `;
            }
            
            html += `
                    <div class="cca-explanation">
                        <h4>üìö Explanation</h4>
                        <p>${q.explanation}</p>
                        ${q.mindset ? `<div class="cca-mindset"><h5>üéØ Assessor Mindset</h5><p>${q.mindset}</p></div>` : ''}
                    </div>
                    <button class="quiz-btn quiz-btn-primary cca-next-btn" style="display: none; margin-top: 20px;" onclick="nextCCAQuestion()">
                        ${ccaIndex < ccaQuestions.length - 1 ? 'Next Question ‚Üí' : 'See Results'}
                    </button>
                </div>
            `;
            
            container.innerHTML = html;
            
            // Add click handlers using event delegation - search within THIS container
            const optionsContainer = container.querySelector('.cca-options');
            if (optionsContainer) {
                optionsContainer.addEventListener('click', function(e) {
                    const option = e.target.closest('.cca-option');
                    if (option && !option.classList.contains('disabled')) {
                        const index = parseInt(option.dataset.index);
                        selectCCAAnswer(index);
                    }
                });
            }
        }

        function selectCCAAnswer(index) {
            const q = ccaQuestions[ccaIndex];
            const containerId = ccaMode + 'Container';
            const container = document.getElementById(containerId);
            const options = container.querySelectorAll('.cca-options .cca-option');
            const isCorrect = index === q.correct;
            
            options.forEach((opt, i) => {
                opt.classList.add('disabled');
                if (i === q.correct) opt.classList.add('correct');
                else if (i === index && !isCorrect) opt.classList.add('incorrect');
            });
            
            if (isCorrect) ccaCorrect++;
            else ccaIncorrect++;
            
            container.querySelector('.cca-explanation').classList.add('show');
            container.querySelector('.cca-next-btn').style.display = 'inline-block';
            updateCCAStats();
        }

        function nextCCAQuestion() {
            ccaIndex++;
            if (ccaIndex >= ccaQuestions.length) {
                showCCAResults();
            } else {
                renderCCAQuestion();
            }
        }

        function showCCAResults() {
            const containerId = ccaMode + 'Container';
            const container = document.getElementById(containerId);
            const percent = Math.round((ccaCorrect / ccaQuestions.length) * 100);
            
            let icon, message;
            if (percent >= 90) { icon = 'üèÜ'; message = 'Outstanding!'; launchConfetti(); }
            else if (percent >= 80) { icon = 'üéâ'; message = 'Great job!'; }
            else if (percent >= 70) { icon = 'üëç'; message = 'Good progress!'; }
            else { icon = 'üí™'; message = 'Keep studying!'; }
            
            container.innerHTML = `
                <div class="quiz-results active">
                    <div class="results-icon">${icon}</div>
                    <div class="results-score">${percent}%</div>
                    <div class="results-message">${message}</div>
                    <div class="results-stats">
                        <div class="results-stat">
                            <div class="results-stat-value correct">${ccaCorrect}</div>
                            <div class="results-stat-label">Correct</div>
                        </div>
                        <div class="results-stat">
                            <div class="results-stat-value incorrect">${ccaIncorrect}</div>
                            <div class="results-stat-label">Incorrect</div>
                        </div>
                    </div>
                    <button class="quiz-btn quiz-btn-primary" onclick="restartCCAMode()">Try Again</button>
                </div>
            `;
        }

        function restartCCAMode() {
            if (ccaMode === 'ethics') startCCAMode('ethics', ETHICS_QUESTIONS);
            else if (ccaMode === 'gotcha') startCCAMode('gotcha', GOTCHA_QUESTIONS);
            else if (ccaMode === 'judgment') startCCAMode('judgment', JUDGMENT_SCENARIOS);
            else if (ccaMode === 'cap') startCCAMode('cap', CAP_QUESTIONS);
            else if (ccaMode === 'scoping') startCCAMode('scoping', SCOPING_QUESTIONS);
            else if (ccaMode === 'terminology') startCCAMode('terminology', TERMINOLOGY_QUESTIONS);
            else if (ccaMode === 'bestanswer') startCCAMode('bestanswer', BEST_ANSWER_QUESTIONS);
        }

        function updateCCAStats() {
            document.getElementById('ccaProgress').textContent = `${ccaIndex + 1} / ${ccaQuestions.length}`;
            document.getElementById('ccaCorrect').textContent = ccaCorrect;
            document.getElementById('ccaIncorrect').textContent = ccaIncorrect;
        }

        // ==================== TEST STRATEGY TIPS MODE ====================
        function renderTips() {
            const container = document.getElementById('tipsContainer');
            
            let html = `
                <div class="header">
                    <h2>üí° Test-Taking Strategy Tips</h2>
                    <p>Key strategies for CCA exam success</p>
                </div>
                <div style="max-width: 900px; margin: 0 auto;">
                    <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 16px; padding: 20px; margin-bottom: 24px; border: 2px solid #f59e0b;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: #92400e; margin-bottom: 12px;">‚ö†Ô∏è Key Focus Areas</div>
                        <div style="color: #78350f; line-height: 1.7;">
                            <p style="margin-bottom: 8px;"><strong>Prioritize the CAP</strong> - The CMMC Assessment Process document is heavily tested and often underestimated.</p>
                            <p style="margin-bottom: 8px;"><strong>Focus on foundational documents:</strong> CAP and Scoping Guide are primary sources. Don't rely solely on LTP slides.</p>
                            <p><strong>CMMC Level 2 Practices</strong> - Focus on understanding HOW to assess controls, not just WHAT the controls say.</p>
                        </div>
                    </div>
                    
                    <div style="display: grid; gap: 16px;">
                        ${TEST_STRATEGY_TIPS.map((t, i) => `
                            <div style="background: white; border-radius: 12px; padding: 20px; border: 1px solid #e2e8f0; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="display: flex; align-items: flex-start; gap: 16px;">
                                    <div style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; flex-shrink: 0;">${i + 1}</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700; color: #1e293b; font-size: 1.1rem; margin-bottom: 8px;">${t.tip}</div>
                                        <div style="color: #64748b; line-height: 1.6;">${t.detail}</div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-radius: 16px; padding: 20px; margin-top: 24px; border: 2px solid #3b82f6;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: #1e40af; margin-bottom: 12px;">üìä Exam Domain Difficulty</div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 16px;">
                            <div style="background: white; padding: 16px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #16a34a;">OSC Requirements</div>
                                <div style="color: #64748b; font-size: 0.9rem;">Understanding OSC obligations</div>
                                <div style="color: #22c55e; font-size: 0.8rem;">‚úì Generally well understood</div>
                            </div>
                            <div style="background: white; padding: 16px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #eab308;">Scoping</div>
                                <div style="color: #64748b; font-size: 0.9rem;">Asset categories & boundaries</div>
                                <div style="color: #f59e0b; font-size: 0.8rem;">‚ö° Can be tricky</div>
                            </div>
                            <div style="background: white; padding: 16px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #f97316;">CAP Process</div>
                                <div style="color: #64748b; font-size: 0.9rem;">4 phases, roles, procedures</div>
                                <div style="color: #ea580c; font-size: 0.8rem;">‚ö†Ô∏è Often underestimated</div>
                            </div>
                            <div style="background: white; padding: 16px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #dc2626;">L2 Practices</div>
                                <div style="color: #64748b; font-size: 0.9rem;">Assessing the 110 controls</div>
                                <div style="color: #ef4444; font-size: 0.8rem;">üî• Most challenging</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); border-radius: 16px; padding: 20px; margin-top: 24px; border: 2px solid #22c55e;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: #166534; margin-bottom: 12px;">‚úÖ Study Priorities</div>
                        <ul style="color: #15803d; line-height: 1.8; margin: 0; padding-left: 20px;">
                            <li><strong>CAP first</strong>, Assessment Guide second, Scoping Guide thoroughly (it's short)</li>
                            <li>Browse and understand the Code of Professional Conduct (CoPC)</li>
                            <li>Don't over-invest in NIST 800-171A - valuable but not heavily tested</li>
                            <li>Know each practice/objective and how to assess them - what evidence demonstrates conformity?</li>
                            <li>Writing out practices with their point values and objectives can help retention</li>
                            <li><strong>Focus on assessment methodology</strong> - controls are provided on the exam, understanding how to evaluate conformity is key</li>
                        </ul>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #fae8ff 0%, #e9d5ff 100%); border-radius: 16px; padding: 20px; margin-top: 24px; border: 2px solid #a855f7;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: #6b21a8; margin-bottom: 16px;">üìã CRITICAL: Adequate vs Sufficient Evidence</div>
                        <div style="color: #581c87; line-height: 1.7; margin-bottom: 16px;">
                            <p style="margin-bottom: 12px;">Assessors must determine if evidence is <strong>BOTH</strong> adequate AND sufficient. These are TWO SEPARATE tests!</p>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                            <div style="background: white; padding: 16px; border-radius: 10px; border-left: 4px solid #22c55e;">
                                <div style="font-weight: 700; color: #166534; font-size: 1.1rem; margin-bottom: 8px;">‚úÖ ADEQUATE Evidence</div>
                                <div style="color: #15803d; font-size: 0.95rem; margin-bottom: 8px;"><strong>= The RIGHT KIND of evidence</strong></div>
                                <div style="color: #64748b; font-size: 0.9rem; line-height: 1.5;">
                                    <p><strong>Focus:</strong> Quality & Relevance</p>
                                    <p><strong>Key Question:</strong> Does this evidence directly support the specific practice?</p>
                                    <p style="margin-top: 8px;"><strong>Examples:</strong> Screenshots, configs, logs, test results, demonstrations</p>
                                    <p style="margin-top: 8px; color: #dc2626;"><strong>NOT adequate:</strong> Policy alone (shows intent, not implementation)</p>
                                </div>
                            </div>
                            <div style="background: white; padding: 16px; border-radius: 10px; border-left: 4px solid #3b82f6;">
                                <div style="font-weight: 700; color: #1e40af; font-size: 1.1rem; margin-bottom: 8px;">üìä SUFFICIENT Evidence</div>
                                <div style="color: #1d4ed8; font-size: 0.95rem; margin-bottom: 8px;"><strong>= ENOUGH of the right evidence</strong></div>
                                <div style="color: #64748b; font-size: 0.9rem; line-height: 1.5;">
                                    <p><strong>Focus:</strong> Quantity & Coverage</p>
                                    <p><strong>Key Question:</strong> Does this cover the FULL assessment scope?</p>
                                    <p style="margin-top: 8px;"><strong>Examples:</strong> Evidence from ALL in-scope systems, all departments, representative sampling</p>
                                    <p style="margin-top: 8px; color: #dc2626;"><strong>NOT sufficient:</strong> One screenshot from one system when 50 exist</p>
                                </div>
                            </div>
                        </div>
                        <div style="background: white; padding: 16px; border-radius: 10px; margin-top: 16px;">
                            <div style="font-weight: 700; color: #6b21a8; margin-bottom: 12px;">üéØ Quick Examples for MFA (IA.L2-3.5.3)</div>
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                                <tr style="background: #f8fafc;">
                                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid #e2e8f0;">Evidence</th>
                                    <th style="padding: 8px; text-align: center; border-bottom: 2px solid #e2e8f0;">Adequate?</th>
                                    <th style="padding: 8px; text-align: center; border-bottom: 2px solid #e2e8f0;">Sufficient?</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid #e2e8f0;">Why?</th>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">Policy stating "MFA required"</td>
                                    <td style="padding: 8px; text-align: center; border-bottom: 1px solid #e2e8f0; color: #dc2626;">‚ùå</td>
                                    <td style="padding: 8px; text-align: center; border-bottom: 1px solid #e2e8f0; color: #dc2626;">‚ùå</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">Shows intent, not implementation</td>
                                </tr>
                                <tr style="background: #f8fafc;">
                                    <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">MFA screenshot from ONE dept</td>
                                    <td style="padding: 8px; text-align: center; border-bottom: 1px solid #e2e8f0; color: #22c55e;">‚úÖ</td>
                                    <td style="padding: 8px; text-align: center; border-bottom: 1px solid #e2e8f0; color: #dc2626;">‚ùå</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">Right kind, but only partial coverage</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">Screenshots from ALL depts + system config</td>
                                    <td style="padding: 8px; text-align: center; border-bottom: 1px solid #e2e8f0; color: #22c55e;">‚úÖ</td>
                                    <td style="padding: 8px; text-align: center; border-bottom: 1px solid #e2e8f0; color: #22c55e;">‚úÖ</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">Right kind AND full scope coverage</td>
                                </tr>
                            </table>
                        </div>
                        <div style="background: #fef3c7; padding: 12px; border-radius: 8px; margin-top: 16px; color: #92400e; font-size: 0.9rem;">
                            <strong>üí° Remember:</strong> Evidence can be ADEQUATE (right kind) but NOT SUFFICIENT (not enough coverage). BOTH conditions must be met for a practice to be MET!
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }

        // ==================== DEEP DIVE MODE ====================
        function renderDeepDive() {
            const container = document.getElementById('deepdiveContainer');
            
            let html = `
                <div class="header">
                    <h2>üî¨ Control Deep Dives</h2>
                    <p>Key takeaways from Further Discussion sections + Assessment Objectives - 110 controls</p>
                </div>
                <input type="text" class="deepdive-search" placeholder="Search controls..." oninput="filterDeepDive(this.value)">
            `;
            
            for (const [domainKey, domain] of Object.entries(controlDeepDives)) {
                const fivePointCount = domain.controls.filter(c => c.points === 5 || c.points === "3 or 5").length;
                html += `
                    <div class="deepdive-domain" data-domain="${domainKey}">
                        <div class="deepdive-domain-header" onclick="toggleDeepDiveDomain('${domainKey}')" style="background: ${domain.color};">
                            <span>${domain.name} (${domainKey}) - ${domain.controls.length} controls${fivePointCount > 0 ? ' ‚Ä¢ ' + fivePointCount + ' high-value' : ''}</span>
                            <span class="dd-chevron">‚ñº</span>
                        </div>
                        <div class="deepdive-domain-content">
                            ${domain.controls.map(c => {
                                const aos = ASSESSMENT_OBJECTIVES[c.id] || [];
                                return `
                                <div class="deepdive-control" data-search="${c.id} ${c.name} ${c.keyTakeaways.join(' ')}".toLowerCase()>
                                    <div class="dd-control-header">
                                        <div>
                                            <span class="dd-control-id" style="color: ${domain.color};">${c.id}</span>
                                            <span class="dd-control-name">${c.name}</span>
                                        </div>
                                        ${c.points === 5 ? '<span style="background: #ef4444; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: 700;">5 PT</span>' : c.points === "3 or 5" ? '<span style="background: #f59e0b; color: #1a1a2e; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: 700;">PARTIAL</span>' : ''}
                                    </div>
                                    ${aos.length > 0 ? `
                                    <div style="background: rgba(37, 99, 235, 0.08); border: 1px solid #2563eb; border-radius: 8px; padding: 12px; margin-bottom: 10px;">
                                        <div style="font-weight: 600; color: #2563eb; font-size: 0.85rem; margin-bottom: 8px;">üìã Assessment Objectives (${aos.length})</div>
                                        <div style="color: #1e40af; font-size: 0.85rem; line-height: 1.7;">
                                            ${aos.map(ao => `<div style="margin-bottom: 4px;">${ao}</div>`).join('')}
                                        </div>
                                    </div>
                                    ` : ''}
                                    <div class="dd-takeaways">
                                        <h4>üìå Key Takeaways</h4>
                                        <ul style="margin: 8px 0; padding-left: 20px; color: #334155; font-size: 0.9rem; line-height: 1.6;">
                                            ${c.keyTakeaways.map(t => `<li>${t}</li>`).join('')}
                                        </ul>
                                    </div>
                                    <div style="background: rgba(245, 158, 11, 0.1); border: 1px solid #f59e0b; border-radius: 8px; padding: 10px; margin-top: 10px;">
                                        <div style="font-weight: 600; color: #f59e0b; font-size: 0.8rem;">üéØ Assessment Tips</div>
                                        <div style="color: #92400e; font-size: 0.85rem; margin-top: 4px;">${c.assessmentTips}</div>
                                    </div>
                                </div>
                            `}).join('')}
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        function toggleDeepDiveDomain(domainId) {
            const domain = document.querySelector(`.deepdive-domain[data-domain="${domainId}"]`);
            domain.classList.toggle('expanded');
        }

        function filterDeepDive(term) {
            term = term.toLowerCase();
            document.querySelectorAll('.deepdive-control').forEach(control => {
                const text = control.textContent.toLowerCase();
                control.classList.toggle('hidden', term && !text.includes(term));
            });
            
            document.querySelectorAll('.deepdive-domain').forEach(domain => {
                const visibleControls = domain.querySelectorAll('.deepdive-control:not(.hidden)').length;
                domain.style.display = visibleControls > 0 || !term ? 'block' : 'none';
                if (term && visibleControls > 0) domain.classList.add('expanded');
            });
        }

        // ==================== UTILITIES ====================
        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // ==================== MOBILE ====================
        function toggleMobileSidebar() {
            document.querySelector('.sidebar').classList.toggle('open');
            document.querySelector('.sidebar-overlay').classList.toggle('show');
        }
        
        function closeMobileSidebar() {
            document.querySelector('.sidebar').classList.remove('open');
            document.querySelector('.sidebar-overlay').classList.remove('show');
        }
        
        function mobileSetMode(mode) {
            setMode(mode);
            closeMobileSidebar();
            document.querySelectorAll('.mobile-nav-btn').forEach(btn => btn.classList.remove('active'));
        }

        // ==================== INIT ====================
        renderDomains();
        updateProgressDisplay();
        
        // Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW failed:', err));
            });
        }
    </script>
</body>
</html>
